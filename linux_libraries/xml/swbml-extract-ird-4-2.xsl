<?xml version="1.0"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:fpml="http://www.fpml.org/2005/FpML-4-2" xmlns:common="http://exslt.org/common" xmlns:mwrpt="http://www.markitserv.com/swbml-extract-reporting.xsl" exclude-result-prefixes="fpml common mwrpt" version="1.0"><xsl:import href="swbml-extract-reporting.xsl"/><xsl:output method="xml"/><xsl:variable name="SWBML" select="//fpml:SWBML"/><xsl:variable name="swbHeader" select="$SWBML/fpml:swbHeader"/><xsl:variable name="swaption" select="$SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swaption"/><xsl:variable name="swbStructuredTradeDetails" select="$SWBML/fpml:swbStructuredTradeDetails"/><xsl:variable name="swbExtendedTradeDetails" select="$swbStructuredTradeDetails/fpml:swbExtendedTradeDetails"/><xsl:variable name="FpML" select="$swbStructuredTradeDetails/fpml:FpML"/><xsl:variable name="trade" select="$FpML/fpml:trade"/><xsl:variable name="capFloor" select="$trade/fpml:capFloor"/><xsl:variable name="capFloorStream" select="$capFloor/fpml:capFloorStream"/><xsl:variable name="productType" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbProductType)"/><xsl:variable name="floatingLeg"><xsl:choose><xsl:when test="$idm140055992546864-6/fpml:swapStream[1][@id='floatingLeg']">1</xsl:when><xsl:when test="$idm140055992546864-6/fpml:swapStream[1]/fpml:calculationPeriodAmount/fpml:calculation/fpml:inflationRateCalculation/fpml:inflationLag">1</xsl:when><xsl:otherwise>2</xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="floatingStream" select="$swapStream[position() = $floatingLeg]"/><xsl:variable name="fixedLeg"><xsl:choose><xsl:when test="$productType = 'Single Currency Basis Swap' or $productType = 'Cross Currency Basis Swap'"/><xsl:when test="$idm140055992546864-6/fpml:swapStream[1]/fpml:resetDates or /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[1]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:calculationParameters/fpml:calculationMethod">2</xsl:when><xsl:when test="$idm140055992546864-6/fpml:swapStream[1]/fpml:calculationPeriodAmount/fpml:calculation/fpml:inflationRateCalculation/fpml:inflationLag">2</xsl:when><xsl:otherwise>1</xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="swapStream" select="$idm140055992538800-5/fpml:swapStream"/><xsl:variable name="fixedStream" select="$swapStream[position()=$fixedLeg]"/><xsl:variable name="fixedLeg2"><xsl:choose><xsl:when test="$productType != 'Fixed Fixed Swap'"/><xsl:when test="$idm140055992546864-6/fpml:swapStream[1][@id='fixedLeg2']">1</xsl:when><xsl:otherwise>2</xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="fixedStream2" select="$swapStream[position()=$fixedLeg2]"/><xsl:variable name="floatingLeg2"><xsl:choose><xsl:when test="$productType != 'Single Currency Basis Swap' and $productType != 'Cross Currency Basis Swap'"/><xsl:when test="$idm140055992546864-6/fpml:swapStream[1][@id='floatingLeg2']">1</xsl:when><xsl:otherwise>2</xsl:otherwise></xsl:choose><xsl:if test="$productType='Cross Currency IRS'"><xsl:value-of select="$floatingLeg"/></xsl:if></xsl:variable><xsl:variable name="floatingStream2" select="$swapStream[position()=$floatingLeg2]"/><xsl:variable name="isPrimeBrokered"><xsl:choose><xsl:when test="$idm140055992546864-1/fpml:swbGiveUp">1</xsl:when><xsl:otherwise>0</xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="partyA"><xsl:choose><xsl:when test="$idm140055992546864-1/fpml:swbGiveUp"><xsl:value-of select="$idm140055992546864-1//fpml:swbInterDealerTransaction/fpml:swbExecutingDealer/@href"/></xsl:when><xsl:when test="fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbExecutingBroker"><xsl:value-of select="$idm140055992522592-4/fpml:swbExecutingBroker/@href"/></xsl:when><xsl:otherwise>partyA</xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="partyB"><xsl:choose><xsl:when test="$idm140055992546864-1/fpml:swbGiveUp"><xsl:value-of select="$idm140055992546864-1//fpml:swbCustomerTransaction/fpml:swbCustomer/@href"/></xsl:when><xsl:when test="fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbClearingClient"><xsl:value-of select="$idm140055992522592-4/fpml:swbClearingClient/@href"/></xsl:when><xsl:otherwise>partyB</xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="partyC"><xsl:choose><xsl:when test="$idm140055992546864-1/fpml:swbGiveUp"><xsl:value-of select="$idm140055992546864-1//fpml:swbInterDealerTransaction/fpml:swbPrimeBroker/@href"/></xsl:when><xsl:otherwise>partyC</xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="partyD"><xsl:choose><xsl:when test="$idm140055992546864-1/fpml:swbGiveUp"><xsl:value-of select="$idm140055992546864-1//fpml:swbCustomerTransaction/fpml:swbPrimeBroker/@href"/></xsl:when><xsl:otherwise>partyD</xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="partyG"><xsl:choose><xsl:when test="$idm140055992546864-1/fpml:swbGiveUp"><xsl:value-of select="$idm140055992546864-1//fpml:swbExecutingDealerCustomerTransaction/fpml:swbExecutingDealer/@href"/></xsl:when><xsl:otherwise>partyG</xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="reportingData.rtf"><xsl:apply-templates select="$idm140055992546864-1/fpml:swbTradeEventReportingDetails/node()" mode="mapReportingData"/></xsl:variable><xsl:variable name="brokerPrivateData.rtf"><xsl:variable name="broker1"><xsl:choose><xsl:when test="$idm140055992546864-4/fpml:otherPartyPayment[1]/fpml:receiverPartyReference"><xsl:value-of select="$idm140055992546864-4/fpml:otherPartyPayment[1]/fpml:receiverPartyReference/@href"/></xsl:when><xsl:otherwise>broker1</xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="broker2"><xsl:choose><xsl:when test="$idm140055992546864-4/fpml:otherPartyPayment[2]/fpml:receiverPartyReference"><xsl:value-of select="$idm140055992546864-4/fpml:otherPartyPayment[2]/fpml:receiverPartyReference/@href"/></xsl:when><xsl:otherwise>broker2</xsl:otherwise></xsl:choose></xsl:variable><xsl:choose><xsl:when test="$idm140055992546864-1/fpml:swbPrivatePartyTradeEventReportingDetails[fpml:swbPartyReference/@href=$broker1]"><xsl:apply-templates select="$idm140055992546864-1/fpml:swbPrivatePartyTradeEventReportingDetails[fpml:swbPartyReference/@href=$broker1]/node()" mode="mapReportingData"/></xsl:when><xsl:when test="$idm140055992546864-1/fpml:swbPrivatePartyTradeEventReportingDetails[fpml:swbPartyReference/@href=$broker2]"><xsl:apply-templates select="$idm140055992546864-1/fpml:swbPrivatePartyTradeEventReportingDetails[fpml:swbPartyReference/@href=$broker2]/node()" mode="mapReportingData"/></xsl:when><xsl:when test="$idm140055992546864-1/fpml:swbPrivatePartyTradeEventReportingDetails[fpml:swbPartyReference/@href='broker']"><xsl:apply-templates select="$idm140055992546864-1/fpml:swbPrivatePartyTradeEventReportingDetails[fpml:swbPartyReference/@href='broker']/node()" mode="mapReportingData"/></xsl:when><xsl:otherwise><xsl:apply-templates select="$idm140055992546864-1/fpml:swbPrivatePartyTradeEventReportingDetails/node()" mode="mapReportingData"/></xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="partyAPrivateData.rtf"><xsl:choose><xsl:when test="$idm140055992546864-1/fpml:swbPrivatePartyTradeEventReportingDetails[fpml:swbPartyReference/@href=$partyA]"><xsl:apply-templates select="$idm140055992546864-1/fpml:swbPrivatePartyTradeEventReportingDetails[fpml:swbPartyReference/@href=$partyA]/node()" mode="mapReportingData"/></xsl:when><xsl:otherwise><xsl:apply-templates select="$idm140055992546864-1/fpml:swbPrivatePartyTradeEventReportingDetails/node()" mode="mapReportingData"/></xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="partyBPrivateData.rtf"><xsl:choose><xsl:when test="$idm140055992546864-1/fpml:swbGiveUp"><xsl:choose><xsl:when test="$idm140055992546864-1/fpml:swbPrivatePartyTradeEventReportingDetails[fpml:swbPartyReference/@href=$partyC]"><xsl:apply-templates select="$idm140055992546864-1/fpml:swbPrivatePartyTradeEventReportingDetails[fpml:swbPartyReference/@href=$partyC]/node()" mode="mapReportingData"/></xsl:when><xsl:otherwise><xsl:apply-templates select="$idm140055992546864-1/fpml:swbPrivatePartyTradeEventReportingDetails/node()" mode="mapReportingData"/></xsl:otherwise></xsl:choose></xsl:when><xsl:otherwise><xsl:choose><xsl:when test="$idm140055992546864-1/fpml:swbPrivatePartyTradeEventReportingDetails[fpml:swbPartyReference/@href=$partyB]"><xsl:apply-templates select="$idm140055992546864-1/fpml:swbPrivatePartyTradeEventReportingDetails[fpml:swbPartyReference/@href=$partyB]/node()" mode="mapReportingData"/></xsl:when><xsl:otherwise><xsl:apply-templates select="$idm140055992546864-1/fpml:swbPrivatePartyTradeEventReportingDetails/node()" mode="mapReportingData"/></xsl:otherwise></xsl:choose></xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="brokerPBPrivateData.rtf"><xsl:choose><xsl:when test="$idm140055992546864-1/fpml:swbPrivatePartyTradeEventReportingDetails/fpml:swbPBClientTradePrivateReportingDetails[fpml:swbPartyReference/@href='broker']"><xsl:apply-templates select="$idm140055992546864-1/fpml:swbPrivatePartyTradeEventReportingDetails/fpml:swbPBClientTradePrivateReportingDetails[fpml:swbPartyReference/@href='broker']/node()" mode="mapReportingData"/></xsl:when><xsl:otherwise><xsl:apply-templates select="$idm140055992546864-1/fpml:swbPrivatePartyTradeEventReportingDetails/fpml:swbPBClientTradePrivateReportingDetails/node()" mode="mapReportingData"/></xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="pbPrivateData.rtf"><xsl:choose><xsl:when test="$idm140055992546864-1/fpml:swbPrivatePartyTradeEventReportingDetails/fpml:swbPBClientTradePrivateReportingDetails[fpml:swbPartyReference/@href=$partyC]"><xsl:apply-templates select="$idm140055992546864-1/fpml:swbPrivatePartyTradeEventReportingDetails/fpml:swbPBClientTradePrivateReportingDetails[fpml:swbPartyReference/@href=$partyC]/node()" mode="mapReportingData"/></xsl:when><xsl:otherwise><xsl:apply-templates select="$idm140055992546864-1/fpml:swbPrivatePartyTradeEventReportingDetails/fpml:swbPBClientTradePrivateReportingDetails/node()" mode="mapReportingData"/></xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="clientPrivateData.rtf"><xsl:choose><xsl:when test="$idm140055992546864-1/fpml:swbPrivatePartyTradeEventReportingDetails/fpml:swbPBClientTradePrivateReportingDetails[fpml:swbPartyReference/@href=$partyB]"><xsl:apply-templates select="$idm140055992546864-1/fpml:swbPrivatePartyTradeEventReportingDetails/fpml:swbPBClientTradePrivateReportingDetails[fpml:swbPartyReference/@href=$partyB]/node()" mode="mapReportingData"/></xsl:when><xsl:otherwise><xsl:apply-templates select="$idm140055992546864-1/fpml:swbPrivatePartyTradeEventReportingDetails/fpml:swbPBClientTradePrivateReportingDetails/node()" mode="mapReportingData"/></xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="extendedTradeDetails.rtf"><xsl:apply-templates select="$idm140055992522592-3/node()" mode="mapReportingData"/></xsl:variable><xsl:variable name="partyIdentifiers.rtf"><xsl:apply-templates select="$idm140055992546864-3/node()" mode="mapReportingData"/></xsl:variable><xsl:variable name="idm140055992546864-1" select="/fpml:SWBML"/><xsl:variable name="idm140055992546864-2" select="$idm140055992546864-1/fpml:swbStructuredTradeDetails"/><xsl:variable name="idm140055992392688-2" select="$idm140055992546864-1/fpml:swbHeader"/><xsl:variable name="idm140055992546864-3" select="$idm140055992546864-2/fpml:FpML"/><xsl:variable name="idm140055992522592-3" select="$idm140055992546864-2/fpml:swbExtendedTradeDetails"/><xsl:variable name="idm140055992371904-3" select="$idm140055992546864-1/fpml:swbGiveUp/fpml:swbInterDealerTransaction"/><xsl:variable name="idm140055992369888-3" select="$idm140055992546864-1/fpml:swbGiveUp/fpml:swbCustomerTransaction"/><xsl:variable name="idm140055991938160-3" select="$idm140055992546864-1//fpml:swbStructuredTradeDetails"/><xsl:variable name="idm140055990846496-3" select="$idm140055992546864-2/fpml:swbTradePackageHeader"/><xsl:variable name="idm140055992546864-4" select="$idm140055992546864-3/fpml:trade"/><xsl:variable name="idm140055992522592-4" select="$idm140055992522592-3/fpml:swbTradeHeader"/><xsl:variable name="idm140055992394416-4" select="$idm140055992522592-3/fpml:swbSettlementProvision"/><xsl:variable name="idm140055991938160-4" select="$idm140055991938160-3/fpml:FpML"/><xsl:variable name="idm140055991522688-4" select="$idm140055992522592-3/fpml:swbEarlyTerminationProvision"/><xsl:variable name="idm140055991444240-4" select="$idm140055992522592-3/fpml:swbAssociatedBonds"/><xsl:variable name="idm140055992538800-5" select="$idm140055992546864-4/fpml:swap"/><xsl:variable name="idm140055992405024-5" select="$idm140055992546864-4/fpml:capFloor"/><xsl:variable name="idm140055992339152-5" select="$idm140055992522592-4/fpml:swbClientFund"/><xsl:variable name="idm140055992284944-5" select="$idm140055992546864-4/fpml:swaption"/><xsl:variable name="idm140055991938160-5" select="$idm140055991938160-4/fpml:trade"/><xsl:variable name="idm140055991314592-5" select="$idm140055992522592-3/fpml:swbCollateralizedCashPrice/fpml:settlementRateSource"/><xsl:variable name="idm140055992546864-6" select="$idm140055992546864-4//fpml:swap"/><xsl:variable name="idm140055992406288-6" select="$idm140055992546864-4//fpml:fra"/><xsl:variable name="idm140055992405024-6" select="$idm140055992405024-5/fpml:capFloorStream"/><xsl:variable name="idm140055991314592-6" select="$idm140055991314592-5/fpml:informationSource"/><xsl:variable name="idm140055992405024-7" select="$idm140055992405024-6/fpml:calculationPeriodAmount"/><xsl:variable name="idm140055992366880-7" select="$idm140055992546864-6/fpml:additionalTerms"/><xsl:variable name="idm140055992162256-7" select="$idm140055992405024-6/fpml:paymentDates"/><xsl:variable name="idm140055992150384-7" select="$idm140055992405024-6/fpml:calculationPeriodDates"/><xsl:variable name="idm140055992405024-8" select="$idm140055992405024-7/fpml:calculation"/><xsl:variable name="idm140055992366880-8" select="$idm140055992366880-7/fpml:bondReference"/><xsl:variable name="idm140055991236064-8" select="$idm140055992538800-5/fpml:cancelableProvision//fpml:relevantUnderlyingDate"/><xsl:variable name="idm140055991227792-8" select="$idm140055992538800-5/fpml:cancelableProvision//fpml:americanExercise"/><xsl:variable name="idm140055991227104-8" select="$idm140055992538800-5/fpml:cancelableProvision//fpml:europeanExercise"/><xsl:variable name="idm140055992366880-9" select="$idm140055992366880-8/fpml:bond"/><xsl:variable name="idm140055992081408-9" select="$idm140055992405024-8/fpml:floatingRateCalculation"/><xsl:template match="/|comment()|processing-instruction()" mode="mapReportingData"><xsl:copy><xsl:apply-templates mode="mapReportingData"/></xsl:copy></xsl:template><xsl:template match="*" mode="mapReportingData"><xsl:element name="{local-name()}"><xsl:apply-templates select="@*|node()" mode="mapReportingData"/></xsl:element></xsl:template><xsl:template match="@*" mode="mapReportingData"><xsl:attribute name="{local-name()}"><xsl:value-of select="."/></xsl:attribute></xsl:template><xsl:template match="/"><xsl:apply-templates select="fpml:SWBML" mode="get-reporting-data"/></xsl:template><xsl:template match="/fpml:SWBML[function-available('common:node-set')]" mode="get-reporting-data"><xsl:apply-templates select="."><xsl:with-param name="reportingData" select="common:node-set($reportingData.rtf)"/><xsl:with-param name="brokerPrivateData" select="common:node-set($brokerPrivateData.rtf)"/><xsl:with-param name="partyAPrivateData" select="common:node-set($partyAPrivateData.rtf)"/><xsl:with-param name="partyBPrivateData" select="common:node-set($partyBPrivateData.rtf)"/><xsl:with-param name="brokerPBPrivateData" select="common:node-set($brokerPBPrivateData.rtf)"/><xsl:with-param name="pbPrivateData" select="common:node-set($pbPrivateData.rtf)"/><xsl:with-param name="clientPrivateData" select="common:node-set($clientPrivateData.rtf)"/><xsl:with-param name="extendedTradeDetails" select="common:node-set($extendedTradeDetails.rtf)"/></xsl:apply-templates></xsl:template><xsl:template match="/fpml:SWBML[not(function-available('common:node-set'))]" mode="get-reporting-data"><xsl:apply-templates select="."><xsl:with-param name="reportingData" select="$reportingData.rtf"/><xsl:with-param name="brokerPrivateData" select="$brokerPrivateData.rtf"/><xsl:with-param name="partyAPrivateData" select="$partyAPrivateData.rtf"/><xsl:with-param name="partyBPrivateData" select="$partyBPrivateData.rtf"/><xsl:with-param name="brokerPBPrivateData" select="$brokerPBPrivateData.rtf"/><xsl:with-param name="pbPrivateData" select="$pbPrivateData.rtf"/><xsl:with-param name="clientPrivateData" select="$clientPrivateData.rtf"/><xsl:with-param name="extendedTradeDetails" select="$extendedTradeDetails.rtf"/></xsl:apply-templates></xsl:template><xsl:template match="fpml:SWBML"><xsl:param name="reportingData"/><xsl:param name="brokerPrivateData"/><xsl:param name="partyAPrivateData"/><xsl:param name="partyBPrivateData"/><xsl:param name="brokerPBPrivateData"/><xsl:param name="pbPrivateData"/><xsl:param name="clientPrivateData"/><xsl:param name="extendedTradeDetails"/><Trade version="4-2"><SWBMLVersion><xsl:value-of select="$idm140055992546864-1/@version"/></SWBMLVersion><xsl:variable name="floatingLegId" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/@id)"/><xsl:variable name="fixedLegId" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg]/@id)"/><xsl:variable name="fixedLegId2" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg2]/@id)"/><xsl:variable name="floatingLegId2" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg2]/@id)"/><xsl:variable name="currency"><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='ZC Inflation Swap' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:notionalSchedule/fpml:notionalStepSchedule/fpml:currency"/></xsl:when><xsl:when test="$productType='FRA'"><xsl:value-of select="$idm140055992406288-6/fpml:notional/fpml:currency"/></xsl:when><xsl:when test="$productType='CapFloor'"><xsl:value-of select="$idm140055992405024-8/fpml:notionalSchedule/fpml:notionalStepSchedule/fpml:currency"/></xsl:when><xsl:when test="$productType='Cross Currency IRS'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:notionalSchedule/fpml:notionalStepSchedule/fpml:currency"/></xsl:when><xsl:when test="$productType='Fixed Fixed Swap'"><xsl:choose><xsl:when test="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodAmount/fpml:knownAmountSchedule"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodAmount/fpml:knownAmountSchedule/fpml:currency"/></xsl:when><xsl:otherwise><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:notionalSchedule/fpml:notionalStepSchedule/fpml:currency"/></xsl:otherwise></xsl:choose></xsl:when></xsl:choose></xsl:variable><xsl:variable name="referenceCurrency"><xsl:choose><xsl:when test="$productType='Cross Currency Basis Swap'"><xsl:value-of select="$idm140055992538800-5/fpml:swapStream[position()=$floatingLeg]/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:referenceCurrency"/></xsl:when><xsl:when test="$productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:value-of select="$idm140055992538800-5/fpml:swapStream[position()=$fixedLeg]/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:referenceCurrency"/></xsl:when><xsl:otherwise><xsl:value-of select="$idm140055992546864-6/fpml:swapStream/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:referenceCurrency"/><xsl:value-of select="$idm140055992394416-4/fpml:swbNonDeliverableSettlement/fpml:swbReferenceCurrency"/></xsl:otherwise></xsl:choose></xsl:variable><BrokerSubmitted>true</BrokerSubmitted><BrokerTradeId><xsl:value-of select="$idm140055992392688-2/fpml:swbBrokerTradeId"/></BrokerTradeId><TotalLegs/><BrokerLegId><xsl:value-of select="$idm140055992392688-2/fpml:swbBrokerLegId"/></BrokerLegId><ReplacementTradeId><xsl:value-of select="$idm140055992392688-2/fpml:swbReplacementTradeId/fpml:swbTradeId"/></ReplacementTradeId><ReplacementTradeIdType><xsl:value-of select="$idm140055992392688-2/fpml:swbReplacementTradeId/fpml:swbTradeIdType"/></ReplacementTradeIdType><ReplacementReason><xsl:value-of select="$idm140055992392688-2/fpml:swbReplacementTradeId/fpml:swbReplacementReason"/></ReplacementReason><StrategyType/><StrategyComment/><BrokerTradeVersionId><xsl:value-of select="$idm140055992392688-2/fpml:swbBrokerTradeVersionId"/></BrokerTradeVersionId><LinkedTradeId/><TradeSource><xsl:choose><xsl:when test="$idm140055992392688-2/fpml:swbTradeSource"><xsl:value-of select="$idm140055992392688-2/fpml:swbTradeSource"/></xsl:when><xsl:otherwise>Voice</xsl:otherwise></xsl:choose></TradeSource><xsl:for-each select="$idm140055992392688-2/fpml:swbVenueId"><VenueId><xsl:value-of select="."/></VenueId><xsl:for-each select="@swbVenueIdScheme"><xsl:call-template name="mwrpt:mapVenueIdScheme"/></xsl:for-each></xsl:for-each><MessageText><xsl:value-of select="$idm140055992522592-3/fpml:swbMessageText"/></MessageText><xsl:if test="not(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbClearingHouse/fpml:partyId)"><xsl:variable name="swbSettlementAgent" select="$idm140055992522592-3/fpml:swbSettlementAgent"/><SettlementAgency><xsl:value-of select="$swbSettlementAgent/fpml:swbSettlementAgency/fpml:partyId"/></SettlementAgency><SettlementAgencyModel><xsl:value-of select="$swbSettlementAgent/fpml:swbSettlementAgencyModel"/></SettlementAgencyModel><PBEBSettlementAgency><xsl:value-of select="$idm140055992371904-3/fpml:swbSettlementAgent/fpml:swbSettlementAgency/fpml:partyId"/></PBEBSettlementAgency><PBEBSettlementAgencyModel><xsl:value-of select="$idm140055992371904-3/fpml:swbSettlementAgent/fpml:swbSettlementAgencyModel"/></PBEBSettlementAgencyModel><PBClientSettlementAgency><xsl:value-of select="$idm140055992369888-3/fpml:swbSettlementAgent/fpml:swbSettlementAgency/fpml:partyId"/></PBClientSettlementAgency><PBClientSettlementAgencyModel><xsl:value-of select="$idm140055992369888-3/fpml:swbSettlementAgent/fpml:swbSettlementAgencyModel"/></PBClientSettlementAgencyModel></xsl:if><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS'"><xsl:variable name="conditionPrecedentBondId"><xsl:value-of select="$idm140055992366880-9/fpml:instrumentId"/></xsl:variable><ConditionPrecedentBondId><xsl:value-of select="$conditionPrecedentBondId"/></ConditionPrecedentBondId><ConditionPrecedentBondMaturity><xsl:variable name="bondMaturityDate"><xsl:value-of select="$idm140055992366880-9/fpml:maturity"/></xsl:variable><xsl:if test="not($bondMaturityDate='')"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string($bondMaturityDate)"/></xsl:call-template></xsl:if></ConditionPrecedentBondMaturity><ConditionPrecedentBondIdType><xsl:if test="string-length($conditionPrecedentBondId)=9">CUSIP</xsl:if><xsl:if test="string-length($conditionPrecedentBondId)=12">ISIN</xsl:if></ConditionPrecedentBondIdType><ConditionPrecedentBond><xsl:value-of select="$idm140055992366880-8/fpml:conditionPrecedentBond"/></ConditionPrecedentBond><DiscrepancyClause><xsl:value-of select="$idm140055992366880-8/fpml:discrepancyClause"/></DiscrepancyClause></xsl:if><AllocatedTrade><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbAllocations))"/></AllocatedTrade><xsl:if test="$idm140055992546864-1/fpml:swbAllocations"><xsl:call-template name="fpml:swbAllocations"/></xsl:if><EmptyBlockTrade><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbBlockTrade))"/></EmptyBlockTrade><PrimeBrokerTrade><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbGiveUp))"/></PrimeBrokerTrade><ReversePrimeBrokerLegalEntities><xsl:if test="$idm140055992546864-1/fpml:swbGiveUp"><xsl:value-of select="string(boolean(string(/fpml:SWBML//fpml:swbCustomerTransaction/fpml:swbCustomer/@href)='partyA'))"/></xsl:if></ReversePrimeBrokerLegalEntities><xsl:apply-templates select="$idm140055992392688-2/fpml:swbRecipient"/><xsl:variable name="partyAnode" select="$idm140055992546864-3/fpml:party[@id=$partyA]"/><PartyAId id="{$partyA}"><xsl:value-of select="$partyAnode/fpml:partyId"/></PartyAId><PartyAIdType><xsl:value-of select="$partyAnode/fpml:partyId/@partyIdScheme"/></PartyAIdType><PartyAName><xsl:value-of select="$partyAnode/fpml:partyName"/></PartyAName><xsl:variable name="partyBnode" select="$idm140055992546864-3/fpml:party[@id=$partyB]"/><PartyBId id="{$partyB}"><xsl:value-of select="$partyBnode/fpml:partyId"/></PartyBId><PartyBIdType><xsl:value-of select="$partyBnode/fpml:partyId/@partyIdScheme"/></PartyBIdType><PartyBName><xsl:value-of select="$partyBnode/fpml:partyName"/></PartyBName><PartyCId><xsl:choose><xsl:when test="$idm140055992546864-1/fpml:swbGiveUp"><xsl:attribute name="id"><xsl:value-of select="$partyC"/></xsl:attribute><xsl:value-of select="$idm140055992546864-3/fpml:party[@id=$partyC]/fpml:partyId"/></xsl:when><xsl:when test="$idm140055992339152-5/fpml:partyReference[@href='partyB']"><xsl:attribute name="id"><xsl:value-of select="$partyC"/></xsl:attribute><xsl:value-of select="$idm140055992339152-5[fpml:partyReference/@href='partyB']/fpml:partyId"/></xsl:when><xsl:when test="$idm140055992339152-5"><xsl:attribute name="id"><xsl:value-of select="$partyC"/></xsl:attribute><xsl:value-of select="$idm140055992339152-5/fpml:partyId"/></xsl:when></xsl:choose></PartyCId><PartyCIdType><xsl:choose><xsl:when test="$idm140055992546864-1/fpml:swbGiveUp"><xsl:value-of select="$idm140055992546864-3/fpml:party[@id=$partyC]/fpml:partyId/@partyIdScheme"/></xsl:when><xsl:when test="$idm140055992339152-5/fpml:partyReference[@href='partyB']"><xsl:value-of select="$idm140055992339152-5[fpml:partyReference/@href='partyB']/fpml:partyId/@partyIdScheme"/></xsl:when><xsl:when test="$idm140055992339152-5"><xsl:value-of select="$idm140055992339152-5/fpml:partyId/@partyIdScheme"/></xsl:when></xsl:choose></PartyCIdType><PartyCName><xsl:choose><xsl:when test="$idm140055992546864-1/fpml:swbGiveUp"><xsl:value-of select="$idm140055992546864-3/fpml:party[@id=$partyC]/fpml:partyName"/></xsl:when><xsl:when test="$idm140055992339152-5/fpml:partyReference[@href='partyB']"><xsl:value-of select="$idm140055992339152-5[fpml:partyReference/@href='partyB']/fpml:partyName"/></xsl:when><xsl:when test="$idm140055992339152-5"><xsl:value-of select="$idm140055992339152-5/fpml:partyName"/></xsl:when></xsl:choose></PartyCName><PartyDId><xsl:choose><xsl:when test="$idm140055992546864-1/fpml:swbGiveUp"><xsl:attribute name="id"><xsl:value-of select="$partyD"/></xsl:attribute><xsl:value-of select="$idm140055992546864-3/fpml:party[@id=$partyD]/fpml:partyId"/></xsl:when><xsl:when test="$idm140055992522592-4/fpml:swbPartyClearingBroker"><xsl:attribute name="id"><xsl:value-of select="$partyD"/></xsl:attribute><xsl:for-each select="$idm140055992522592-4/fpml:swbPartyClearingBroker"><xsl:if test="fpml:partyReference/@href= /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbClearingClient/@href"><xsl:value-of select="fpml:swbClearingBroker/fpml:partyId"/></xsl:if></xsl:for-each></xsl:when></xsl:choose></PartyDId><PartyDIdType><xsl:choose><xsl:when test="$idm140055992546864-1/fpml:swbGiveUp"><xsl:value-of select="$idm140055992546864-3/fpml:party[@id=$partyD]/fpml:partyId/@partyIdScheme"/></xsl:when><xsl:when test="$idm140055992522592-4/fpml:swbPartyClearingBroker"><xsl:for-each select="$idm140055992522592-4/fpml:swbPartyClearingBroker"><xsl:if test="fpml:partyReference/@href= /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbClearingClient/@href"><xsl:value-of select="fpml:swbClearingBroker/fpml:partyId/@partyIdScheme"/></xsl:if></xsl:for-each></xsl:when></xsl:choose></PartyDIdType><PartyDName><xsl:choose><xsl:when test="$idm140055992546864-1/fpml:swbGiveUp"><xsl:value-of select="$idm140055992546864-3/fpml:party[@id=$partyD]/fpml:partyName"/></xsl:when><xsl:when test="$idm140055992522592-4/fpml:swbPartyClearingBroker"><xsl:for-each select="$idm140055992522592-4/fpml:swbPartyClearingBroker"><xsl:if test="fpml:partyReference/@href= /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbClearingClient/@href"><xsl:value-of select="fpml:swbClearingBroker/fpml:partyName"/></xsl:if></xsl:for-each></xsl:when></xsl:choose></PartyDName><PartyGId><xsl:if test="$idm140055992546864-1/fpml:swbGiveUp"><xsl:attribute name="id"><xsl:value-of select="$partyG"/></xsl:attribute><xsl:value-of select="$idm140055992546864-3/fpml:party[@id=$partyG]/fpml:partyId"/></xsl:if></PartyGId><PartyGIdType><xsl:if test="$idm140055992546864-1/fpml:swbGiveUp"><xsl:value-of select="$idm140055992546864-3/fpml:party[@id=$partyG]/fpml:partyId/@partyIdScheme"/></xsl:if></PartyGIdType><PartyGName><xsl:if test="$idm140055992546864-1/fpml:swbGiveUp"><xsl:value-of select="$idm140055992546864-3/fpml:party[@id=$partyG]/fpml:partyName"/></xsl:if></PartyGName><PartyHId><xsl:attribute name="id">partyH</xsl:attribute><xsl:value-of select="$idm140055992339152-5[fpml:partyReference/@href='partyA']/fpml:partyId"/></PartyHId><PartyHIdType><xsl:value-of select="$idm140055992339152-5[fpml:partyReference/@href='partyA']/fpml:partyId/@partyIdScheme"/></PartyHIdType><PartyHName><xsl:value-of select="$idm140055992339152-5[fpml:partyReference/@href='partyA']/fpml:partyName"/></PartyHName><BrokerAId><xsl:variable name="broker1" select="$idm140055992546864-4/fpml:otherPartyPayment[1]/fpml:receiverPartyReference/@href"/><xsl:attribute name="id"><xsl:value-of select="$broker1"/></xsl:attribute><xsl:value-of select="$idm140055992546864-3/fpml:party[@id=$broker1]/fpml:partyId"/></BrokerAId><BrokerBId><xsl:variable name="broker2" select="$idm140055992546864-4/fpml:otherPartyPayment[2]/fpml:receiverPartyReference/@href"/><xsl:attribute name="id"><xsl:value-of select="$broker2"/></xsl:attribute><xsl:value-of select="$idm140055992546864-3/fpml:party[@id=$broker2]/fpml:partyId"/></BrokerBId><NominalTerm><xsl:value-of select="$idm140055992522592-3/fpml:swbProductTerm/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992522592-3/fpml:swbProductTerm/fpml:period"/></NominalTerm><FixedRatePayer><xsl:variable name="fixedPayer"><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='ZC Inflation Swap' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:payerPartyReference/@href"/></xsl:when><xsl:when test="$productType='FRA'"><xsl:value-of select="$idm140055992406288-6/fpml:buyerPartyReference/@href"/></xsl:when><xsl:when test="$productType='CapFloor'"><xsl:value-of select="$idm140055992405024-6/fpml:receiverPartyReference/@href"/></xsl:when><xsl:when test="$productType='Swaption'"><xsl:value-of select="$idm140055992284944-5/fpml:buyerPartyReference/@href"/></xsl:when></xsl:choose></xsl:variable><xsl:choose><xsl:when test="$fixedPayer='partyA'">A</xsl:when><xsl:when test="$fixedPayer='partyB'">B</xsl:when><xsl:otherwise>???</xsl:otherwise></xsl:choose></FixedRatePayer><FloatingRatePayer><xsl:if test="$productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap'"><xsl:variable name="floatingPayer" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:payerPartyReference/@href)"/><xsl:choose><xsl:when test="$floatingPayer='partyA'">A</xsl:when><xsl:when test="$floatingPayer='partyB'">B</xsl:when><xsl:otherwise>???</xsl:otherwise></xsl:choose></xsl:if></FloatingRatePayer><TradeDate><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:tradeHeader/fpml:tradeDate)"/></xsl:call-template></TradeDate><StartDate><xsl:variable name="startDate"><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Cross Currency IRS'"><xsl:variable name="fixedStartDate" select="string($fixedStream/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/><xsl:variable name="floatStartDate" select="string($floatingStream/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/><xsl:if test="($fixedStartDate = $floatStartDate)"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string($floatingStream/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/></xsl:call-template></xsl:if></xsl:when><xsl:when test="$productType='Single Currency Basis Swap'"><xsl:variable name="floatingStartDate" select="string($floatingStream/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/><xsl:variable name="floating2StartDate" select="string($floatingStream2/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/><xsl:if test="($floatingStartDate = $floating2StartDate)"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string($floatingStream/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/></xsl:call-template></xsl:if></xsl:when><xsl:when test="$productType='Swaption'  or $productType='ZC Inflation Swap' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap'"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/></xsl:call-template></xsl:when><xsl:when test="$productType='FRA'"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:fra/fpml:adjustedEffectiveDate)"/></xsl:call-template></xsl:when><xsl:when test="$productType='CapFloor'"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:capFloor/fpml:capFloorStream/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/></xsl:call-template></xsl:when><xsl:when test="$productType='Fixed Fixed Swap'"><xsl:variable name="fixedStartDate" select="string($fixedStream/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/><xsl:variable name="fixed2StartDate" select="string($fixedStream2/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/><xsl:if test="($fixedStartDate = $fixed2StartDate)"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string($fixedStream2/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/></xsl:call-template></xsl:if></xsl:when></xsl:choose></xsl:variable><xsl:value-of select="$startDate"/></StartDate><FirstFixedPeriodStartDate><xsl:variable name="firstFixedPeriodStartDate"><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap' or $productType='ZC Inflation Swap'"><xsl:variable name="fixedStartDate" select="string($fixedStream/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/><xsl:variable name="floatStartDate" select="string($floatingStream/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/><xsl:if test="($fixedStartDate != $floatStartDate)"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string($fixedStream/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/></xsl:call-template></xsl:if></xsl:if></xsl:variable><xsl:value-of select="$firstFixedPeriodStartDate"/></FirstFixedPeriodStartDate><FirstFixedPeriodStartDate_2><xsl:variable name="firstFixedPeriodStartDate_2"><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:variable name="fixedStartDate" select="string($fixedStream/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/><xsl:variable name="fixed2StartDate" select="string($fixedStream2/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/><xsl:if test="($fixedStartDate != $fixed2StartDate)"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string($fixedStream2/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/></xsl:call-template></xsl:if></xsl:if></xsl:variable><xsl:value-of select="$firstFixedPeriodStartDate_2"/></FirstFixedPeriodStartDate_2><FirstFloatPeriodStartDate><xsl:variable name="firstFloatPeriodStartDate"><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='ZC Inflation Swap'"><xsl:variable name="fixedStartDate" select="string($fixedStream/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/><xsl:variable name="floatStartDate" select="string($floatingStream/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/><xsl:if test="($fixedStartDate != $floatStartDate)"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string($floatingStream/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/></xsl:call-template></xsl:if></xsl:when><xsl:when test="$productType='Single Currency Basis Swap'"><xsl:variable name="floatingStartDate" select="string($floatingStream/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/><xsl:variable name="floating2StartDate" select="string($floatingStream2/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/><xsl:if test="($floatingStartDate != $floating2StartDate)"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string($floatingStream/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/></xsl:call-template></xsl:if></xsl:when></xsl:choose></xsl:variable><xsl:value-of select="$firstFloatPeriodStartDate"/></FirstFloatPeriodStartDate><FirstFloatPeriodStartDate_2><xsl:variable name="firstFloatPeriodStartDate_2"><xsl:choose><xsl:when test="$productType='Single Currency Basis Swap'"><xsl:variable name="floatingStartDate" select="string($floatingStream/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/><xsl:variable name="floating2StartDate" select="string($floatingStream2/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/><xsl:if test="($floatingStartDate != $floating2StartDate)"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string($floatingStream2/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/></xsl:call-template></xsl:if></xsl:when><xsl:when test="$productType='Cross Currency IRS'"><xsl:variable name="fixedStartDate" select="string($fixedStream/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/><xsl:variable name="floating2StartDate" select="string($floatingStream2/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/><xsl:if test="($fixedStartDate != $floating2StartDate)"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string($floatingStream2/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/></xsl:call-template></xsl:if></xsl:when></xsl:choose></xsl:variable><xsl:value-of select="$firstFloatPeriodStartDate_2"/></FirstFloatPeriodStartDate_2><EndDate><xsl:variable name="endDate"><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='ZC Inflation Swap' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodDates/fpml:terminationDate/fpml:unadjustedDate)"/></xsl:call-template></xsl:when><xsl:when test="$productType='FRA'"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:fra/fpml:adjustedTerminationDate)"/></xsl:call-template></xsl:when><xsl:when test="$productType='CapFloor' and not($swbExtendedTradeDetails/fpml:swbCapFloorDetails/fpml:swbFloatingRateFixingDate/fpml:unadjustedDate)"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:capFloor/fpml:capFloorStream/fpml:calculationPeriodDates/fpml:terminationDate/fpml:unadjustedDate)"/></xsl:call-template></xsl:when><xsl:when test="$productType='Fixed Fixed Swap'"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodDates/fpml:terminationDate/fpml:unadjustedDate)"/></xsl:call-template></xsl:when></xsl:choose></xsl:variable><xsl:value-of select="$endDate"/></EndDate><FixingDate><xsl:variable name="fixingDate"><xsl:choose><xsl:when test="$productType='CapFloor' and $swbExtendedTradeDetails/fpml:swbCapFloorDetails/fpml:swbFloatingRateFixingDate/fpml:unadjustedDate != ''"><xsl:call-template name="formatDate"><xsl:with-param name="date"><xsl:value-of select="$swbExtendedTradeDetails/fpml:swbCapFloorDetails/fpml:swbFloatingRateFixingDate/fpml:unadjustedDate"/></xsl:with-param></xsl:call-template></xsl:when></xsl:choose></xsl:variable><xsl:value-of select="$fixingDate"/></FixingDate><TerminationDays><xsl:variable name="terminationDays"><xsl:if test="$productType='CapFloor'"><xsl:value-of select="$capFloorStream/fpml:calculationPeriodDates/fpml:relativeTerminationDate/fpml:periodMultiplier"/></xsl:if></xsl:variable><xsl:value-of select="$terminationDays"/></TerminationDays><xsl:variable name="termPeriodMultiplier" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbProductTerm/fpml:periodMultiplier)"/><xsl:variable name="termPeriod" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbProductTerm/fpml:period)"/><xsl:variable name="fixPayFreqPeriod" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg]/fpml:paymentDates/fpml:paymentFrequency/fpml:period)"/><xsl:variable name="fltPayFreqPeriod" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:paymentDates/fpml:paymentFrequency/fpml:period)"/><xsl:variable name="start"><xsl:choose><xsl:when test="$productType = 'Fixed Fixed Swap'"><xsl:value-of select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/></xsl:when><xsl:otherwise><xsl:value-of select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:unadjustedDate)"/></xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="end"><xsl:choose><xsl:when test="$productType='Fixed Fixed Swap'"><xsl:value-of select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodDates/fpml:terminationDate/fpml:unadjustedDate)"/></xsl:when><xsl:otherwise><xsl:value-of select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodDates/fpml:terminationDate/fpml:unadjustedDate)"/></xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="isTermUnder1Y"><xsl:choose><xsl:when test="((number(substring($end,1,4)))=(number(substring($start,1,4))))"><xsl:choose><xsl:when test="(number(substring($start,6,2))&lt;number(substring($end,6,2)))">1</xsl:when><xsl:when test="(number(substring($start,6,2))=number(substring($end,6,2))) and (number(substring($start,9,2)) &lt; number(substring($end,9,2)))">1</xsl:when><xsl:otherwise>0</xsl:otherwise></xsl:choose></xsl:when><xsl:otherwise><xsl:if test="((number(substring($end,1,4)) - number(substring($start,1,4)))=1)"><xsl:choose><xsl:when test="(number(substring($end,6,2))&lt;number(substring($start,6,2)))">1</xsl:when><xsl:when test="(number(substring($end,6,2))=number(substring($start,6,2))) and (number(substring($end,9,2)) &lt; number(substring($start,9,2)))">1</xsl:when><xsl:otherwise>0</xsl:otherwise></xsl:choose></xsl:if></xsl:otherwise></xsl:choose></xsl:variable><FixedPaymentFreq><xsl:choose><xsl:when test="$productType='OIS'"><xsl:choose><xsl:when test="$termPeriod = 'W' or ($isTermUnder1Y=1 and $fixPayFreqPeriod = 'Y')">1T</xsl:when><xsl:otherwise><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:paymentDates/fpml:paymentFrequency/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:paymentDates/fpml:paymentFrequency/fpml:period"/></xsl:otherwise></xsl:choose></xsl:when><xsl:otherwise><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='Swaption' or $productType='ZC Inflation Swap' or $productType='Cross Currency IRS' or $productType = 'Fixed Fixed Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:paymentDates/fpml:paymentFrequency/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:paymentDates/fpml:paymentFrequency/fpml:period"/></xsl:if></xsl:otherwise></xsl:choose></FixedPaymentFreq><FixedPaymentFreq_2><xsl:if test="$productType = 'Fixed Fixed Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]/fpml:paymentDates/fpml:paymentFrequency/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]/fpml:paymentDates/fpml:paymentFrequency/fpml:period"/></xsl:if></FixedPaymentFreq_2><FloatPaymentFreq><xsl:choose><xsl:when test="$productType='OIS'"><xsl:choose><xsl:when test="$termPeriod = 'W' or ($isTermUnder1Y=1 and $fltPayFreqPeriod = 'Y')">1T</xsl:when><xsl:otherwise><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:paymentDates/fpml:paymentFrequency/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:paymentDates/fpml:paymentFrequency/fpml:period"/></xsl:otherwise></xsl:choose></xsl:when><xsl:otherwise><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType = 'Swaption' or $productType='ZC Inflation Swap' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:paymentDates/fpml:paymentFrequency/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:paymentDates/fpml:paymentFrequency/fpml:period"/></xsl:when><xsl:when test="$productType='CapFloor'"><xsl:value-of select="$idm140055992162256-7/fpml:paymentFrequency/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992162256-7/fpml:paymentFrequency/fpml:period"/></xsl:when></xsl:choose></xsl:otherwise></xsl:choose></FloatPaymentFreq><FloatPaymentFreq_2><xsl:if test="$productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:paymentDates/fpml:paymentFrequency/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:paymentDates/fpml:paymentFrequency/fpml:period"/></xsl:if></FloatPaymentFreq_2><FloatRollFreq><xsl:choose><xsl:when test="$productType='OIS'"><xsl:choose><xsl:when test="$termPeriod = 'W' or ($isTermUnder1Y=1 and $fltPayFreqPeriod = 'Y')">1T</xsl:when><xsl:otherwise><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodDates/fpml:calculationPeriodFrequency/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodDates/fpml:calculationPeriodFrequency/fpml:period"/></xsl:otherwise></xsl:choose></xsl:when><xsl:otherwise><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType = 'Swaption' or $productType='ZC Inflation Swap' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodDates/fpml:calculationPeriodFrequency/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodDates/fpml:calculationPeriodFrequency/fpml:period"/></xsl:when><xsl:when test="$productType='CapFloor'"><xsl:value-of select="$idm140055992150384-7/fpml:calculationPeriodFrequency/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992150384-7/fpml:calculationPeriodFrequency/fpml:period"/></xsl:when></xsl:choose></xsl:otherwise></xsl:choose></FloatRollFreq><FloatRollFreq_2><xsl:if test="$productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodDates/fpml:calculationPeriodFrequency/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodDates/fpml:calculationPeriodFrequency/fpml:period"/></xsl:if></FloatRollFreq_2><RollsType><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='ZC Inflation Swap' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:variable name="rollConvention" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodDates/fpml:calculationPeriodFrequency/fpml:rollConvention)"/><xsl:choose><xsl:when test="starts-with($rollConvention,'IMM')">IMM</xsl:when><xsl:otherwise>Standard</xsl:otherwise></xsl:choose></xsl:when><xsl:when test="$productType='Fixed Fixed Swap'"><xsl:variable name="rollConvention" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodDates/fpml:calculationPeriodFrequency/fpml:rollConvention)"/><xsl:variable name="rollConvention2" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodDates/fpml:calculationPeriodFrequency/fpml:rollConvention)"/><xsl:choose><xsl:when test="starts-with($rollConvention,'IMM')">IMM</xsl:when><xsl:when test="starts-with($rollConvention2,'IMM')">IMM</xsl:when><xsl:otherwise>Standard</xsl:otherwise></xsl:choose></xsl:when><xsl:when test="$productType='CapFloor'"><xsl:variable name="rollConvention" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:capFloor/fpml:capFloorStream/fpml:calculationPeriodDates/fpml:calculationPeriodFrequency/fpml:rollConvention)"/><xsl:choose><xsl:when test="starts-with($rollConvention,'IMM')">IMM</xsl:when><xsl:otherwise>Standard</xsl:otherwise></xsl:choose></xsl:when></xsl:choose></RollsType><RollsMethod><xsl:if test="($productType='SingleCurrencyInterestRateSwap' or $productType='OIS') and ($currency='AUD' or $currency='NZD' or $currency='CAD')"><xsl:variable name="rollConvention" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodDates/fpml:calculationPeriodFrequency/fpml:rollConvention)"/><xsl:choose><xsl:when test="starts-with($rollConvention,'IMM') and string-length($rollConvention)=6"><xsl:value-of select="substring($rollConvention,4,3)"/></xsl:when><xsl:when test="$rollConvention='IMM'">CME</xsl:when></xsl:choose></xsl:if><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:variable name="rollConvention" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodDates/fpml:calculationPeriodFrequency/fpml:rollConvention)"/><xsl:choose><xsl:when test="starts-with($rollConvention,'IMM') and string-length($rollConvention)=6"><xsl:value-of select="substring($rollConvention,4,3)"/></xsl:when><xsl:when test="$rollConvention='IMM'">CME</xsl:when></xsl:choose></xsl:if><xsl:if test="($productType='Single Currency Basis Swap') and ($currency='AUD')"><xsl:variable name="rollConvention" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodDates/fpml:calculationPeriodFrequency/fpml:rollConvention)"/><xsl:choose><xsl:when test="starts-with($rollConvention,'IMM') and string-length($rollConvention)=6"><xsl:value-of select="substring($rollConvention,4,3)"/></xsl:when><xsl:when test="$rollConvention='IMM'">CME</xsl:when></xsl:choose></xsl:if></RollsMethod><RollDay><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='CapFloor' or $productType='ZC Inflation Swap' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:choose><xsl:when test="$productType='OIS'"><xsl:variable name="fixPayFreq"><xsl:choose><xsl:when test="$termPeriod = 'W' or ($isTermUnder1Y=1 and $fixPayFreqPeriod = 'Y')">1T</xsl:when><xsl:otherwise><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:paymentDates/fpml:paymentFrequency/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:paymentDates/fpml:paymentFrequency/fpml:period"/></xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="fltPayFreq"><xsl:choose><xsl:when test="$termPeriod = 'W' or ($isTermUnder1Y=1 and $fltPayFreqPeriod = 'Y')">1T</xsl:when><xsl:otherwise><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:paymentDates/fpml:paymentFrequency/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:paymentDates/fpml:paymentFrequency/fpml:period"/></xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="rollConvention" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodDates/fpml:calculationPeriodFrequency/fpml:rollConvention)"/><xsl:choose><xsl:when test="starts-with($rollConvention,'IMM')">IMM</xsl:when><xsl:when test="$fixPayFreq='1T' and $fltPayFreq='1T'">NONE</xsl:when><xsl:otherwise><xsl:value-of select="$rollConvention"/></xsl:otherwise></xsl:choose></xsl:when><xsl:when test="$productType='CapFloor'"><xsl:variable name="rollConvention" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:capFloor/fpml:capFloorStream/fpml:calculationPeriodDates/fpml:calculationPeriodFrequency/fpml:rollConvention)"/><xsl:choose><xsl:when test="starts-with($rollConvention,'IMM')">IMM</xsl:when><xsl:otherwise><xsl:value-of select="$rollConvention"/></xsl:otherwise></xsl:choose></xsl:when><xsl:when test="$productType='Fixed Fixed Swap'"><xsl:variable name="rollConvention" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodDates/fpml:calculationPeriodFrequency/fpml:rollConvention)"/><xsl:choose><xsl:when test="starts-with($rollConvention,'IMM')">IMM</xsl:when><xsl:otherwise><xsl:value-of select="$rollConvention"/></xsl:otherwise></xsl:choose></xsl:when><xsl:otherwise><xsl:variable name="rollConvention" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodDates/fpml:calculationPeriodFrequency/fpml:rollConvention)"/><xsl:choose><xsl:when test="starts-with($rollConvention,'IMM')">IMM</xsl:when><xsl:otherwise><xsl:value-of select="$rollConvention"/></xsl:otherwise></xsl:choose></xsl:otherwise></xsl:choose></xsl:if></RollDay><MonthEndRolls><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='CapFloor' or $productType='ZC Inflation Swap' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:variable name="rollConvention"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodDates/fpml:calculationPeriodFrequency/fpml:rollConvention"/><xsl:value-of select="$idm140055992150384-7/fpml:calculationPeriodFrequency/fpml:rollConvention"/></xsl:variable><xsl:value-of select="string(boolean($rollConvention='EOM'))"/></xsl:if><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:variable name="rollConvention"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodDates/fpml:calculationPeriodFrequency/fpml:rollConvention"/></xsl:variable><xsl:value-of select="string(boolean($rollConvention='EOM'))"/></xsl:if></MonthEndRolls><FirstPeriodStartDate/><FirstPaymentDate/><LastRegularPaymentDate/><FixedRate><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='ZC Inflation Swap' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:fixedRateSchedule/fpml:initialValue"/></xsl:when><xsl:when test="$productType='FRA'"><xsl:value-of select="$idm140055992406288-6/fpml:fixedRate"/></xsl:when></xsl:choose></FixedRate><FixedRate_2><xsl:choose><xsl:when test="$productType='Fixed Fixed Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:fixedRateSchedule/fpml:initialValue"/></xsl:when></xsl:choose></FixedRate_2><initialPoints/><quotationStyle/><RecoveryRate/><FixedSettlement/><Strike><xsl:choose><xsl:when test="$productType='CapFloor'"><xsl:choose><xsl:when test="$idm140055992081408-9/fpml:capRateSchedule"><xsl:value-of select="$idm140055992081408-9/fpml:capRateSchedule/fpml:initialValue"/></xsl:when><xsl:otherwise><xsl:value-of select="$idm140055992081408-9/fpml:floorRateSchedule/fpml:initialValue"/></xsl:otherwise></xsl:choose></xsl:when><xsl:when test="$productType='Swaption'"><xsl:value-of select="$idm140055992284944-5/fpml:swap/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:fixedRateSchedule/fpml:initialValue"/></xsl:when></xsl:choose></Strike><StrikePercentage/><StrikeDate/><Currency><xsl:value-of select="$currency"/></Currency><Currency_2><xsl:if test="$productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:choose><xsl:when test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:notionalSchedule/fpml:notionalStepSchedule"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:notionalSchedule/fpml:notionalStepSchedule/fpml:currency"/></xsl:when><xsl:otherwise><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:fxLinkedNotionalSchedule/fpml:varyingNotionalCurrency"/></xsl:otherwise></xsl:choose></xsl:if><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:choose><xsl:when test="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodAmount/fpml:knownAmountSchedule"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodAmount/fpml:knownAmountSchedule/fpml:currency"/></xsl:when><xsl:when test="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:fxLinkedNotionalSchedule"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:fxLinkedNotionalSchedule/fpml:varyingNotionalCurrency"/></xsl:when><xsl:otherwise><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:notionalSchedule/fpml:notionalStepSchedule/fpml:currency"/></xsl:otherwise></xsl:choose></xsl:if></Currency_2><Notional><xsl:choose><xsl:when test="(($productType='SingleCurrencyInterestRateSwap' or $productType='OIS') and /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodAmount/fpml:knownAmountSchedule) or $productType='Swaption' or ($productType='ZC Inflation Swap' and not(//fpml:additionalTerms/fpml:bondReference/fpml:bond/fpml:couponRate))or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:notionalSchedule/fpml:notionalStepSchedule/fpml:initialValue"/></xsl:when><xsl:when test="$productType='FRA'"><xsl:value-of select="$idm140055992406288-6/fpml:notional/fpml:amount"/></xsl:when><xsl:when test="$productType='CapFloor'"><xsl:value-of select="$idm140055992405024-8/fpml:notionalSchedule/fpml:notionalStepSchedule/fpml:initialValue"/></xsl:when><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap' or ($productType='ZC Inflation Swap' and //fpml:additionalTerms/fpml:bondReference/fpml:bond/fpml:couponRate)"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:notionalSchedule/fpml:notionalStepSchedule/fpml:initialValue"/></xsl:when></xsl:choose></Notional><NotionalFloating><xsl:if test="$productType='ZC Inflation Swap' or (($productType='SingleCurrencyInterestRateSwap' or $productType='OIS') and /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:notionalSchedule/fpml:notionalStepSchedule/fpml:initialValue != /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:notionalSchedule/fpml:notionalStepSchedule/fpml:initialValue)"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:notionalSchedule/fpml:notionalStepSchedule/fpml:initialValue"/></xsl:if></NotionalFloating><Notional_2><xsl:if test="$productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:notionalSchedule/fpml:notionalStepSchedule/fpml:initialValue"/></xsl:if><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:notionalSchedule/fpml:notionalStepSchedule/fpml:initialValue"/></xsl:if></Notional_2><InitialNotional><xsl:if test="$productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:fxLinkedNotionalSchedule//fpml:initialValue"/></xsl:if><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:fxLinkedNotionalSchedule//fpml:initialValue"/></xsl:if></InitialNotional><xsl:if test="$productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:for-each select="$floatingStream2/fpml:cashflows/fpml:principalExchange"><xsl:variable name="unadjustedPrincipalExchangeDate"><xsl:value-of select="fpml:unadjustedPrincipalExchangeDate"/></xsl:variable><xsl:variable name="unadjustedDate"><xsl:value-of select="$floatingStream2/fpml:calculationPeriodDates/fpml:terminationDate/fpml:unadjustedDate"/></xsl:variable><xsl:if test="$unadjustedPrincipalExchangeDate = $unadjustedDate"><FinalExchangeAmount><xsl:value-of select="translate(fpml:principalExchangeAmount/text(),'-','')"/></FinalExchangeAmount></xsl:if></xsl:for-each></xsl:if><FixedAmount><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodAmount/fpml:knownAmountSchedule/fpml:initialValue"/></FixedAmount><FixedAmount_2><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodAmount/fpml:knownAmountSchedule/fpml:initialValue"/></xsl:if></FixedAmount_2><FixedAmountCurrency><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodAmount/fpml:knownAmountSchedule/fpml:currency"/></FixedAmountCurrency><FixedAmountCurrency_2><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodAmount/fpml:knownAmountSchedule/fpml:currency"/></xsl:if><xsl:if test="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodAmount/fpml:knownAmountSchedule/fpml:initialValue and $productType='ZC Inflation Swap'">ZCISFA</xsl:if></FixedAmountCurrency_2><FixedDayBasis><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:dayCountFraction"/></FixedDayBasis><FixedDayBasis_2><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:dayCountFraction"/></xsl:if></FixedDayBasis_2><FloatDayBasis><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='ZC Inflation Swap' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:dayCountFraction"/></xsl:when><xsl:when test="$productType='FRA'"><xsl:value-of select="$idm140055992406288-6/fpml:dayCountFraction"/></xsl:when><xsl:when test="$productType='CapFloor'"><xsl:value-of select="$idm140055992405024-8/fpml:dayCountFraction"/></xsl:when></xsl:choose></FloatDayBasis><FloatDayBasis_2><xsl:if test="$productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:dayCountFraction"/></xsl:if></FloatDayBasis_2><FixedConvention><xsl:value-of select="substring(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg]/fpml:paymentDates/fpml:paymentDatesAdjustments/fpml:businessDayConvention,1,4)"/></FixedConvention><FixedConvention_2><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:value-of select="substring(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg2]/fpml:paymentDates/fpml:paymentDatesAdjustments/fpml:businessDayConvention,1,4)"/></xsl:if></FixedConvention_2><FixedCalcPeriodDatesConvention><xsl:if test="$productType='OIS' or $productType='SingleCurrencyInterestRateSwap' or $productType='Fixed Fixed Swap' or $productType='ZC Inflation Swap'"><xsl:value-of select="substring(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodDates/ fpml:calculationPeriodDatesAdjustments/fpml:businessDayConvention,1,4)"/></xsl:if></FixedCalcPeriodDatesConvention><FixedCalcPeriodDatesConvention_2><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:value-of select="substring(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodDates/ fpml:calculationPeriodDatesAdjustments/fpml:businessDayConvention,1,4)"/></xsl:if></FixedCalcPeriodDatesConvention_2><FixedTerminationDateConvention><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap' or $productType='ZC Inflation Swap'"><xsl:value-of select=" substring(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodDates/fpml:terminationDate/fpml:dateAdjustments/fpml:businessDayConvention,1,4)"/></xsl:if></FixedTerminationDateConvention><FixedTerminationDateConvention_2><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:value-of select=" substring(fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodDates/fpml:terminationDate/fpml:dateAdjustments/fpml:businessDayConvention,1,4)"/></xsl:if></FixedTerminationDateConvention_2><FloatConvention><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='ZC Inflation Swap' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap'"><xsl:value-of select="substring(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:paymentDates/fpml:paymentDatesAdjustments/fpml:businessDayConvention,1,4)"/></xsl:when><xsl:when test="$productType='FRA'"><xsl:value-of select="substring(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:fra/fpml:paymentDate/fpml:dateAdjustments/fpml:businessDayConvention,1,4)"/></xsl:when><xsl:when test="$productType='CapFloor'"><xsl:value-of select="substring(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:capFloor/fpml:capFloorStream/fpml:paymentDates/fpml:paymentDatesAdjustments/fpml:businessDayConvention,1,4)"/></xsl:when></xsl:choose></FloatConvention><FloatCalcPeriodDatesConvention><xsl:if test="$productType='OIS' or $productType='SingleCurrencyInterestRateSwap' or $productType='ZC Inflation Swap'"><xsl:value-of select="substring(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodDates/ fpml:calculationPeriodDatesAdjustments/fpml:businessDayConvention,1,4)"/></xsl:if></FloatCalcPeriodDatesConvention><FloatTerminationDateConvention><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='ZC Inflation Swap'"><xsl:value-of select=" substring(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodDates/fpml:terminationDate/fpml:dateAdjustments/fpml:businessDayConvention,1,4)"/></xsl:if></FloatTerminationDateConvention><FloatConvention_2><xsl:if test="$productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:value-of select="substring(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg2]/fpml:paymentDates/fpml:paymentDatesAdjustments/fpml:businessDayConvention,1,4)"/></xsl:if></FloatConvention_2><FloatTerminationDateConvention_2><xsl:if test="$productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:value-of select=" substring(fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodDates/fpml:terminationDate/fpml:dateAdjustments/fpml:businessDayConvention,1,4)"/></xsl:if></FloatTerminationDateConvention_2><FloatingRateIndex><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:floatingRateIndex"/></xsl:when><xsl:when test="$productType='FRA'"><xsl:value-of select="$idm140055992406288-6/fpml:floatingRateIndex"/></xsl:when><xsl:when test="$productType='CapFloor'"><xsl:value-of select="$idm140055992081408-9/fpml:floatingRateIndex"/></xsl:when><xsl:when test="$productType='ZC Inflation Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:inflationRateCalculation/fpml:floatingRateIndex"/></xsl:when></xsl:choose></FloatingRateIndex><FloatingRateIndex_2><xsl:if test="$productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:floatingRateIndex"/></xsl:if></FloatingRateIndex_2><InflationLag><xsl:if test="$productType='ZC Inflation Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:inflationRateCalculation/fpml:inflationLag/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:inflationRateCalculation/fpml:inflationLag/fpml:period"/></xsl:if></InflationLag><IndexSource><xsl:if test="$productType='ZC Inflation Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:inflationRateCalculation/fpml:indexSource"/></xsl:if></IndexSource><InterpolationMethod><xsl:if test="$productType='ZC Inflation Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:inflationRateCalculation/fpml:interpolationMethod"/></xsl:if></InterpolationMethod><InitialIndexLevel><xsl:if test="$productType='ZC Inflation Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:inflationRateCalculation/fpml:initialIndexLevel"/></xsl:if></InitialIndexLevel><RelatedBond><xsl:if test="$productType='ZC Inflation Swap'"><xsl:value-of select="$idm140055992366880-9/fpml:instrumentId"/></xsl:if></RelatedBond><IndexTenor1><xsl:choose><xsl:when test="$productType='FRA'"><xsl:value-of select="$idm140055992406288-6/fpml:indexTenor[1]/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992406288-6/fpml:indexTenor[1]/fpml:period"/></xsl:when><xsl:when test="$productType='CapFloor'"><xsl:value-of select="$idm140055992405024-6/fpml:stubCalculationPeriodAmount//fpml:floatingRate/fpml:indexTenor/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992405024-6/fpml:stubCalculationPeriodAmount//fpml:floatingRate/fpml:indexTenor/fpml:period"/></xsl:when><xsl:when test="$productType='SingleCurrencyInterestRateSwap' and /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbFrontAndBackStubs"><xsl:value-of select="$idm140055992538800-5/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount/fpml:initialStub/fpml:floatingRate[1]/fpml:indexTenor/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992538800-5/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount/fpml:initialStub/fpml:floatingRate[1]/fpml:indexTenor/fpml:period"/></xsl:when><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='Swaption' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount//fpml:floatingRate[1]/fpml:indexTenor/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount//fpml:floatingRate[1]/fpml:indexTenor/fpml:period"/></xsl:when><xsl:when test="$productType='Fixed Fixed Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:stubCalculationPeriodAmount//fpml:fixedRate[1]/fpml:indexTenor/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:stubCalculationPeriodAmount//fpml:fixedRate[1]/fpml:indexTenor/fpml:period"/></xsl:when></xsl:choose></IndexTenor1><IndexTenor1_2><xsl:if test="$productType = 'Single Currency Basis Swap' or $productType = 'Cross Currency Basis Swap' or $productType = 'Cross Currency IRS'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:stubCalculationPeriodAmount//fpml:floatingRate[1]/fpml:indexTenor/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:stubCalculationPeriodAmount//fpml:floatingRate[1]/fpml:indexTenor/fpml:period"/></xsl:if><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]/fpml:stubCalculationPeriodAmount//fpml:fixedRate[1]/fpml:indexTenor/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]/fpml:stubCalculationPeriodAmount//fpml:fixedRate[1]/fpml:indexTenor/fpml:period"/></xsl:if></IndexTenor1_2><LinearInterpolation><xsl:choose><xsl:when test="$productType='FRA'"><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:fra/fpml:indexTenor[2]))"/></xsl:when><xsl:when test="$productType='CapFloor' and /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:capFloor/fpml:capFloorStream/fpml:stubCalculationPeriodAmount//fpml:floatingRate[1]"><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:capFloor/fpml:capFloorStream/fpml:stubCalculationPeriodAmount//fpml:floatingRate[2]))"/></xsl:when><xsl:when test="$productType='SingleCurrencyInterestRateSwap' and /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbFrontAndBackStubs"><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount/fpml:initialStub/fpml:floatingRate[2]))"/></xsl:when><xsl:when test="($productType='SingleCurrencyInterestRateSwap' or $productType='Swaption' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap') and /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount//fpml:floatingRate[1]"><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount//fpml:floatingRate[2]))"/></xsl:when></xsl:choose></LinearInterpolation><LinearInterpolation_2><xsl:choose><xsl:when test="($productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS') and /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swap/fpml:swapStream[position()=$floatingLeg2]/fpml:stubCalculationPeriodAmount//fpml:floatingRate[1]"><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swap/fpml:swapStream[position()=$floatingLeg2]/fpml:stubCalculationPeriodAmount//fpml:floatingRate[2]))"/></xsl:when></xsl:choose></LinearInterpolation_2><NoStubLinearInterpolation><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='Swaption' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap'"><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbNoStubLinearInterpolation[@href=$floatingLegId]))"/></xsl:when><xsl:when test="$productType='CapFloor'"><xsl:variable name="capFloorFloatingLegId" select="$idm140055992405024-6/@id"/><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbNoStubLinearInterpolation[@href=$capFloorFloatingLegId]))"/></xsl:when></xsl:choose></NoStubLinearInterpolation><NoStubLinearInterpolation2><xsl:if test="$productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbNoStubLinearInterpolation[@href=$floatingLegId2]))"/></xsl:if></NoStubLinearInterpolation2><IndexTenor2><xsl:choose><xsl:when test="$productType='FRA'"><xsl:value-of select="$idm140055992406288-6/fpml:indexTenor[2]/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992406288-6/fpml:indexTenor[2]/fpml:period"/></xsl:when><xsl:when test="$productType='CapFloor'"><xsl:value-of select="$idm140055992546864-4//fpml:capFloor/fpml:capFloorStream/fpml:stubCalculationPeriodAmount//fpml:floatingRate[2]/fpml:indexTenor/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992546864-4//fpml:capFloor/fpml:capFloorStream/fpml:stubCalculationPeriodAmount//fpml:floatingRate[2]/fpml:indexTenor/fpml:period"/></xsl:when><xsl:when test="$productType='SingleCurrencyInterestRateSwap' and /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbFrontAndBackStubs"><xsl:value-of select="$idm140055992538800-5/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount/fpml:initialStub/fpml:floatingRate[2]/fpml:indexTenor/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992538800-5/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount/fpml:initialStub/fpml:floatingRate[2]/fpml:indexTenor/fpml:period"/></xsl:when><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='Swaption' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount//fpml:floatingRate[2]/fpml:indexTenor/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount//fpml:floatingRate[2]/fpml:indexTenor/fpml:period"/></xsl:when><xsl:when test="$productType='Fixed Fixed Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:stubCalculationPeriodAmount//fpml:fixedRate[2]/fpml:indexTenor/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:stubCalculationPeriodAmount//fpml:fixedRate[2]/fpml:indexTenor/fpml:period"/></xsl:when></xsl:choose></IndexTenor2><IndexTenor2_2><xsl:if test="$productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:stubCalculationPeriodAmount//fpml:floatingRate[2]/fpml:indexTenor/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:stubCalculationPeriodAmount//fpml:floatingRate[2]/fpml:indexTenor/fpml:period"/></xsl:if><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]/fpml:stubCalculationPeriodAmount//fpml:fixedRate[2]/fpml:indexTenor/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]/fpml:stubCalculationPeriodAmount//fpml:fixedRate[2]/fpml:indexTenor/fpml:period"/></xsl:if></IndexTenor2_2><InitialInterpolationIndex><xsl:choose><xsl:when test="$productType='CapFloor' and count(/fpml:SWBML//fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:capFloor/fpml:capFloorStream/fpml:stubCalculationPeriodAmount//fpml:floatingRate)=2 and /fpml:SWBML//fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:capFloor/fpml:capFloorStream/fpml:stubCalculationPeriodAmount//fpml:floatingRate != /fpml:SWBML//fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:capFloor/fpml:capFloorStream/fpml:stubCalculationPeriodAmount//fpml:floatingRate[2]/fpml:floatingRateIndex"><xsl:value-of select="$idm140055991938160-5//fpml:capFloor/fpml:capFloorStream/fpml:stubCalculationPeriodAmount//fpml:floatingRate[1]/fpml:floatingRateIndex"/></xsl:when><xsl:when test="$productType='SingleCurrencyInterestRateSwap' and /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbFrontAndBackStubs and count(/fpml:SWBML//fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount/fpml:initialStub/fpml:floatingRate)=2 and /fpml:SWBML//fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount/fpml:initialStub/fpml:floatingRate[1]/fpml:floatingRateIndex != /fpml:SWBML//fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount/fpml:initialStub/fpml:floatingRate[2]/fpml:floatingRateIndex"><xsl:value-of select="$idm140055991938160-5//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount/fpml:initialStub/fpml:floatingRate[1]/fpml:floatingRateIndex"/></xsl:when><xsl:when test="($productType='SingleCurrencyInterestRateSwap' or $productType='Swaption' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap') and count(/fpml:SWBML//fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount//fpml:floatingRate)=2 and /fpml:SWBML//fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount//fpml:floatingRate[1]/fpml:floatingRateIndex != /fpml:SWBML//fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount//fpml:floatingRate[2]/fpml:floatingRateIndex"><xsl:value-of select="$idm140055991938160-5//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount//fpml:floatingRate[1]/fpml:floatingRateIndex"/></xsl:when></xsl:choose></InitialInterpolationIndex><InitialInterpolationIndex_2><xsl:if test="($productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS') and count(/fpml:SWBML//fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg2]/fpml:stubCalculationPeriodAmount//fpml:floatingRate)=2 and /fpml:SWBML//fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg2]/fpml:stubCalculationPeriodAmount//fpml:floatingRate[1]/fpml:floatingRateIndex != /fpml:SWBML//fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg2]/fpml:stubCalculationPeriodAmount//fpml:floatingRate[2]/fpml:floatingRateIndex"><xsl:value-of select="$idm140055992538800-5/fpml:swapStream[position()=$floatingLeg2]/fpml:stubCalculationPeriodAmount//fpml:floatingRate[1]/fpml:floatingRateIndex"/></xsl:if></InitialInterpolationIndex_2><CMSCalcAgent><xsl:if test="$productType='CapFloor' and /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbCapFloorDetails/fpml:calculationAgent"><xsl:choose><xsl:when test="count(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbCapFloorDetails/fpml:calculationAgent/fpml:calculationAgentPartyReference) = 2">Joint</xsl:when><xsl:when test="$idm140055992522592-3/fpml:swbCapFloorDetails/fpml:calculationAgent/fpml:calculationAgentPartyReference/@href = /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:capFloor/fpml:capFloorStream/fpml:receiverPartyReference/@href">Buyer</xsl:when><xsl:when test="$idm140055992522592-3/fpml:swbCapFloorDetails/fpml:calculationAgent/fpml:calculationAgentPartyReference/@href = /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:capFloor/fpml:capFloorStream/fpml:payerPartyReference/@href">Seller</xsl:when><xsl:when test="$idm140055992522592-3/fpml:swbCapFloorDetails/fpml:calculationAgent/fpml:calculationAgentParty[.='AsSpecifiedInMasterAgreement']">As Specified in Master Agreement</xsl:when><xsl:otherwise>???</xsl:otherwise></xsl:choose></xsl:if></CMSCalcAgent><CompoundingCalculationMethod><xsl:if test="$productType='Single Currency Basis Swap' or $productType='OIS' or $productType='Cross Currency Basis Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:calculationParameters/fpml:calculationMethod"/></xsl:if></CompoundingCalculationMethod><CompoundingCalculationMethod_2><xsl:if test="$productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:calculationParameters/fpml:calculationMethod"/></xsl:if></CompoundingCalculationMethod_2><ObservationMethod><xsl:if test="($productType='Single Currency Basis Swap' or $productType='OIS' or $productType='Cross Currency Basis Swap')"><xsl:if test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:calculationParameters/fpml:lookback">Lookback</xsl:if><xsl:if test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:calculationParameters/fpml:lockout">Lockout</xsl:if><xsl:if test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:calculationParameters/fpml:observationShift">ObservationPeriodShift</xsl:if></xsl:if></ObservationMethod><ObservationMethod_2><xsl:if test="($productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS')"><xsl:if test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:calculationParameters/fpml:lookback">Lookback</xsl:if><xsl:if test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:calculationParameters/fpml:lockout">Lockout</xsl:if><xsl:if test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:calculationParameters/fpml:observationShift">ObservationPeriodShift</xsl:if></xsl:if></ObservationMethod_2><OffsetDays><xsl:if test="($productType='Single Currency Basis Swap' or $productType='OIS'  or $productType='Cross Currency Basis Swap')"><xsl:if test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:calculationParameters/fpml:lookback/fpml:offsetDays or /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:calculationParameters/fpml:lockout/fpml:offsetDays or /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:calculationParameters/fpml:observationShift/fpml:offsetDays"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:calculationParameters//fpml:offsetDays"/></xsl:if></xsl:if></OffsetDays><OffsetDays_2><xsl:if test="$productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:if test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:calculationParameters/fpml:lookback/fpml:offsetDays or /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:calculationParameters/fpml:lockout/fpml:offsetDays or /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg2]/fpml:caculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:calculationParameters/fpml:observationShift/fpml:offsetDays"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:calculationParameters//fpml:offsetDays"/></xsl:if></xsl:if></OffsetDays_2><ObservationPeriodDates><xsl:if test="($productType='Single Currency Basis Swap' or $productType='OIS'  or $productType='Cross Currency Basis Swap')"><xsl:if test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:calculationParameters/fpml:observationShift/fpml:observationPeriodDates"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:calculationParameters/fpml:observationShift/fpml:observationPeriodDates"/></xsl:if></xsl:if></ObservationPeriodDates><ObservationPeriodDates_2><xsl:if test="($productType='Single Currency Basis Swap'  or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS')"><xsl:if test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:calculationParameters/fpml:observationShift/fpml:observationPeriodDates"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:calculationParameters/fpml:observationShift/fpml:observationPeriodDates"/></xsl:if></xsl:if></ObservationPeriodDates_2><ObservationAdditionalBusinessDays><xsl:if test="($productType='Single Currency Basis Swap' or $productType='OIS'  or $productType='Cross Currency Basis Swap')"><xsl:if test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:calculationParameters/fpml:observationShift/fpml:additionalBusinessDays/fpml:businessCenters"><xsl:apply-templates select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:calculationParameters/fpml:observationShift/fpml:additionalBusinessDays/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:if></xsl:if></ObservationAdditionalBusinessDays><ObservationAdditionalBusinessDays_2><xsl:if test="($productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS')"><xsl:if test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:calculationParameters/fpml:observationShift/fpml:additionalBusinessDays/fpml:businessCenters"><xsl:apply-templates select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:calculationParameters/fpml:observationShift/fpml:additionalBusinessDays/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:if></xsl:if></ObservationAdditionalBusinessDays_2><ObservationHolidayCentre><xsl:if test="($productType='Single Currency Basis Swap' or $productType='OIS'  or $productType='Cross Currency Basis Swap')"><xsl:if test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:calculationParameters/fpml:applicableBusinessDays/fpml:businessCenters"><xsl:apply-templates select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:calculationParameters/fpml:applicableBusinessDays/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:if></xsl:if></ObservationHolidayCentre><ObservationHolidayCentre_2><xsl:if test="($productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS')"><xsl:if test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:calculationParameters/fpml:applicableBusinessDays/fpml:businessCenters"><xsl:apply-templates select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:calculationParameters/fpml:applicableBusinessDays/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:if></xsl:if></ObservationHolidayCentre_2><CancelableCalcAgent><xsl:if test="($productType='SingleCurrencyInterestRateSwap' or $productType='OIS') and /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:calculationAgent"><xsl:choose><xsl:when test="count(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:calculationAgent/fpml:calculationAgentPartyReference) = 2">Joint</xsl:when><xsl:when test="$idm140055992522592-3/fpml:calculationAgent/fpml:calculationAgentPartyReference/@href = /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:receiverPartyReference/@href">Buyer</xsl:when><xsl:when test="$idm140055992522592-3/fpml:calculationAgent/fpml:calculationAgentPartyReference/@href = /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:payerPartyReference/@href">Seller</xsl:when><xsl:when test="$idm140055992522592-3/fpml:calculationAgent/fpml:calculationAgentParty[.='AsSpecifiedInMasterAgreement']">As Specified in Master Agreement</xsl:when><xsl:otherwise>???</xsl:otherwise></xsl:choose></xsl:if></CancelableCalcAgent><SpreadOverIndex><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='CapFloor' or $productType='Swaption' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap'"><xsl:choose><xsl:when test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:spreadSchedule/fpml:initialValue"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:spreadSchedule/fpml:initialValue"/></xsl:when><xsl:when test="$idm140055992081408-9/fpml:spreadSchedule/fpml:initialValue"><xsl:value-of select="$idm140055992081408-9/fpml:spreadSchedule/fpml:initialValue"/></xsl:when><xsl:otherwise>0</xsl:otherwise></xsl:choose></xsl:if></SpreadOverIndex><SpreadOverIndex_2><xsl:if test="$productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:choose><xsl:when test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:spreadSchedule/fpml:initialValue"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:spreadSchedule/fpml:initialValue"/></xsl:when><xsl:otherwise>0</xsl:otherwise></xsl:choose></xsl:if></SpreadOverIndex_2><FirstFixingRate><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap'"><xsl:choose><xsl:when test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount/fpml:initialStub/fpml:stubRate"><xsl:variable name="initialRate" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount/fpml:initialStub/fpml:stubRate)"/><xsl:choose><xsl:when test="number($initialRate) = 0"/><xsl:otherwise><xsl:value-of select="$initialRate"/></xsl:otherwise></xsl:choose></xsl:when><xsl:when test="$idm140055992538800-5/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:initialRate"><xsl:variable name="initialRate" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:initialRate)"/><xsl:choose><xsl:when test="number($initialRate) = 0"/><xsl:otherwise><xsl:value-of select="$initialRate"/></xsl:otherwise></xsl:choose></xsl:when></xsl:choose></xsl:if></FirstFixingRate><FirstFixingRate_2><xsl:if test="$productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:choose><xsl:when test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:stubCalculationPeriodAmount/fpml:initialStub/fpml:stubRate"><xsl:variable name="initialRate" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg2]/fpml:stubCalculationPeriodAmount/fpml:initialStub/fpml:stubRate)"/><xsl:choose><xsl:when test="number($initialRate) = 0"/><xsl:otherwise><xsl:value-of select="$initialRate"/></xsl:otherwise></xsl:choose></xsl:when><xsl:when test="$idm140055992538800-5/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:initialRate"><xsl:variable name="initialRate" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:initialRate)"/><xsl:choose><xsl:when test="number($initialRate) = 0"/><xsl:otherwise><xsl:value-of select="$initialRate"/></xsl:otherwise></xsl:choose></xsl:when></xsl:choose></xsl:if></FirstFixingRate_2><FixingDaysOffset><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='ZC Inflation Swap' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:resetDates/fpml:fixingDates/fpml:periodMultiplier"/></xsl:when><xsl:when test="$productType='FRA'"><xsl:value-of select="$idm140055992406288-6/fpml:fixingDateOffset/fpml:periodMultiplier"/></xsl:when><xsl:when test="$productType='CapFloor'"><xsl:value-of select="$idm140055992405024-6/fpml:resetDates/fpml:fixingDates/fpml:periodMultiplier"/></xsl:when></xsl:choose></FixingDaysOffset><FixingDaysOffset_2><xsl:if test="$productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:resetDates/fpml:fixingDates/fpml:periodMultiplier"/></xsl:if></FixingDaysOffset_2><FixingHolidayCentres><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap'"><xsl:apply-templates select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:resetDates/fpml:fixingDates/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:when><xsl:when test="$productType='FRA'"><xsl:apply-templates select="$idm140055992406288-6/fpml:fixingDateOffset/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:when><xsl:when test="$productType='CapFloor'"><xsl:choose><xsl:when test="not($swbExtendedTradeDetails/fpml:swbCapFloorDetails/fpml:swbFloatingRateFixingDate/fpml:unadjustedDate)"><xsl:apply-templates select="$idm140055992405024-6/fpml:resetDates/fpml:fixingDates/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:when><xsl:otherwise><xsl:apply-templates select="$swbExtendedTradeDetails/fpml:swbCapFloorDetails/fpml:swbFloatingRateFixingDate/fpml:dateAdjustments/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:otherwise></xsl:choose></xsl:when></xsl:choose></FixingHolidayCentres><FixingHolidayCentres_2><xsl:if test="$productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:apply-templates select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:resetDates/fpml:fixingDates/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:if></FixingHolidayCentres_2><ResetInArrears><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap'"><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:resetDates[fpml:resetRelativeTo='CalculationPeriodEndDate']))"/></xsl:when><xsl:when test="$productType='CapFloor'"><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:capFloor/fpml:capFloorStream/fpml:resetDates[fpml:resetRelativeTo='CalculationPeriodEndDate']))"/></xsl:when></xsl:choose></ResetInArrears><ResetInArrears_2><xsl:if test="$productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg2]/fpml:resetDates[fpml:resetRelativeTo='CalculationPeriodEndDate']))"/></xsl:if></ResetInArrears_2><FirstFixingDifferent><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='ZC Inflation Swap' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap'"><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:resetDates/fpml:initialFixingDate))"/></xsl:if></FirstFixingDifferent><FirstFixingDifferent_2><xsl:if test="$productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg2]/fpml:resetDates/fpml:initialFixingDate))"/></xsl:if></FirstFixingDifferent_2><FirstFixingDaysOffset><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='ZC Inflation Swap' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:resetDates/fpml:initialFixingDate/fpml:periodMultiplier"/></xsl:if></FirstFixingDaysOffset><FirstFixingDaysOffset_2><xsl:if test="$productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:resetDates/fpml:initialFixingDate/fpml:periodMultiplier"/></xsl:if></FirstFixingDaysOffset_2><FirstFixingHolidayCentres><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='ZC Inflation Swap' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap'"><xsl:apply-templates select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:resetDates/fpml:initialFixingDate/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:if></FirstFixingHolidayCentres><FirstFixingHolidayCentres_2><xsl:if test="$productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:apply-templates select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:resetDates/fpml:initialFixingDate/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:if></FirstFixingHolidayCentres_2><PaymentHolidayCentres><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='ZC Inflation Swap' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap'"><xsl:apply-templates select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:paymentDates/fpml:paymentDatesAdjustments/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:when><xsl:when test="$productType='FRA'"><xsl:apply-templates select="$idm140055992406288-6/fpml:paymentDate/fpml:dateAdjustments/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:when><xsl:when test="$productType='CapFloor'"><xsl:apply-templates select="$idm140055992162256-7/fpml:paymentDatesAdjustments/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:when><xsl:when test="$productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:apply-templates select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:paymentDates/fpml:paymentDatesAdjustments/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:when></xsl:choose></PaymentHolidayCentres><PaymentHolidayCentres_2><xsl:choose><xsl:when test="$productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:apply-templates select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:paymentDates/fpml:paymentDatesAdjustments/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:when><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS'"><xsl:apply-templates select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:paymentDates/fpml:paymentDatesAdjustments/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:when><xsl:when test="$productType='Fixed Fixed Swap'"><xsl:apply-templates select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]/fpml:paymentDates/fpml:paymentDatesAdjustments/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:when></xsl:choose></PaymentHolidayCentres_2><PaymentLag><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='CapFloor' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap'"><xsl:choose><xsl:when test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:paymentDates/fpml:paymentDaysOffset"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:paymentDates/fpml:paymentDaysOffset/fpml:periodMultiplier"/></xsl:when><xsl:when test="$idm140055992162256-7/fpml:paymentDaysOffset"><xsl:value-of select="$idm140055992162256-7/fpml:paymentDaysOffset/fpml:periodMultiplier"/></xsl:when><xsl:otherwise>0</xsl:otherwise></xsl:choose></xsl:when><xsl:when test="$productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:choose><xsl:when test="$idm140055992546864-6/fpml:swapStream[@id='fixedLeg']/fpml:paymentDates/fpml:paymentDaysOffset"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[@id='fixedLeg']/fpml:paymentDates/fpml:paymentDaysOffset/fpml:periodMultiplier"/></xsl:when><xsl:otherwise>0</xsl:otherwise></xsl:choose></xsl:when></xsl:choose></PaymentLag><PaymentLag_2><xsl:if test="$productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:choose><xsl:when test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:paymentDates/fpml:paymentDaysOffset"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:paymentDates/fpml:paymentDaysOffset/fpml:periodMultiplier"/></xsl:when><xsl:otherwise>0</xsl:otherwise></xsl:choose></xsl:if><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:choose><xsl:when test="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]/fpml:paymentDates/fpml:paymentDaysOffset"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]/fpml:paymentDates/fpml:paymentDaysOffset/fpml:periodMultiplier"/></xsl:when><xsl:otherwise>0</xsl:otherwise></xsl:choose></xsl:if><xsl:if test="$productType='OIS' or $productType='SingleCurrencyInterestRateSwap'"><xsl:choose><xsl:when test="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:paymentDates/fpml:paymentDaysOffset"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:paymentDates/fpml:paymentDaysOffset/fpml:periodMultiplier"/></xsl:when><xsl:otherwise>0</xsl:otherwise></xsl:choose></xsl:if></PaymentLag_2><RollHolidayCentres><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='ZC Inflation Swap' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap'"><xsl:choose><xsl:when test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodDates/fpml:calculationPeriodDatesAdjustments/fpml:businessDayConvention != 'NONE'"><xsl:apply-templates select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodDates/fpml:calculationPeriodDatesAdjustments/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:when><xsl:when test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodDates/fpml:terminationDate/fpml:dateAdjustments/fpml:businessDayConvention != 'NONE'"><xsl:apply-templates select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodDates/fpml:terminationDate/fpml:dateAdjustments/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:when><xsl:otherwise><xsl:apply-templates select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:dateAdjustments/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:otherwise></xsl:choose></xsl:when><xsl:when test="$productType='CapFloor'"><xsl:choose><xsl:when test="$capFloorStream/fpml:calculationPeriodDates/fpml:relativeTerminationDate/fpml:businessDayConvention != ''"><xsl:apply-templates select="$capFloorStream/fpml:calculationPeriodDates/fpml:relativeTerminationDate/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:when><xsl:when test="$capFloorStream/fpml:calculationPeriodDates/fpml:calculationPeriodDatesAdjustments/fpml:businessDayConvention = 'NONE'"><xsl:apply-templates select="$capFloorStream/fpml:paymentDates/fpml:paymentDatesAdjustments/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:when><xsl:otherwise><xsl:apply-templates select="$capFloorStream/fpml:calculationPeriodDates/fpml:calculationPeriodDatesAdjustments/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:otherwise></xsl:choose></xsl:when><xsl:when test="$productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:apply-templates select="$idm140055992546864-6/fpml:swapStream[@id='fixedLeg']/fpml:calculationPeriodDates/fpml:calculationPeriodDatesAdjustments/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:when></xsl:choose></RollHolidayCentres><RollHolidayCentres_2><xsl:choose><xsl:when test="$productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:choose><xsl:when test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodDates/fpml:calculationPeriodDatesAdjustments/fpml:businessDayConvention != 'NONE'"><xsl:apply-templates select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodDates/fpml:calculationPeriodDatesAdjustments/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:when><xsl:when test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodDates/fpml:terminationDate/fpml:dateAdjustments/fpml:businessDayConvention != 'NONE'"><xsl:apply-templates select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodDates/fpml:terminationDate/fpml:dateAdjustments/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:when><xsl:otherwise><xsl:apply-templates select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:dateAdjustments/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:otherwise></xsl:choose></xsl:when><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS'"><xsl:choose><xsl:when test="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodDates/fpml:calculationPeriodDatesAdjustments/fpml:businessDayConvention != 'NONE'"><xsl:apply-templates select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodDates/fpml:calculationPeriodDatesAdjustments/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:when><xsl:when test="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodDates/fpml:terminationDate/fpml:dateAdjustments/fpml:businessDayConvention != 'NONE'"><xsl:apply-templates select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodDates/fpml:terminationDate/fpml:dateAdjustments/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:when><xsl:otherwise><xsl:apply-templates select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:dateAdjustments/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:otherwise></xsl:choose></xsl:when><xsl:when test="$productType='Fixed Fixed Swap'"><xsl:apply-templates select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodDates/fpml:calculationPeriodDatesAdjustments/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:when></xsl:choose></RollHolidayCentres_2><AdjustFixedStartDate><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='ZC Inflation Swap' or $productType='OIS' or $productType='Swaption' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:variable name="effDateBusDayConv" select="string(/fpml:SWBML//fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:dateAdjustments/fpml:businessDayConvention)"/><xsl:choose><xsl:when test="$effDateBusDayConv='NONE'">false</xsl:when><xsl:otherwise>true</xsl:otherwise></xsl:choose></xsl:if></AdjustFixedStartDate><AdjustFixedStartDate_2><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:variable name="effDateBusDayConv" select="string(/fpml:SWBML//fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:dateAdjustments/fpml:businessDayConvention)"/><xsl:choose><xsl:when test="$effDateBusDayConv='NONE'">false</xsl:when><xsl:otherwise>true</xsl:otherwise></xsl:choose></xsl:if></AdjustFixedStartDate_2><AdjustFloatStartDate><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='ZC Inflation Swap' or $productType='OIS' or $productType='Swaption' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap'"><xsl:variable name="effDateBusDayConv" select="string(/fpml:SWBML//fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:dateAdjustments/fpml:businessDayConvention)"/><xsl:choose><xsl:when test="$effDateBusDayConv='NONE'">false</xsl:when><xsl:otherwise>true</xsl:otherwise></xsl:choose></xsl:when><xsl:when test="$productType='CapFloor'"><xsl:variable name="effDateBusDayConv" select="string(/fpml:SWBML//fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:capFloor/fpml:capFloorStream/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:dateAdjustments/fpml:businessDayConvention)"/><xsl:choose><xsl:when test="$effDateBusDayConv='NONE'">false</xsl:when><xsl:otherwise>true</xsl:otherwise></xsl:choose></xsl:when></xsl:choose></AdjustFloatStartDate><AdjustFloatStartDate_2><xsl:if test="$productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:variable name="effDateBusDayConv2" select="string(/fpml:SWBML//fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodDates/fpml:effectiveDate/fpml:dateAdjustments/fpml:businessDayConvention)"/><xsl:choose><xsl:when test="$effDateBusDayConv2='NONE'">false</xsl:when><xsl:otherwise>true</xsl:otherwise></xsl:choose></xsl:if></AdjustFloatStartDate_2><AdjustRollEnd><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='CapFloor' or $productType='ZC Inflation Swap' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='ZC Inflation Swap' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:variable name="fixedCalcPeriodBusDayConv" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodDates/fpml:calculationPeriodDatesAdjustments/fpml:businessDayConvention)"/><xsl:choose><xsl:when test="$fixedCalcPeriodBusDayConv='NONE'">false</xsl:when><xsl:otherwise>true</xsl:otherwise></xsl:choose></xsl:if></xsl:if></AdjustRollEnd><AdjustRollEnd_2><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:variable name="fixedCalcPeriodBusDayConv" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodDates/fpml:calculationPeriodDatesAdjustments/fpml:businessDayConvention)"/><xsl:choose><xsl:when test="$fixedCalcPeriodBusDayConv='NONE'">false</xsl:when><xsl:otherwise>true</xsl:otherwise></xsl:choose></xsl:if></AdjustRollEnd_2><AdjustFloatRollEnd><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='Single Currency Basis Swap' or $productType='Cross Currency IRS' or $productType='Cross Currency Basis Swap' or $productType='ZC Inflation Swap'"><xsl:choose><xsl:when test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodDates/fpml:calculationPeriodDatesAdjustments/fpml:businessDayConvention = 'NONE'">false</xsl:when><xsl:otherwise>true</xsl:otherwise></xsl:choose></xsl:when><xsl:when test="$productType='CapFloor'"><xsl:choose><xsl:when test="$idm140055992150384-7/fpml:calculationPeriodDatesAdjustments/fpml:businessDayConvention = 'NONE'">false</xsl:when><xsl:otherwise>true</xsl:otherwise></xsl:choose></xsl:when></xsl:choose></AdjustFloatRollEnd><AdjustFloatRollEnd_2><xsl:if test="$productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:choose><xsl:when test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodDates/fpml:calculationPeriodDatesAdjustments/fpml:businessDayConvention = 'NONE'">false</xsl:when><xsl:otherwise>true</xsl:otherwise></xsl:choose></xsl:if></AdjustFloatRollEnd_2><AdjustFixedFinalRollEnd><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='ZC Inflation Swap' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:variable name="termDateBusDayConv" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodDates/fpml:terminationDate/fpml:dateAdjustments/fpml:businessDayConvention)"/><xsl:choose><xsl:when test="$termDateBusDayConv='NONE'">false</xsl:when><xsl:otherwise>true</xsl:otherwise></xsl:choose></xsl:if></AdjustFixedFinalRollEnd><AdjustFixedFinalRollEnd_2><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:variable name="termDateBusDayConv2" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodDates/fpml:terminationDate/fpml:dateAdjustments/fpml:businessDayConvention)"/><xsl:choose><xsl:when test="$termDateBusDayConv2='NONE'">false</xsl:when><xsl:otherwise>true</xsl:otherwise></xsl:choose></xsl:if></AdjustFixedFinalRollEnd_2><AdjustFinalRollEnd><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='ZC Inflation Swap' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap'"><xsl:variable name="termDateBusDayConv" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodDates/fpml:terminationDate/fpml:dateAdjustments/fpml:businessDayConvention)"/><xsl:choose><xsl:when test="$termDateBusDayConv='NONE'">false</xsl:when><xsl:otherwise>true</xsl:otherwise></xsl:choose></xsl:when><xsl:when test="$productType='CapFloor'"><xsl:variable name="termDateBusDayConv" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:capFloor/fpml:capFloorStream/fpml:calculationPeriodDates/fpml:terminationDate/fpml:dateAdjustments/fpml:businessDayConvention)"/><xsl:choose><xsl:when test="$termDateBusDayConv='NONE'">false</xsl:when><xsl:otherwise>true</xsl:otherwise></xsl:choose></xsl:when></xsl:choose></AdjustFinalRollEnd><AdjustFinalRollEnd_2><xsl:if test="$productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:variable name="termDateBusDayConv2" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodDates/fpml:terminationDate/fpml:dateAdjustments/fpml:businessDayConvention)"/><xsl:choose><xsl:when test="$termDateBusDayConv2='NONE'">false</xsl:when><xsl:otherwise>true</xsl:otherwise></xsl:choose></xsl:if></AdjustFinalRollEnd_2><CompoundingMethod><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap'"><xsl:variable name="compoundingMethod" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:compoundingMethod)"/><xsl:choose><xsl:when test="$compoundingMethod='Flat'">F</xsl:when><xsl:when test="$compoundingMethod='Straight'">S</xsl:when><xsl:when test="$compoundingMethod='SpreadExclusive'">E</xsl:when><xsl:otherwise>N</xsl:otherwise></xsl:choose></xsl:when><xsl:when test="$productType='CapFloor'"><xsl:variable name="compoundingMethod" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:capFloor/fpml:capFloorStream/fpml:calculationPeriodAmount/fpml:calculation/fpml:compoundingMethod)"/><xsl:choose><xsl:when test="$compoundingMethod='Flat'">F</xsl:when><xsl:when test="$compoundingMethod='Straight'">S</xsl:when><xsl:when test="$compoundingMethod='SpreadExclusive'">E</xsl:when><xsl:otherwise>N</xsl:otherwise></xsl:choose></xsl:when></xsl:choose></CompoundingMethod><CompoundingMethod_2><xsl:if test="$productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:variable name="compoundingMethod2" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:compoundingMethod)"/><xsl:choose><xsl:when test="$compoundingMethod2='Flat'">F</xsl:when><xsl:when test="$compoundingMethod2='Straight'">S</xsl:when><xsl:when test="$compoundingMethod2='SpreadExclusive'">E</xsl:when><xsl:otherwise>N</xsl:otherwise></xsl:choose></xsl:if></CompoundingMethod_2><AveragingMethod><xsl:if test="$productType='Single Currency Basis Swap'"><xsl:variable name="averagingMethod" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:averagingMethod)"/><xsl:choose><xsl:when test="$averagingMethod='Unweighted'">U</xsl:when><xsl:when test="$averagingMethod='Weighted'">W</xsl:when><xsl:otherwise>N</xsl:otherwise></xsl:choose></xsl:if></AveragingMethod><AveragingMethod_2><xsl:if test="$productType='Single Currency Basis Swap'"><xsl:variable name="averagingMethod2" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:averagingMethod)"/><xsl:choose><xsl:when test="$averagingMethod2='Unweighted'">U</xsl:when><xsl:when test="$averagingMethod2='Weighted'">W</xsl:when><xsl:otherwise>N</xsl:otherwise></xsl:choose></xsl:if></AveragingMethod_2><FloatingRateMultiplier><xsl:if test="$productType='Single Currency Basis Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:floatingRateMultiplierSchedule/fpml:initialValue"/></xsl:if></FloatingRateMultiplier><FloatingRateMultiplier_2><xsl:if test="$productType='Single Currency Basis Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:floatingRateMultiplierSchedule/fpml:initialValue"/></xsl:if></FloatingRateMultiplier_2><DesignatedMaturity><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:indexTenor/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:indexTenor/fpml:period"/></xsl:if><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:fixedRateCalculation/fpml:indexTenor/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodAmount/fpml:calculation/fpml:fixedRateCalculation/fpml:indexTenor/fpml:period"/></xsl:if><xsl:if test="$productType='CapFloor'"><xsl:value-of select="$idm140055992081408-9/fpml:indexTenor/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992081408-9/fpml:indexTenor/fpml:period"/></xsl:if></DesignatedMaturity><DesignatedMaturity_2><xsl:if test="$productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:indexTenor/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:indexTenor/fpml:period"/></xsl:if><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:fixedRateCalculation/fpml:indexTenor/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:fixedRateCalculation/fpml:indexTenor/fpml:period"/></xsl:if></DesignatedMaturity_2><ResetFreq><xsl:if test="$productType='Single Currency Basis Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:resetDates/fpml:resetFrequency/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:resetDates/fpml:resetFrequency/fpml:period"/></xsl:if></ResetFreq><ResetFreq_2><xsl:if test="$productType='Single Currency Basis Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:resetDates/fpml:resetFrequency/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:resetDates/fpml:resetFrequency/fpml:period"/></xsl:if></ResetFreq_2><WeeklyRollConvention><xsl:if test="$productType='Single Currency Basis Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:resetDates/fpml:resetFrequency/fpml:weeklyRollConvention"/></xsl:if></WeeklyRollConvention><WeeklyRollConvention_2><xsl:if test="$productType='Single Currency Basis Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:resetDates/fpml:resetFrequency/fpml:weeklyRollConvention"/></xsl:if></WeeklyRollConvention_2><RateCutOffDays><xsl:if test="$productType='Single Currency Basis Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:resetDates/fpml:rateCutOffDaysOffset/fpml:periodMultiplier"/></xsl:if></RateCutOffDays><RateCutOffDays_2><xsl:if test="$productType='Single Currency Basis Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:resetDates/fpml:rateCutOffDaysOffset/fpml:periodMultiplier"/></xsl:if></RateCutOffDays_2><InitialExchange><xsl:if test="$productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS' or $productType='ZC Inflation Swap'"><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:principalExchanges/fpml:initialExchange='true'))"/></xsl:if><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg2]/fpml:principalExchanges/fpml:initialExchange='true'))"/></xsl:if></InitialExchange><FinalExchange><xsl:if test="$productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:choose><xsl:when test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:principalExchanges/fpml:finalExchange='true'">true</xsl:when><xsl:otherwise>false</xsl:otherwise></xsl:choose></xsl:if><xsl:if test="$productType='ZC Inflation Swap'"><xsl:choose><xsl:when test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:principalExchanges/fpml:finalExchange='false'">false</xsl:when><xsl:otherwise>true</xsl:otherwise></xsl:choose></xsl:if><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:choose><xsl:when test="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]/fpml:principalExchanges/fpml:finalExchange='true'">true </xsl:when><xsl:otherwise>false</xsl:otherwise></xsl:choose></xsl:if></FinalExchange><MarkToMarket><xsl:if test="$productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:fxLinkedNotionalSchedule))"/></xsl:if><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:fxLinkedNotionalSchedule))"/></xsl:if></MarkToMarket><IntermediateExchange><xsl:if test="$productType='Cross Currency IRS' or $productType='ZC Inflation Swap'"><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:principalExchanges/fpml:intermediateExchange='true'))"/></xsl:if><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg2]/fpml:principalExchanges/fpml:intermediateExchange='true'))"/></xsl:if><xsl:if test="$productType='Cross Currency Basis Swap'"><xsl:choose><xsl:when test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:principalExchanges/fpml:intermediateExchange"><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:principalExchanges/fpml:intermediateExchange='true'))"/></xsl:when><xsl:otherwise><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:fxLinkedNotionalSchedule))"/></xsl:otherwise></xsl:choose></xsl:if></IntermediateExchange><FallbackBondApplicable><xsl:if test="$productType='ZC Inflation Swap'"><xsl:value-of select="//fpml:swbInflationSwapDetails/fpml:swbfallbackBondApplicable"/></xsl:if></FallbackBondApplicable><CalculationMethod><xsl:if test="$productType='ZC Inflation Swap'"><xsl:value-of select="//fpml:swbInflationSwapDetails/fpml:swbCalculationMethod"/></xsl:if></CalculationMethod><CalculationStyle><xsl:if test="$productType='ZC Inflation Swap'"><xsl:value-of select="//fpml:swbInflationSwapDetails/fpml:swbCalculationStyle"/></xsl:if></CalculationStyle><FinalPriceExchangeCalc><xsl:if test="$productType='ZC Inflation Swap'"><xsl:value-of select="//fpml:swbInflationSwapDetails/fpml:swbFinalPrincipalExchangeCalculation/fpml:swbFloored"/></xsl:if></FinalPriceExchangeCalc><SpreadCalculationMethod><xsl:if test="$productType='ZC Inflation Swap'"><xsl:value-of select="//fpml:swbInflationSwapDetails/fpml:swbSpreadCalculationMethod"/></xsl:if></SpreadCalculationMethod><CouponRate><xsl:if test="$productType='ZC Inflation Swap'"><xsl:value-of select="$idm140055992366880-9/fpml:couponRate"/></xsl:if></CouponRate><Maturity><xsl:if test="$productType='ZC Inflation Swap'"><xsl:value-of select="$idm140055992366880-9/fpml:maturity"/></xsl:if></Maturity><RelatedBondValue><xsl:if test="$productType='ZC Inflation Swap'"><xsl:value-of select="$idm140055992366880-9/fpml:instrumentId"/></xsl:if></RelatedBondValue><RelatedBondID><xsl:if test="$productType='ZC Inflation Swap'"><xsl:value-of select="$idm140055992366880-9/fpml:instrumentId/@instrumentIdScheme"/></xsl:if></RelatedBondID><MTMRateSource><xsl:if test="$productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:fxLinkedNotionalSchedule/fpml:fxSpotRateSource/fpml:primaryRateSource/fpml:rateSource"/></xsl:if><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:fxLinkedNotionalSchedule/fpml:fxSpotRateSource/fpml:primaryRateSource/fpml:rateSource"/></xsl:if></MTMRateSource><MTMRateSourcePage><xsl:if test="$productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:fxLinkedNotionalSchedule/fpml:fxSpotRateSource/fpml:primaryRateSource/fpml:rateSourcePage"/></xsl:if><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:fxLinkedNotionalSchedule/fpml:fxSpotRateSource/fpml:primaryRateSource/fpml:rateSourcePage"/></xsl:if></MTMRateSourcePage><MTMFixingDate><xsl:if test="$productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:fxLinkedNotionalSchedule/fpml:varyingNotionalFixingDates/fpml:periodMultiplier"/></xsl:if><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:fxLinkedNotionalSchedule/fpml:varyingNotionalFixingDates/fpml:periodMultiplier"/></xsl:if></MTMFixingDate><MTMFixingHolidayCentres><xsl:if test="$productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:if test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:fxLinkedNotionalSchedule"><xsl:apply-templates select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:fxLinkedNotionalSchedule/fpml:varyingNotionalFixingDates/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:if></xsl:if><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:if test="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]//fpml:calculationPeriodAmount/fpml:calculation/fpml:fxLinkedNotionalSchedule"><xsl:apply-templates select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]//fpml:calculationPeriodAmount/fpml:calculation/fpml:fxLinkedNotionalSchedule/fpml:varyingNotionalFixingDates/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:if></xsl:if></MTMFixingHolidayCentres><MTMFixingTime><xsl:if test="$productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:if test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:fxLinkedNotionalSchedule"><xsl:call-template name="formatTime"><xsl:with-param name="time" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:fxLinkedNotionalSchedule/fpml:fxSpotRateSource/fpml:fixingTime/fpml:hourMinuteTime)"/></xsl:call-template></xsl:if></xsl:if><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:if test="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:fxLinkedNotionalSchedule"><xsl:call-template name="formatTime"><xsl:with-param name="time" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:fxLinkedNotionalSchedule/fpml:fxSpotRateSource/fpml:fixingTime/fpml:hourMinuteTime)"/></xsl:call-template></xsl:if></xsl:if></MTMFixingTime><MTMLocation><xsl:if test="$productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:fxLinkedNotionalSchedule/fpml:fxSpotRateSource/fpml:fixingTime/fpml:businessCenter"/></xsl:if><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodAmount/fpml:calculation/fpml:fxLinkedNotionalSchedule/fpml:fxSpotRateSource/fpml:fixingTime/fpml:businessCenter"/></xsl:if></MTMLocation><MTMCutoffTime><xsl:if test="$productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:if test="$idm140055992522592-3/fpml:swbFxCutoffTime"><xsl:call-template name="formatTime"><xsl:with-param name="time" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbFxCutoffTime/fpml:hourMinuteTime)"/></xsl:call-template></xsl:if></xsl:if></MTMCutoffTime><CalculationPeriodDays><xsl:choose><xsl:when test="$productType='FRA'"><xsl:value-of select="$idm140055992406288-6/fpml:calculationPeriodNumberOfDays"/></xsl:when><xsl:when test="$productType='SingleCurrencyInterestRateSwap' and $referenceCurrency='BRL'"><xsl:value-of select="$idm140055992522592-3/fpml:swbFutureValue/fpml:calculationPeriodNumberOfDays"/></xsl:when></xsl:choose></CalculationPeriodDays><FraDiscounting><xsl:if test="$productType='FRA'"><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:fra/fpml:fraDiscounting='ISDA'))"/></xsl:if></FraDiscounting><NoBreak><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='Swaption' or $productType='ZC Inflation Swap' or $productType='CapFloor' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='OIS' or $productType='Cross Currency IRS'"><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbNoEarlyTerminationProvision))"/></xsl:if></NoBreak><HasBreak><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='Swaption' or $productType='ZC Inflation Swap' or $productType='CapFloor' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='OIS' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbEarlyTerminationProvision))"/></xsl:if></HasBreak><BreakType><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='Swaption' or $productType='ZC Inflation Swap' or $productType='CapFloor' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='OIS' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:choose><xsl:when test="$idm140055991522688-4/fpml:swbOptionalEarlyTermination">OM</xsl:when><xsl:when test="$idm140055991522688-4/fpml:swbMandatoryEarlyTerminationDate">M</xsl:when><xsl:when test="$idm140055991522688-4/fpml:swbMandatoryEarlyTermination">M</xsl:when></xsl:choose></xsl:if></BreakType><BreakFirstDate><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='Swaption' or $productType='ZC Inflation Swap' or $productType='CapFloor' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='OIS' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:choose><xsl:when test="$idm140055991522688-4/fpml:swbOptionalEarlyTermination/fpml:swbOptionalEarlyTerminationDate"><xsl:value-of select="$idm140055991522688-4/fpml:swbOptionalEarlyTermination/fpml:swbOptionalEarlyTerminationDate/fpml:periodMultiplier"/><xsl:value-of select="$idm140055991522688-4/fpml:swbOptionalEarlyTermination/fpml:swbOptionalEarlyTerminationDate/fpml:period"/></xsl:when><xsl:when test="$idm140055991522688-4/fpml:swbMandatoryEarlyTermination/fpml:swbMandatoryEarlyTerminationDate"><xsl:value-of select="$idm140055991522688-4/fpml:swbMandatoryEarlyTermination/fpml:swbMandatoryEarlyTerminationDate/fpml:periodMultiplier"/><xsl:value-of select="$idm140055991522688-4/fpml:swbMandatoryEarlyTermination/fpml:swbMandatoryEarlyTerminationDate/fpml:period"/></xsl:when><xsl:otherwise><xsl:value-of select="$idm140055991522688-4/fpml:swbMandatoryEarlyTerminationDate/fpml:periodMultiplier"/><xsl:value-of select="$idm140055991522688-4/fpml:swbMandatoryEarlyTerminationDate/fpml:period"/></xsl:otherwise></xsl:choose></xsl:if></BreakFirstDate><BreakFrequency><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='Swaption' or $productType='ZC Inflation Swap' or $productType='CapFloor' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='OIS' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:value-of select="$idm140055991522688-4/fpml:swbOptionalEarlyTermination/fpml:swbOptionalEarlyTerminationFrequency/fpml:periodMultiplier"/><xsl:value-of select="$idm140055991522688-4/fpml:swbOptionalEarlyTermination/fpml:swbOptionalEarlyTerminationFrequency/fpml:period"/></xsl:if></BreakFrequency><BreakOverride><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='Swaption' or $productType='ZC Inflation Swap' or $productType='CapFloor' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='OIS' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:choose><xsl:when test="$idm140055991522688-4/fpml:swbBreakOverrideFirstDate">true</xsl:when><xsl:when test="$idm140055991522688-4/fpml:swbMandatoryEarlyTermination/fpml:swbBreakOverrideFirstDate">true</xsl:when><xsl:otherwise>false</xsl:otherwise></xsl:choose></xsl:if></BreakOverride><BreakDate><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='Swaption' or $productType='ZC Inflation Swap' or $productType='CapFloor' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='OIS' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:if test="$idm140055991522688-4/fpml:swbMandatoryEarlyTermination/fpml:swbBreakOverrideFirstDate"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbEarlyTerminationProvision/fpml:swbMandatoryEarlyTermination/fpml:swbBreakOverrideFirstDate)"/></xsl:call-template></xsl:if></xsl:if></BreakDate><BreakEarliestTime><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='Single Currency Basis Swap' or $productType='OIS' or $productType='Swaption' or $productType='CapFloor' or $productType='ZC Inflation Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:if test="$idm140055991522688-4/fpml:swbOptionalEarlyTermination/fpml:swbEarliestExerciseTime"><xsl:call-template name="formatTime"><xsl:with-param name="time" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbEarlyTerminationProvision/fpml:swbOptionalEarlyTermination/fpml:swbEarliestExerciseTime)"/></xsl:call-template></xsl:if><xsl:if test="$idm140055991522688-4/fpml:swbMandatoryEarlyTermination/fpml:swbEarliestExerciseTime"><xsl:call-template name="formatTime"><xsl:with-param name="time" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbEarlyTerminationProvision/fpml:swbMandatoryEarlyTermination/fpml:swbEarliestExerciseTime)"/></xsl:call-template></xsl:if></xsl:if></BreakEarliestTime><BreakCalcAgentA><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='Single Currency Basis Swap' or $productType='OIS' or $productType='Swaption' or $productType='CapFloor' or $productType='ZC Inflation Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:if test="$idm140055991522688-4/fpml:swbOptionalEarlyTermination/fpml:swbCalculationAgent"><xsl:choose><xsl:when test="$idm140055991522688-4/fpml:swbOptionalEarlyTermination/fpml:swbCalculationAgent/fpml:calculationAgentParty[.='AsSpecifiedInMasterAgreement']">As Specified in Master Agreement</xsl:when><xsl:when test="$idm140055991522688-4/fpml:swbOptionalEarlyTermination/fpml:swbCalculationAgent/fpml:calculationAgentParty[.='NonExercisingParty']">Non-Exercising Party</xsl:when><xsl:when test="count(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbEarlyTerminationProvision/fpml:swbOptionalEarlyTermination/fpml:swbCalculationAgent/fpml:calculationAgentPartyReference)=2">Joint</xsl:when><xsl:when test="$idm140055991522688-4/fpml:swbOptionalEarlyTermination/fpml:swbCalculationAgent/fpml:calculationAgentPartyReference[@href='partyA']">My Entity</xsl:when><xsl:when test="$idm140055991522688-4/fpml:swbOptionalEarlyTermination/fpml:swbCalculationAgent/fpml:calculationAgentPartyReference[@href='partyB']">Other Entity</xsl:when></xsl:choose></xsl:if><xsl:if test="$idm140055991522688-4/fpml:swbMandatoryEarlyTermination/fpml:swbCalculationAgent"><xsl:choose><xsl:when test="$idm140055991522688-4/fpml:swbMandatoryEarlyTermination/fpml:swbCalculationAgent/fpml:calculationAgentParty[.='AsSpecifiedInMasterAgreement']">As Specified in Master Agreement</xsl:when><xsl:when test="$idm140055991522688-4/fpml:swbMandatoryEarlyTermination/fpml:swbCalculationAgent/fpml:calculationAgentParty[.='NonExercisingParty']">Non-Exercising Party</xsl:when><xsl:when test="count(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbEarlyTerminationProvision/fpml:swbMandatoryEarlyTermination/fpml:swbCalculationAgent/fpml:calculationAgentPartyReference)=2">Joint</xsl:when><xsl:when test="$idm140055991522688-4/fpml:swbMandatoryEarlyTermination/fpml:swbCalculationAgent/fpml:calculationAgentPartyReference[@href='partyA']">My Entity</xsl:when><xsl:when test="$idm140055991522688-4/fpml:swbMandatoryEarlyTermination/fpml:swbCalculationAgent/fpml:calculationAgentPartyReference[@href='partyB']">Other Entity</xsl:when></xsl:choose></xsl:if></xsl:if></BreakCalcAgentA><BreakExpiryTime><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='Single Currency Basis Swap'or $productType='OIS' or $productType='Swaption' or $productType='CapFloor' or $productType='ZC Inflation Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:if test="$idm140055991522688-4/fpml:swbOptionalEarlyTermination/fpml:swbExpirationTime"><xsl:call-template name="formatTime"><xsl:with-param name="time" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbEarlyTerminationProvision/fpml:swbOptionalEarlyTermination/fpml:swbExpirationTime)"/></xsl:call-template></xsl:if><xsl:if test="$idm140055991522688-4/fpml:swbMandatoryEarlyTermination/fpml:swbExpirationTime"><xsl:call-template name="formatTime"><xsl:with-param name="time" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbEarlyTerminationProvision/fpml:swbMandatoryEarlyTermination/fpml:swbExpirationTime)"/></xsl:call-template></xsl:if></xsl:if></BreakExpiryTime><BreakLocation><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='Single Currency Basis Swap' or $productType='OIS' or $productType='Swaption' or $productType='CapFloor' or $productType='ZC Inflation Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:if test="$idm140055991522688-4/fpml:swbOptionalEarlyTermination/fpml:swbTimeBusinessCenter"><xsl:apply-templates select="$idm140055991522688-4/fpml:swbOptionalEarlyTermination/fpml:swbTimeBusinessCenter"/></xsl:if><xsl:if test="$idm140055991522688-4/fpml:swbMandatoryEarlyTermination/fpml:swbTimeBusinessCenter"><xsl:apply-templates select="$idm140055991522688-4/fpml:swbMandatoryEarlyTermination/fpml:swbTimeBusinessCenter"/></xsl:if></xsl:if></BreakLocation><BreakHolidayCentre><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='Single Currency Basis Swap' or $productType='OIS' or $productType='Swaption' or $productType='CapFloor' or $productType='ZC Inflation Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:if test="$idm140055991522688-4/fpml:swbOptionalEarlyTermination/fpml:swbExerciseBusinessCenters"><xsl:apply-templates select="$idm140055991522688-4/fpml:swbOptionalEarlyTermination/fpml:swbExerciseBusinessCenters"/></xsl:if><xsl:if test="$idm140055991522688-4/fpml:swbMandatoryEarlyTermination/fpml:swbValuationBusinessCenters"><xsl:apply-templates select="$idm140055991522688-4/fpml:swbMandatoryEarlyTermination/fpml:swbValuationBusinessCenters"/></xsl:if></xsl:if></BreakHolidayCentre><BreakSettlement><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='Single Currency Basis Swap' or $productType='OIS' or $productType='Swaption' or $productType='CapFloor' or $productType='ZC Inflation Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:if test="$idm140055991522688-4/fpml:swbOptionalEarlyTermination/fpml:swbCashSettlementMethod"><xsl:apply-templates select="$idm140055991522688-4/fpml:swbOptionalEarlyTermination/fpml:swbCashSettlementMethod"/></xsl:if><xsl:if test="$idm140055991522688-4/fpml:swbMandatoryEarlyTermination/fpml:swbCashSettlementMethod"><xsl:apply-templates select="$idm140055991522688-4/fpml:swbMandatoryEarlyTermination/fpml:swbCashSettlementMethod"/></xsl:if></xsl:if></BreakSettlement><BreakValuationDate><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='Single Currency Basis Swap' or $productType='OIS' or $productType='Swaption' or $productType='CapFloor' or $productType='ZC Inflation Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:value-of select="$idm140055991522688-4/fpml:swbMandatoryEarlyTermination/fpml:swbValuationDateDaysOffset"/></xsl:if></BreakValuationDate><BreakValuationTime><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='Single Currency Basis Swap'  or $productType='OIS' or $productType='Swaption' or $productType='CapFloor' or $productType='ZC Inflation Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:if test="$idm140055991522688-4/fpml:swbOptionalEarlyTermination/fpml:swbValuationTime"><xsl:call-template name="formatTime"><xsl:with-param name="time" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbEarlyTerminationProvision/fpml:swbOptionalEarlyTermination/fpml:swbValuationTime)"/></xsl:call-template></xsl:if><xsl:if test="$idm140055991522688-4/fpml:swbMandatoryEarlyTermination/fpml:swbValuationTime"><xsl:call-template name="formatTime"><xsl:with-param name="time" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbEarlyTerminationProvision/fpml:swbMandatoryEarlyTermination/fpml:swbValuationTime)"/></xsl:call-template></xsl:if></xsl:if></BreakValuationTime><BreakMMVApplicableCSA><xsl:if test="($productType='SingleCurrencyInterestRateSwap' or $productType='Single Currency Basis Swap' or $productType='OIS' or $productType='Swaption' or $productType='CapFloor' or $productType='ZC Inflation Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap') and /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbEarlyTerminationProvision//fpml:applicableCsa"><xsl:choose><xsl:when test="$idm140055991522688-4//fpml:applicableCsa[.='NoCSA']">No CSA</xsl:when><xsl:when test="$idm140055991522688-4//fpml:applicableCsa[.='ExistingCSA']">Existing CSA</xsl:when><xsl:when test="$idm140055991522688-4//fpml:applicableCsa[.='ReferenceVMCSA']">Reference VM CSA</xsl:when></xsl:choose></xsl:if></BreakMMVApplicableCSA><BreakPrescribedDocAdj><xsl:if test="($productType='SingleCurrencyInterestRateSwap' or $productType='Single Currency Basis Swap' or $productType='OIS' or $productType='Swaption' or $productType='CapFloor' or $productType='ZC Inflation Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap') and /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbEarlyTerminationProvision//fpml:prescribedDocumentationAdjustment"><xsl:choose><xsl:when test="$idm140055991522688-4//fpml:prescribedDocumentationAdjustment[.='false']">Not Applicable</xsl:when><xsl:when test="$idm140055991522688-4//fpml:prescribedDocumentationAdjustment[.='true']">Applicable</xsl:when></xsl:choose></xsl:if></BreakPrescribedDocAdj><ExchangeUnderlying><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS'"><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbAssociatedBonds))"/></xsl:if></ExchangeUnderlying><SpreadCurrency/><SwapSpread><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS'"><xsl:value-of select="$idm140055991444240-4/fpml:swbNegotiatedSpreadRate"/></xsl:if></SwapSpread><BondId1><xsl:value-of select="$idm140055991444240-4/fpml:swbBondDetails[position()=1]/fpml:swbBondId"/></BondId1><BondName1><xsl:value-of select="$idm140055991444240-4/fpml:swbBondDetails[position()=1]/fpml:swbBondName"/></BondName1><BondAmount1><xsl:value-of select="$idm140055991444240-4/fpml:swbBondDetails[position()=1]/fpml:swbBondFaceAmount"/></BondAmount1><BondPriceType1><xsl:value-of select="$idm140055991444240-4/fpml:swbBondDetails[position()=1]/fpml:swbPriceType"/></BondPriceType1><BondPrice1><xsl:value-of select="$idm140055991444240-4/fpml:swbBondDetails[position()=1]/fpml:swbBondPrice"/></BondPrice1><BondId2><xsl:value-of select="$idm140055991444240-4/fpml:swbBondDetails[position()=2]/fpml:swbBondId"/></BondId2><BondName2><xsl:value-of select="$idm140055991444240-4/fpml:swbBondDetails[position()=2]/fpml:swbBondName"/></BondName2><BondAmount2><xsl:value-of select="$idm140055991444240-4/fpml:swbBondDetails[position()=2]/fpml:swbBondFaceAmount"/></BondAmount2><BondPriceType2><xsl:value-of select="$idm140055991444240-4/fpml:swbBondDetails[position()=2]/fpml:swbPriceType"/></BondPriceType2><BondPrice2><xsl:value-of select="$idm140055991444240-4/fpml:swbBondDetails[position()=2]/fpml:swbBondPrice"/></BondPrice2><StubAt><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS' or $productType='ZC Inflation Swap'"><xsl:choose><xsl:when test="$idm140055992522592-3/fpml:swbStubPosition"><xsl:value-of select="$idm140055992522592-3/fpml:swbStubPosition"/></xsl:when><xsl:when test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount/fpml:finalStub and /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount/fpml:initialStub">Start</xsl:when><xsl:when test="$idm140055992546864-6/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount/fpml:finalStub">End</xsl:when><xsl:otherwise>Start</xsl:otherwise></xsl:choose></xsl:when><xsl:when test="$productType='Fixed Fixed Swap'"><xsl:choose><xsl:when test="$idm140055992522592-3/fpml:swbStubPosition"><xsl:value-of select="$idm140055992522592-3/fpml:swbStubPosition"/></xsl:when><xsl:when test="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:stubCalculationPeriodAmount/fpml:finalStub and /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg]/fpml:stubCalculationPeriodAmount/fpml:initialStub">Start</xsl:when><xsl:when test="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:stubCalculationPeriodAmount/fpml:finalStub">End</xsl:when><xsl:otherwise>Start</xsl:otherwise></xsl:choose></xsl:when><xsl:when test="$productType=$productType='CapFloor'"><xsl:choose><xsl:when test="$idm140055992522592-3/fpml:swbStubPosition"><xsl:value-of select="$idm140055992522592-3/fpml:swbStubPosition"/></xsl:when><xsl:when test="$idm140055992405024-6/fpml:stubCalculationPeriodAmount/fpml:finalStub">End</xsl:when><xsl:otherwise>Start</xsl:otherwise></xsl:choose></xsl:when><xsl:otherwise>Start</xsl:otherwise></xsl:choose></StubAt><FixedStub><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap' or $productType='ZC Inflation Swap'"><xsl:choose><xsl:when test="$idm140055992522592-3/fpml:swbStubLength[@href=$fixedLegId]"><xsl:value-of select="$idm140055992522592-3/fpml:swbStubLength[@href=$fixedLegId]"/></xsl:when><xsl:otherwise>Short</xsl:otherwise></xsl:choose></xsl:if></FixedStub><FixedStub_2><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:choose><xsl:when test="$idm140055992522592-3/fpml:swbStubLength[@href=$fixedLegId2]"><xsl:value-of select="$idm140055992522592-3/fpml:swbStubLength[@href=$fixedLegId2]"/></xsl:when><xsl:otherwise>Short</xsl:otherwise></xsl:choose></xsl:if></FixedStub_2><FloatStub><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='ZC Inflation Swap'"><xsl:choose><xsl:when test="$idm140055992522592-3/fpml:swbStubLength[@href=$floatingLegId]"><xsl:value-of select="$idm140055992522592-3/fpml:swbStubLength[@href=$floatingLegId]"/></xsl:when><xsl:otherwise>Short</xsl:otherwise></xsl:choose></xsl:when><xsl:when test="$productType='CapFloor'"><xsl:choose><xsl:when test="$idm140055992522592-3/fpml:swbStubLength"><xsl:value-of select="$idm140055992522592-3/fpml:swbStubLength"/></xsl:when><xsl:otherwise>Short</xsl:otherwise></xsl:choose></xsl:when></xsl:choose></FloatStub><FloatStub_2><xsl:if test="$productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS'"><xsl:choose><xsl:when test="$idm140055992522592-3/fpml:swbStubLength[@href=$floatingLegId2]"><xsl:value-of select="$idm140055992522592-3/fpml:swbStubLength[@href=$floatingLegId2]"/></xsl:when><xsl:otherwise>Short</xsl:otherwise></xsl:choose></xsl:if></FloatStub_2><FrontAndBackStubs><xsl:if test="$idm140055992522592-3/fpml:swbFrontAndBackStubs">true</xsl:if></FrontAndBackStubs><FixedBackStub><xsl:choose><xsl:when test="$idm140055992522592-3/fpml:swbFrontAndBackStubs/fpml:swbStubLength[@href=$fixedLegId]"><xsl:value-of select="$idm140055992522592-3/fpml:swbFrontAndBackStubs/fpml:swbStubLength[@href=$fixedLegId]"/></xsl:when><xsl:otherwise>Short</xsl:otherwise></xsl:choose></FixedBackStub><FloatBackStub><xsl:choose><xsl:when test="$idm140055992522592-3/fpml:swbFrontAndBackStubs/fpml:swbStubLength[@href=$floatingLegId]"><xsl:value-of select="$idm140055992522592-3/fpml:swbFrontAndBackStubs/fpml:swbStubLength[@href=$floatingLegId]"/></xsl:when><xsl:otherwise>Short</xsl:otherwise></xsl:choose></FloatBackStub><BackStubIndexTenor1><xsl:if test="$idm140055992522592-3/fpml:swbFrontAndBackStubs"><xsl:value-of select="$idm140055992538800-5/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount/fpml:finalStub/fpml:floatingRate[1]/fpml:indexTenor/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992538800-5/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount/fpml:finalStub/fpml:floatingRate[1]/fpml:indexTenor/fpml:period"/></xsl:if></BackStubIndexTenor1><BackStubIndexTenor2><xsl:if test="$idm140055992522592-3/fpml:swbFrontAndBackStubs"><xsl:value-of select="$idm140055992538800-5/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount/fpml:finalStub/fpml:floatingRate[2]/fpml:indexTenor/fpml:periodMultiplier"/><xsl:value-of select="$idm140055992538800-5/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount/fpml:finalStub/fpml:floatingRate[2]/fpml:indexTenor/fpml:period"/></xsl:if></BackStubIndexTenor2><BackStubLinearInterpolation><xsl:if test="$idm140055992522592-3/fpml:swbFrontAndBackStubs and /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount/fpml:finalStub/fpml:floatingRate[1]"><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount/fpml:finalStub/fpml:floatingRate[2]))"/></xsl:if></BackStubLinearInterpolation><BackStubInitialInterpIndex><xsl:if test="$idm140055992522592-3/fpml:swbFrontAndBackStubs and count(/fpml:SWBML//fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount/fpml:finalStub/fpml:floatingRate)=2 and /fpml:SWBML//fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount/fpml:finalStub/fpml:floatingRate[1]/fpml:floatingRateIndex != /fpml:SWBML//fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount/fpml:finalStub/fpml:floatingRate[2]/fpml:floatingRateIndex"><xsl:value-of select="$idm140055991938160-5//fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:stubCalculationPeriodAmount/fpml:finalStub/fpml:floatingRate[1]/fpml:floatingRateIndex"/></xsl:if></BackStubInitialInterpIndex><NoBackStubLinearInterpolation><xsl:if test="$idm140055992522592-3/fpml:swbFrontAndBackStubs/fpml:swbNoStubLinearInterpolation">true</xsl:if></NoBackStubLinearInterpolation><FirstFixedRegPdStartDate><xsl:if test="$idm140055992538800-5/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodDates/fpml:firstRegularPeriodStartDate"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swap/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodDates/fpml:firstRegularPeriodStartDate)"/></xsl:call-template></xsl:if></FirstFixedRegPdStartDate><FirstFixedRegPdStartDate_2><xsl:if test="$idm140055992538800-5/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodDates/fpml:firstRegularPeriodStartDate"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swap/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodDates/fpml:firstRegularPeriodStartDate)"/></xsl:call-template></xsl:if></FirstFixedRegPdStartDate_2><FirstFloatRegPdStartDate><xsl:if test="$idm140055992538800-5/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodDates/fpml:firstRegularPeriodStartDate"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodDates/fpml:firstRegularPeriodStartDate)"/></xsl:call-template></xsl:if></FirstFloatRegPdStartDate><LastFixedRegPdEndDate><xsl:if test="$idm140055992538800-5/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodDates/fpml:lastRegularPeriodEndDate"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swap/fpml:swapStream[position()=$fixedLeg]/fpml:calculationPeriodDates/fpml:lastRegularPeriodEndDate)"/></xsl:call-template></xsl:if></LastFixedRegPdEndDate><LastFixedRegPdEndDate_2><xsl:if test="$idm140055992538800-5/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodDates/fpml:lastRegularPeriodEndDate"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swap/fpml:swapStream[position()=$fixedLeg2]/fpml:calculationPeriodDates/fpml:lastRegularPeriodEndDate)"/></xsl:call-template></xsl:if></LastFixedRegPdEndDate_2><LastFloatRegPdEndDate><xsl:if test="$idm140055992538800-5/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodDates/fpml:lastRegularPeriodEndDate"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:calculationPeriodDates/fpml:lastRegularPeriodEndDate)"/></xsl:call-template></xsl:if></LastFloatRegPdEndDate><MasterAgreement><xsl:value-of select="$idm140055992546864-4/fpml:documentation/fpml:masterAgreement/fpml:masterAgreementType"/></MasterAgreement><ProductType><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap'">Single Currency Interest Rate Swap</xsl:when><xsl:otherwise><xsl:value-of select="$productType"/></xsl:otherwise></xsl:choose></ProductType><OptionType><xsl:choose><xsl:when test="$productType='CapFloor'"><xsl:choose><xsl:when test="$idm140055992081408-9/fpml:capRateSchedule  and /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:capFloor/fpml:capFloorStream/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:floorRateSchedule">Cap Floor Straddle</xsl:when><xsl:when test="$idm140055992081408-9/fpml:capRateSchedule">Cap</xsl:when><xsl:when test="$idm140055992081408-9/fpml:floorRateSchedule">Floor</xsl:when></xsl:choose></xsl:when><xsl:when test="$productType='Swaption'"><xsl:variable name="straddle" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swaption/fpml:swaptionStraddle)"/><xsl:variable name="swaptionBuyer" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swaption/fpml:buyerPartyReference/@href)"/><xsl:variable name="swapFixedPayer" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg]/fpml:payerPartyReference/@href)"/><xsl:choose><xsl:when test="$straddle='true'">Straddle</xsl:when><xsl:when test="$swaptionBuyer=$swapFixedPayer">Payers</xsl:when><xsl:otherwise>Receivers</xsl:otherwise></xsl:choose></xsl:when></xsl:choose></OptionType><OptionExpirationDate><xsl:if test="$productType='Swaption'"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swaption/fpml:europeanExercise/fpml:expirationDate/fpml:adjustableDate/fpml:unadjustedDate)"/></xsl:call-template></xsl:if></OptionExpirationDate><OptionHolidayCentres><xsl:if test="$productType='Swaption'"><xsl:apply-templates select="$idm140055992284944-5/fpml:europeanExercise/fpml:expirationDate/fpml:adjustableDate/fpml:dateAdjustments/fpml:businessCenters"/></xsl:if></OptionHolidayCentres><OptionEarliestTime><xsl:if test="$productType='Swaption'"><xsl:call-template name="formatTime"><xsl:with-param name="time" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swaption/fpml:europeanExercise/fpml:earliestExerciseTime/fpml:hourMinuteTime)"/></xsl:call-template></xsl:if></OptionEarliestTime><OptionExpiryTime><xsl:if test="$productType='Swaption'"><xsl:call-template name="formatTime"><xsl:with-param name="time" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swaption/fpml:europeanExercise/fpml:expirationTime/fpml:hourMinuteTime)"/></xsl:call-template></xsl:if></OptionExpiryTime><OptionSpecificExpiryTime/><OptionLocation><xsl:if test="$productType='Swaption'"><xsl:value-of select="$idm140055992284944-5/fpml:europeanExercise/fpml:expirationTime/fpml:businessCenter"/></xsl:if></OptionLocation><OptionCalcAgent><xsl:if test="$productType='Swaption' and /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swaption/fpml:calculationAgent"><xsl:choose><xsl:when test="count(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swaption/fpml:calculationAgent/fpml:calculationAgentPartyReference) = 2">Joint</xsl:when><xsl:when test="$idm140055992284944-5/fpml:calculationAgent/fpml:calculationAgentPartyReference/@href = /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swaption/fpml:buyerPartyReference/@href">Buyer</xsl:when><xsl:when test="$idm140055992284944-5/fpml:calculationAgent/fpml:calculationAgentPartyReference/@href = /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swaption/fpml:sellerPartyReference/@href">Seller</xsl:when><xsl:when test="$idm140055992284944-5/fpml:calculationAgent/fpml:calculationAgentParty[.='AsSpecifiedInMasterAgreement']">As Specified in Master Agreement</xsl:when><xsl:otherwise>???</xsl:otherwise></xsl:choose></xsl:if></OptionCalcAgent><OptionAutomaticExercise><xsl:if test="$productType='Swaption'"><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swaption/fpml:exerciseProcedure/fpml:automaticExercise))"/></xsl:if></OptionAutomaticExercise><OptionThreshold><xsl:if test="$productType='Swaption'"><xsl:value-of select="$idm140055992284944-5/fpml:exerciseProcedure/fpml:automaticExercise/fpml:thresholdRate"/></xsl:if></OptionThreshold><ManualExercise><xsl:if test="$productType='Swaption'"><xsl:value-of select="$idm140055992284944-5/fpml:exerciseProcedure/fpml:manualExercise/fpml:fallbackExercise"/></xsl:if></ManualExercise><OptionWrittenExerciseConf><xsl:if test="$productType='Swaption'"><xsl:value-of select="$idm140055992284944-5/fpml:exerciseProcedure/fpml:followUpConfirmation"/></xsl:if></OptionWrittenExerciseConf><OptionSettlement><xsl:if test="$productType='Swaption'"><xsl:choose><xsl:when test="$idm140055992284944-5/fpml:cashSettlement">Cash</xsl:when><xsl:when test="$idm140055992522592-3/fpml:swbCollateralizedCashPrice">Cash</xsl:when><xsl:otherwise>Physical</xsl:otherwise></xsl:choose></xsl:if></OptionSettlement><OptionCashSettlementMethod><xsl:if test="$productType='Swaption'"><xsl:choose><xsl:when test="$swaption/fpml:cashSettlement/fpml:cashPriceMethod">Cash Price</xsl:when><xsl:when test="$swaption/fpml:cashSettlement/fpml:cashPriceAlternateMethod">Cash Price - Alternate Method</xsl:when><xsl:when test="$swaption/fpml:cashSettlement/fpml:parYieldCurveAdjustedMethod ">Par Yield Curve - Adjusted</xsl:when><xsl:when test="$swaption/fpml:cashSettlement/fpml:zeroCouponYieldAdjustedMethod ">Zero Coupon Yield - Adjusted</xsl:when><xsl:when test="$swaption/fpml:cashSettlement/fpml:parYieldCurveUnadjustedMethod ">Par Yield Curve - Unadjusted</xsl:when><xsl:when test="$idm140055992522592-3/fpml:swbCollateralizedCashPrice">Collateralized Cash Price</xsl:when></xsl:choose></xsl:if></OptionCashSettlementMethod><OptionCashSettlementQuotationRate><xsl:if test="$productType='Swaption'"><xsl:choose><xsl:when test="$idm140055992522592-3/fpml:swbCollateralizedCashPrice"><xsl:value-of select="$idm140055992522592-3/fpml:swbCollateralizedCashPrice/fpml:quotationRateType"/></xsl:when><xsl:otherwise><xsl:value-of select="$swaption/fpml:cashSettlement//fpml:quotationRateType"/></xsl:otherwise></xsl:choose></xsl:if></OptionCashSettlementQuotationRate><OptionCashSettlementRateSource><xsl:if test="$productType='Swaption'"><xsl:choose><xsl:when test="$idm140055991314592-6/fpml:rateSourcePage"><xsl:variable name="pageString" select="' Page '"/><xsl:value-of select="$idm140055991314592-6/fpml:rateSource"/><xsl:value-of select="$pageString"/><xsl:value-of select="$idm140055991314592-6/fpml:rateSourcePage"/></xsl:when><xsl:when test="$idm140055991314592-6/fpml:rateSource[.='ISDA']">ISDA Source</xsl:when><xsl:when test="$idm140055991314592-6/fpml:rateSource[.='ICESWAP']">ICESWAP Rate</xsl:when><xsl:when test="$idm140055991314592-6/fpml:rateSource[.='TOKYOSWAP']">Tokyo Swap Rate</xsl:when><xsl:when test="$idm140055991314592-6/fpml:rateSource[.='Reference Banks']">Reference Banks</xsl:when><xsl:when test="$swaption/fpml:physicalSettlement//fpml:settlementRateSource/fpml:informationSource/fpml:rateSourcePage"><xsl:variable name="pageString" select="' Page '"/><xsl:value-of select="$swaption/fpml:physicalSettlement//fpml:settlementRateSource/fpml:informationSource/fpml:rateSource"/><xsl:value-of select="$pageString"/><xsl:value-of select="$swaption/fpml:physicalSettlement//fpml:settlementRateSource/fpml:informationSource/fpml:rateSourcePage"/></xsl:when><xsl:when test="$swaption/fpml:physicalSettlement//fpml:settlementRateSource/fpml:informationSource/fpml:rateSource[.='ISDA']">ISDA Source</xsl:when><xsl:when test="$swaption/fpml:physicalSettlement//fpml:settlementRateSource/fpml:informationSource/fpml:rateSource[.='ICESWAP']">ICESWAP Rate</xsl:when><xsl:when test="$swaption/fpml:physicalSettlement//fpml:settlementRateSource/fpml:informationSource/fpml:rateSource[.='TOKYOSWAP']">Tokyo Swap Rate</xsl:when><xsl:when test="$swaption/fpml:physicalSettlement//fpml:settlementRateSource/fpml:informationSource/fpml:rateSource[.='ReferenceBanks'] or $swaption/fpml:physicalSettlement//fpml:settlementRateSource/fpml:informationSource/fpml:rateSource[.='Reference Banks']">Reference Banks</xsl:when><xsl:when test="$swaption/fpml:cashSettlement//fpml:settlementRateSource/fpml:informationSource/fpml:rateSourcePage"><xsl:variable name="pageString" select="' Page '"/><xsl:value-of select="$swaption/fpml:cashSettlement//fpml:settlementRateSource/fpml:informationSource/fpml:rateSource"/><xsl:value-of select="$pageString"/><xsl:value-of select="$swaption/fpml:cashSettlement//fpml:settlementRateSource/fpml:informationSource/fpml:rateSourcePage"/></xsl:when><xsl:when test="$swaption/fpml:cashSettlement//fpml:settlementRateSource/fpml:informationSource/fpml:rateSource[.='ISDA']">ISDA Source</xsl:when><xsl:when test="$swaption/fpml:cashSettlement//fpml:settlementRateSource/fpml:informationSource/fpml:rateSource[.='ICESWAP']">ICESWAP Rate</xsl:when><xsl:when test="$swaption/fpml:cashSettlement//fpml:settlementRateSource/fpml:informationSource/fpml:rateSource[.='TOKYOSWAP']">Tokyo Swap Rate</xsl:when><xsl:when test="$swaption/fpml:cashSettlement//fpml:settlementRateSource/fpml:informationSource/fpml:rateSource[.='ReferenceBanks'] or $swaption/fpml:cashSettlement//fpml:settlementRateSource/fpml:informationSource/fpml:rateSource[.='Reference Banks']">Reference Banks</xsl:when><xsl:when test="$swaption/fpml:cashSettlement/fpml:cashPriceMethod or $swaption/fpml:cashSettlement/fpml:cashPriceAlternateMethod or $swaption/fpml:cashSettlement//fpml:cashSettlementReferenceBanks">Reference Banks</xsl:when></xsl:choose></xsl:if></OptionCashSettlementRateSource><OptionCashSettlementReferenceBanks><xsl:if test="$productType='Swaption'"><xsl:choose><xsl:when test="$idm140055991314592-5/fpml:cashSettlementReferenceBanks"><xsl:apply-templates select="$idm140055991314592-5/fpml:cashSettlementReferenceBanks"/></xsl:when><xsl:when test="$swaption/fpml:cashSettlement//fpml:cashSettlementReferenceBanks"><xsl:apply-templates select="$swaption/fpml:cashSettlement//fpml:cashSettlementReferenceBanks"/></xsl:when><xsl:when test="$swaption/fpml:cashSettlement">Agreed on exercise</xsl:when><xsl:otherwise/></xsl:choose></xsl:if></OptionCashSettlementReferenceBanks><ClearedPhysicalSettlement><xsl:if test="$productType='Swaption'"><xsl:value-of select="string(boolean(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbClearedPhysicalSettlement = 'true'))"/></xsl:if></ClearedPhysicalSettlement><UnderlyingSwapClearingHouse><xsl:value-of select="$idm140055992522592-4/fpml:swbPredeterminedClearerForUnderlyingSwap"/></UnderlyingSwapClearingHouse><PricedToClearCCP><xsl:if test="$productType='Swaption' or $productType='OIS' or $productType='FRA' or $productType='ZC Inflation Swap' or $productType='Fixed Fixed Swap' or $productType='SingleCurrencyInterestRateSwap' or $productType='Single Currency Basis Swap' or $productType='Cross Currency IRS' or $productType='Cross Currency Basis Swap'"><xsl:value-of select="$idm140055992522592-4/fpml:swbPricedToClearCCP/fpml:partyId"/></xsl:if></PricedToClearCCP><AgreedDiscountRate><xsl:if test="$productType='Swaption'"><xsl:value-of select="$idm140055992522592-3/fpml:swbAgreedDiscountRate"/></xsl:if></AgreedDiscountRate><Premium><Currency/><Amount><xsl:choose><xsl:when test="$productType='CapFloor'"><xsl:choose><xsl:when test="$idm140055992405024-5/fpml:premium"><xsl:value-of select="$idm140055992405024-5/fpml:premium/fpml:paymentAmount/fpml:amount"/></xsl:when><xsl:otherwise>0</xsl:otherwise></xsl:choose></xsl:when><xsl:when test="$productType='Swaption'"><xsl:choose><xsl:when test="$idm140055992284944-5/fpml:premium"><xsl:value-of select="$idm140055992284944-5/fpml:premium/fpml:paymentAmount/fpml:amount"/></xsl:when><xsl:otherwise>0</xsl:otherwise></xsl:choose></xsl:when></xsl:choose></Amount><Date><xsl:choose><xsl:when test="$productType='CapFloor'"><xsl:if test="$idm140055992405024-5/fpml:premium/fpml:paymentDate/fpml:unadjustedDate"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:capFloor/fpml:premium/fpml:paymentDate/fpml:unadjustedDate)"/></xsl:call-template></xsl:if></xsl:when><xsl:when test="$productType='Swaption'"><xsl:if test="$idm140055992284944-5/fpml:premium"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swaption/fpml:premium/fpml:paymentDate/fpml:unadjustedDate)"/></xsl:call-template></xsl:if></xsl:when></xsl:choose></Date></Premium><PremiumHolidayCentres><xsl:if test="$productType='Swaption'"><xsl:apply-templates select="$idm140055992284944-5/fpml:premium/fpml:paymentDate/fpml:dateAdjustments/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:if></PremiumHolidayCentres><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS'"><xsl:apply-templates select="$idm140055992522592-3/fpml:swbAssociatedFuture"/></xsl:if><DocsType/><DocsSubType/><OptionsComponentSecurityIndexAnnex/><OptionHedgingDisruption/><OptionLossOfStockBorrow/><OptionMaximumStockLoanRate/><OptionIncreasedCostOfStockBorrow/><OptionInitialStockLoanRate/><OptionIncreasedCostOfHedging/><OptionForeignOwnershipEvent/><OptionEntitlement/><ContractualDefinitions><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='CapFloor' or $productType='Swaption' or $productType='ZC Inflation Swap' or $productType='FRA' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:apply-templates select="$idm140055992546864-4/fpml:documentation"/></xsl:if></ContractualDefinitions><RestructuringCreditEvent/><CalculationAgentCity/><RefEntName/><RefEntStdId/><REROPairStdId/><RefOblRERole/><RefOblSecurityIdType/><RefOblSecurityId/><BloombergID/><RefOblMaturity/><RefOblCoupon/><RefOblPrimaryObligor/><BorrowerNames/><FacilityType/><CreditAgreementDate/><IsSecuredList/><DesignatedPriority/><OptionalEarlyTermination/><ReferencePrice/><ReferencePolicy/><PaymentDelay/><StepUpProvision/><WACCapInterestProvision/><InterestShortfallCapIndicator/><InterestShortfallCompounding/><InterestShortfallCapBasis/><InterestShortfallRateSource/><MortgagePaymentFrequency/><MortgageFinalMaturity/><MortgageOriginalAmount/><MortgageInitialFactor/><MortgageSector/><IndexName/><IndexId/><IndexSeries/><IndexVersion/><IndexAnnexDate/><IndexTradedRate/><UpfrontFee/><UpfrontFeeAmount/><UpfrontFeeDate/><UpfrontFeePayer/><AttachmentPoint/><ExhaustionPoint/><Cancelable><xsl:choose><xsl:when test="$idm140055992538800-5/fpml:cancelableProvision">true</xsl:when><xsl:otherwise>false</xsl:otherwise></xsl:choose></Cancelable><CancelableDirectionA><xsl:variable name="cancelableBuyer"><xsl:value-of select="$idm140055992538800-5/fpml:cancelableProvision/fpml:buyerPartyReference/@href"/></xsl:variable><xsl:choose><xsl:when test="string($cancelableBuyer)=string($partyA)">Buy</xsl:when><xsl:otherwise>Sell</xsl:otherwise></xsl:choose></CancelableDirectionA><CancelableOptionStyle><xsl:choose><xsl:when test="$idm140055992538800-5/fpml:cancelableProvision/fpml:bermudaExercise">Bermudan</xsl:when><xsl:when test="$idm140055992538800-5/fpml:cancelableProvision/fpml:americanExercise">American</xsl:when><xsl:when test="$idm140055992538800-5/fpml:cancelableProvision/fpml:europeanExercise">European</xsl:when><xsl:otherwise>???</xsl:otherwise></xsl:choose></CancelableOptionStyle><CancelableFirstExerciseDate><xsl:value-of select="$idm140055991236064-8//fpml:scheduleBounds/fpml:unadjustedFirstDate"/><xsl:value-of select="$idm140055991236064-8/fpml:adjustableDates/fpml:unadjustedDate"/></CancelableFirstExerciseDate><CancelableExerciseFrequency><xsl:value-of select="$idm140055991236064-8/fpml:relativeDates/fpml:periodMultiplier"/><xsl:value-of select="$idm140055991236064-8/fpml:relativeDates/fpml:period"/></CancelableExerciseFrequency><CancelableEarliestTime><xsl:call-template name="formatTime"><xsl:with-param name="time" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swap/fpml:cancelableProvision//fpml:earliestExerciseTime/fpml:hourMinuteTime)"/></xsl:call-template></CancelableEarliestTime><CancelableExpiryTime><xsl:call-template name="formatTime"><xsl:with-param name="time" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swap/fpml:cancelableProvision//fpml:expirationTime/fpml:hourMinuteTime)"/></xsl:call-template></CancelableExpiryTime><CancelableExerciseLag><xsl:value-of select="$idm140055992538800-5/fpml:cancelableProvision//fpml:bermudaExerciseDates/fpml:relativeDates/fpml:periodMultiplier"/><xsl:value-of select="$idm140055991227792-8/fpml:commencementDate/fpml:relativeDate/fpml:periodMultiplier"/><xsl:value-of select="$idm140055991227104-8/fpml:expirationDate/fpml:relativeDate/fpml:periodMultiplier"/></CancelableExerciseLag><CancelableHolidayCentre><xsl:apply-templates select="$idm140055992538800-5/fpml:cancelableProvision//fpml:bermudaExerciseDates/fpml:relativeDates/fpml:businessCenters"/><xsl:apply-templates select="$idm140055991227792-8/fpml:commencementDate/fpml:relativeDate/fpml:businessCenters"/><xsl:apply-templates select="$idm140055991227104-8/fpml:expirationDate/fpml:relativeDate/fpml:businessCenters"/></CancelableHolidayCentre><CancelableLocation><xsl:apply-templates select="$idm140055992538800-5/fpml:cancelableProvision//fpml:expirationTime/fpml:businessCenter"/></CancelableLocation><CancelableConvention><xsl:variable name="cancelableConvention" select="substring(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swap/fpml:cancelableProvision//fpml:relevantUnderlyingDate//fpml:businessDayConvention,1,4)"/><xsl:choose><xsl:when test="$cancelableConvention='NotA'">NA</xsl:when><xsl:otherwise><xsl:value-of select="$cancelableConvention"/></xsl:otherwise></xsl:choose></CancelableConvention><CancelableFUC><xsl:value-of select="$idm140055992538800-5/fpml:cancelableProvision/fpml:followUpConfirmation"/></CancelableFUC><CancelableDayType><xsl:value-of select="$idm140055992538800-5/fpml:cancelableProvision//fpml:bermudaExerciseDates/fpml:relativeDates/fpml:dayType"/><xsl:value-of select="$idm140055991227792-8/fpml:commencementDate/fpml:relativeDate/fpml:dayType"/><xsl:value-of select="$idm140055991227104-8/fpml:expirationDate/fpml:relativeDate/fpml:dayType"/></CancelableDayType><CancelableLagConvention><xsl:value-of select="substring(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swap/fpml:cancelableProvision//fpml:bermudaExerciseDates/fpml:relativeDates/fpml:businessDayConvention,1,4)"/><xsl:value-of select="substring(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swap/fpml:cancelableProvision//fpml:americanExercise/fpml:commencementDate/fpml:relativeDate/fpml:businessDayConvention,1,4)"/><xsl:value-of select="substring(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swap/fpml:cancelableProvision//fpml:europeanExercise/fpml:expirationDate/fpml:relativeDate/fpml:businessDayConvention,1,4)"/></CancelableLagConvention><CancelableRollCentres><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS'"><xsl:apply-templates select="$idm140055992538800-5/fpml:cancelableProvision//fpml:bermudaExercise/fpml:relevantUnderlyingDate/fpml:relativeDates/fpml:businessCenters"/><xsl:apply-templates select="$idm140055991227792-8/fpml:relevantUnderlyingDate/fpml:relativeDates/fpml:businessCenters"/><xsl:apply-templates select="$idm140055991227104-8/fpml:relevantUnderlyingDate/fpml:adjustableDates/fpml:dateAdjustments/fpml:businessCenters"/></xsl:if></CancelableRollCentres><xsl:if test="$idm140055992546864-4//fpml:additionalPayment[fpml:paymentType='CancellablePremium']"><CancelablePremium><PaymentDirectionA><xsl:variable name="payer" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:additionalPayment[fpml:paymentType='CancellablePremium']/fpml:payerPartyReference/@href)"/><xsl:choose><xsl:when test="string($payer)=string($partyA)">Pay</xsl:when><xsl:otherwise>Rec</xsl:otherwise></xsl:choose></PaymentDirectionA><Currency><xsl:value-of select="$idm140055992546864-4//fpml:additionalPayment[fpml:paymentType='CancellablePremium']/fpml:paymentAmount/fpml:currency"/></Currency><Amount><xsl:value-of select="$idm140055992546864-4//fpml:additionalPayment[fpml:paymentType='CancellablePremium']/fpml:paymentAmount/fpml:amount"/></Amount><Date><xsl:if test="$idm140055992546864-4//fpml:additionalPayment[fpml:paymentType='CancellablePremium']/fpml:paymentDate"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:additionalPayment[fpml:paymentType='CancellablePremium']/fpml:paymentDate/fpml:unadjustedDate)"/></xsl:call-template></xsl:if></Date><Convention><xsl:value-of select="substring(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:additionalPayment[fpml:paymentType='CancellablePremium']/fpml:paymentDate/fpml:dateAdjustments/fpml:businessDayConvention,1,4)"/></Convention><Holidays><xsl:apply-templates select="$idm140055992546864-4//fpml:additionalPayment[fpml:paymentType='CancellablePremium']/fpml:paymentDate/fpml:dateAdjustments/fpml:businessCenters"/></Holidays></CancelablePremium></xsl:if><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Single Currency Basis Swap' or $productType='Cross Currency Basis Swap' or $productType='ZC Inflation Swap' or $productType='Cross Currency IRS' or $productType='Swaption' or $productType='CapFloor' or $productType='Fixed Fixed Swap'"><xsl:apply-templates select="$idm140055992546864-4//fpml:additionalPayment"/></xsl:if><xsl:if test="$productType='FRA'"><xsl:apply-templates select="$idm140055992522592-3/fpml:additionalPayment"/></xsl:if><EquityRic/><OptionQuantity/><OptionExpiryMonth/><OptionExpiryYear/><Price/><OptionStyle/><ExchangeLookAlike/><AdjustmentMethod/><RelatedExchange/><MasterConfirmationDate/><Multiplier/><SettlementCurrency><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:settlementProvision/fpml:settlementCurrency"/><xsl:if test="$idm140055992394416-4/fpml:swbSettlementCurrency and $referenceCurrency='BRL'"><xsl:value-of select="$idm140055992394416-4/fpml:swbSettlementCurrency"/></xsl:if></xsl:when><xsl:when test="$productType='Cross Currency Basis Swap'"><xsl:value-of select="$idm140055992538800-5/fpml:swapStream[position()=$floatingLeg]/fpml:settlementProvision/fpml:settlementCurrency"/></xsl:when></xsl:choose></SettlementCurrency><SettlementCurrency_2><xsl:choose><xsl:when test="$productType='Cross Currency IRS'"><xsl:value-of select="$idm140055992538800-5/fpml:swapStream[position()=$floatingLeg]/fpml:settlementProvision/fpml:settlementCurrency"/></xsl:when><xsl:when test="$productType='Cross Currency Basis Swap'"><xsl:value-of select="$idm140055992538800-5/fpml:swapStream[position()=$floatingLeg2]/fpml:settlementProvision/fpml:settlementCurrency"/></xsl:when><xsl:when test="$productType='Fixed Fixed Swap'"><xsl:value-of select="$idm140055992538800-5/fpml:swapStream[position()=$fixedLeg2]/fpml:settlementProvision/fpml:settlementCurrency"/></xsl:when></xsl:choose></SettlementCurrency_2><SettlementDateOffset/><SettlementType/><FxDeterminationMethod/><ReferencePriceSource/><ReferencePricePage/><ReferencePriceTime/><ReferencePriceCity/><ReferenceCurrency><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Cross Currency Basis Swap' or $productType='Swaption' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:value-of select="$referenceCurrency"/></xsl:if></ReferenceCurrency><ReferenceCurrency_2><xsl:choose><xsl:when test="$productType='Cross Currency Basis Swap'"><xsl:value-of select="$idm140055992538800-5/fpml:swapStream[position()=$floatingLeg2]/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:referenceCurrency"/></xsl:when><xsl:when test="$productType='Cross Currency IRS'"><xsl:value-of select="$idm140055992538800-5/fpml:swapStream[position()=$floatingLeg]/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:referenceCurrency"/></xsl:when><xsl:when test="$productType='Fixed Fixed Swap'"><xsl:value-of select="$idm140055992538800-5/fpml:swapStream[position()=$fixedLeg2]/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:referenceCurrency"/></xsl:when></xsl:choose></ReferenceCurrency_2><DcRequired/><DcEventTypeA/><DcRic/><DcDescription/><DcExpiryMonth/><DcExpiryYear/><DcQuantity/><DcPrice/><DcCurrency/><DcDelta/><DcExpiryDate/><DcFuturesCode/><DcOffshoreCross/><DcOffshoreCrossLocation/><DcExchangeID/><DcDeltaOptionQuantity/><AveragingInOut/><AveragingDateTimes><AveragingDate/></AveragingDateTimes><MarketDisruption/><AveragingFrequency/><AveragingStartDate/><AveragingEndDate/><ReferenceFXRate/><HedgeLevel/><Basis/><ImpliedLevel/><PremiumPercent/><StrikePercent/><BaseNotional/><BreakOutTrade/><SplitCollateral/><OpenUnits/><DeclaredCashDividendPercentage/><DeclaredCashEquivalentDividendPercentage/><DividendPayer/><DividendReceiver/><DividendPeriods><DividendPeriod><DividendPeriodId/><UnadjustedStartDate/><UnadjustedEndDate/><PaymentDateReference/><FixedStrike/><DividendValuationDateReference/><DividendValuationDate/></DividendPeriod></DividendPeriods><SpecialDividends/><MaterialDividend/><FixedPayer/><FixedReceiver/><FixedPeriods><FixedPayment><DivSwapFixedAmount/><DivSwapFixedDateOffset/><DivSwapFixedDateRelativeTo/></FixedPayment></FixedPeriods><VegaNotional/><ExpectedN/><ExpectedNOverride/><VarianceAmount/><VarianceStrikePrice/><VolatilityStrikePrice/><VarianceCapIndicator/><VarianceCapFactor/><ObservationStartDate/><ValuationDate/><InitialSharePriceOrIndexLevel/><ClosingSharePriceOrClosingIndexLevelIndicator/><FuturesPriceValuation/><AllDividends/><SettlementCurrencyVegaNotional/><VegaFxRate/><IndependentAmount><Payer><xsl:if test="$idm140055992546864-4/fpml:collateral/fpml:independentAmount/fpml:payerPartyReference/@href"><xsl:variable name="payer" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:collateral/fpml:independentAmount/fpml:payerPartyReference/@href)"/><xsl:choose><xsl:when test="$payer='partyA'">A</xsl:when><xsl:when test="$payer='partyB'">B</xsl:when><xsl:otherwise/></xsl:choose></xsl:if></Payer><Currency><xsl:value-of select="$idm140055992546864-4/fpml:collateral/fpml:independentAmount/fpml:paymentDetail/fpml:paymentAmount/fpml:currency"/></Currency><Amount><xsl:value-of select="$idm140055992546864-4/fpml:collateral/fpml:independentAmount/fpml:paymentDetail/fpml:paymentAmount/fpml:amount"/></Amount></IndependentAmount><xsl:apply-templates select="$idm140055992546864-4/fpml:otherPartyPayment"/><SettlementRateOption><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:settlementRateOption"/><xsl:if test=" $referenceCurrency='BRL'"><xsl:value-of select="$idm140055992394416-4/fpml:swbNonDeliverableSettlement/fpml:swbSettlementRateOption"/></xsl:if></xsl:when><xsl:when test="$productType='Cross Currency Basis Swap'"><xsl:value-of select="$idm140055992538800-5/fpml:swapStream[position()=$floatingLeg]/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:settlementRateOption"/></xsl:when></xsl:choose></SettlementRateOption><SettlementRateOption_2><xsl:choose><xsl:when test="$productType='Cross Currency IRS'"><xsl:value-of select="$idm140055992538800-5/fpml:swapStream[position()=$floatingLeg]/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:settlementRateOption"/></xsl:when><xsl:when test="$productType='Cross Currency Basis Swap'"><xsl:value-of select="$idm140055992538800-5/fpml:swapStream[position()=$floatingLeg2]/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:settlementRateOption"/></xsl:when><xsl:when test="$productType='Fixed Fixed Swap'"><xsl:value-of select="$idm140055992538800-5/fpml:swapStream[position()=$fixedLeg2]/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:settlementRateOption"/></xsl:when></xsl:choose></SettlementRateOption_2><FxFixingAdjustableDate><xsl:value-of select="$idm140055992394416-4/fpml:swbNonDeliverableSettlement/fpml:swbFxFixingSchedule/fpml:unadjustedDate"/></FxFixingAdjustableDate><FxFixingPeriod><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:value-of select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:fxFixingDate/fpml:periodMultiplier"/></xsl:when><xsl:when test="$productType='Cross Currency Basis Swap'"><xsl:value-of select="$idm140055992538800-5/fpml:swapStream[position()=$floatingLeg]/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:fxFixingDate/fpml:periodMultiplier"/></xsl:when></xsl:choose></FxFixingPeriod><FxFixingDayConvention><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:value-of select="substring(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:swap/fpml:swapStream[position()=$fixedLeg]/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:fxFixingDate/fpml:businessDayConvention,1,4)"/></xsl:when><xsl:when test="$productType='Cross Currency Basis Swap'"><xsl:value-of select="substring(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:fxFixingDate/fpml:businessDayConvention,1,4)"/></xsl:when></xsl:choose></FxFixingDayConvention><FxFixingCentres><xsl:choose><xsl:when test="$productType='SingleCurrencyInterestRateSwap' or $productType='OIS' or $productType='Swaption' or $productType='Cross Currency IRS' or $productType='Fixed Fixed Swap'"><xsl:apply-templates select="$idm140055992546864-6/fpml:swapStream[position()=$fixedLeg]/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:fxFixingDate/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:when><xsl:when test="$productType='Cross Currency Basis Swap'"><xsl:apply-templates select="$idm140055992538800-5/fpml:swapStream[position()=$floatingLeg]/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:fxFixingDate/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:when></xsl:choose></FxFixingCentres><ValuationDateType><xsl:choose><xsl:when test="$productType='Cross Currency IRS'"><xsl:apply-templates select="$fixedStream/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:fxFixingDate/fpml:dateRelativeToPaymentDates/fpml:paymentDatesReference[position()=2]/@href"/></xsl:when><xsl:when test="$productType='Cross Currency Basis Swap'"><xsl:apply-templates select="$floatingStream/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:fxFixingDate/fpml:dateRelativeToPaymentDates/fpml:paymentDatesReference[position()=2]/@href"/></xsl:when></xsl:choose></ValuationDateType><ValuationDateType_2><xsl:choose><xsl:when test="$productType='Cross Currency IRS'"><xsl:apply-templates select="$floatingStream/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:fxFixingDate/fpml:dateRelativeToPaymentDates/fpml:paymentDatesReference[position()=2]/@href"/></xsl:when><xsl:when test="$productType='Cross Currency Basis Swap'"><xsl:apply-templates select="$floatingStream2/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:fxFixingDate/fpml:dateRelativeToPaymentDates/fpml:paymentDatesReference[position()=2]/@href"/></xsl:when></xsl:choose></ValuationDateType_2><FxFixingPeriod_2><xsl:choose><xsl:when test="$productType='Cross Currency IRS'"><xsl:value-of select="$idm140055992538800-5/fpml:swapStream[position()=$floatingLeg]/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:fxFixingDate/fpml:periodMultiplier"/></xsl:when><xsl:when test="$productType='Cross Currency Basis Swap'"><xsl:value-of select="$idm140055992538800-5/fpml:swapStream[position()=$floatingLeg2]/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:fxFixingDate/fpml:periodMultiplier"/></xsl:when><xsl:when test="$productType='Fixed Fixed Swap'"><xsl:value-of select="$idm140055992538800-5/fpml:swapStream[position()=$fixedLeg2]/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:fxFixingDate/fpml:periodMultiplier"/></xsl:when></xsl:choose></FxFixingPeriod_2><FxFixingDayConvention_2><xsl:choose><xsl:when test="$productType='Cross Currency IRS'"><xsl:value-of select="substring(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swap/fpml:swapStream[position()=$floatingLeg]/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:fxFixingDate/fpml:businessDayConvention,1,4)"/></xsl:when><xsl:when test="$productType='Cross Currency Basis Swap'"><xsl:value-of select="substring(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swap/fpml:swapStream[position()=$floatingLeg2]/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:fxFixingDate/fpml:businessDayConvention,1,4)"/></xsl:when><xsl:when test="$productType='Fixed Fixed Swap'"><xsl:value-of select="substring(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:swap/fpml:swapStream[position()=$fixedLeg2]/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:fxFixingDate/fpml:businessDayConvention,1,4)"/></xsl:when></xsl:choose></FxFixingDayConvention_2><FxFixingCentres_2><xsl:choose><xsl:when test="$productType='Cross Currency IRS'"><xsl:apply-templates select="$idm140055992538800-5/fpml:swapStream[position()=$floatingLeg]/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:fxFixingDate/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:when><xsl:when test="$productType='Cross Currency Basis Swap'"><xsl:apply-templates select="$idm140055992538800-5/fpml:swapStream[position()=$floatingLeg2]/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:fxFixingDate/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:when><xsl:when test="$productType='Fixed Fixed Swap'"><xsl:apply-templates select="$idm140055992538800-5/fpml:swapStream[position()=$fixedLeg2]/fpml:settlementProvision/fpml:nonDeliverableSettlement/fpml:fxFixingDate/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:when></xsl:choose></FxFixingCentres_2><CalcAgentA><xsl:if test="$referenceCurrency='BRL'"><xsl:choose><xsl:when test="$idm140055992546864-4/fpml:calculationAgent/fpml:calculationAgentParty[.='AsSpecifiedInMasterAgreement']">As Specified in Master Agreement</xsl:when><xsl:when test="count(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:calculationAgent/fpml:calculationAgentPartyReference)=2">Joint</xsl:when><xsl:otherwise/></xsl:choose></xsl:if></CalcAgentA><DefaultSettlementMethod/><SettlementPriceDefaultElectionMethod/><SettlementMethodElectionDate/><SettlementMethodElectingParty/><NotionalFutureValue><xsl:if test="$referenceCurrency='BRL'"><xsl:value-of select="$idm140055992522592-3/fpml:swbFutureValue/fpml:swbNotionalFutureValue/fpml:amount"/></xsl:if></NotionalFutureValue><NotionalSchedule><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='Fixed Fixed Swap' or $productType='OIS'"><xsl:for-each select="$fixedStream/fpml:calculationPeriodAmount/fpml:calculation/fpml:notionalSchedule/fpml:notionalStepSchedule/fpml:step"><xsl:call-template name="formatNotionalSchedule"><xsl:with-param name="position" select="string(position())"/><xsl:with-param name="leg" select="string($fixedLeg)"/></xsl:call-template></xsl:for-each><xsl:if test="not($fixedStream/fpml:calculationPeriodAmount/fpml:calculation/fpml:notionalSchedule/fpml:notionalStepSchedule/fpml:step)"><xsl:for-each select="$fixedStream/fpml:calculationPeriodAmount/fpml:calculation/fpml:fixedRateSchedule/fpml:step"><xsl:call-template name="formatNotionalSchedule"><xsl:with-param name="position" select="string(position())"/><xsl:with-param name="leg" select="string($fixedLeg)"/></xsl:call-template></xsl:for-each></xsl:if></xsl:if><xsl:if test="$productType='Fixed Fixed Swap'"><xsl:for-each select="$fixedStream2/fpml:calculationPeriodAmount/fpml:calculation/fpml:notionalSchedule/fpml:notionalStepSchedule/fpml:step"><xsl:call-template name="formatNotionalSchedule"><xsl:with-param name="position" select="string(position())"/><xsl:with-param name="leg" select="string($fixedLeg2)"/></xsl:call-template></xsl:for-each><xsl:if test="not($fixedStream2/fpml:calculationPeriodAmount/fpml:calculation/fpml:notionalSchedule/fpml:notionalStepSchedule/fpml:step)"><xsl:for-each select="$fixedStream2/fpml:calculationPeriodAmount/fpml:calculation/fpml:fixedRateSchedule/fpml:step"><xsl:call-template name="formatNotionalSchedule"><xsl:with-param name="position" select="string(position())"/><xsl:with-param name="leg" select="string($fixedLeg2)"/></xsl:call-template></xsl:for-each></xsl:if></xsl:if><xsl:if test="$productType='SingleCurrencyInterestRateSwap' or $productType='Single Currency Basis Swap'or $productType='OIS'"><xsl:for-each select="$floatingStream/fpml:calculationPeriodAmount/fpml:calculation/fpml:notionalSchedule/fpml:notionalStepSchedule/fpml:step"><xsl:call-template name="formatNotionalSchedule"><xsl:with-param name="position" select="string(position())"/><xsl:with-param name="leg" select="string($floatingLeg)"/></xsl:call-template></xsl:for-each><xsl:if test="not($floatingStream/fpml:calculationPeriodAmount/fpml:calculation/fpml:notionalSchedule/fpml:notionalStepSchedule/fpml:step)"><xsl:for-each select="$floatingStream/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:spreadSchedule/fpml:step"><xsl:call-template name="formatNotionalSchedule"><xsl:with-param name="position" select="string(position())"/><xsl:with-param name="leg" select="string($floatingLeg)"/></xsl:call-template></xsl:for-each></xsl:if></xsl:if><xsl:if test="$productType='Single Currency Basis Swap'"><xsl:for-each select="$floatingStream2/fpml:calculationPeriodAmount/fpml:calculation/fpml:notionalSchedule/fpml:notionalStepSchedule/fpml:step"><xsl:call-template name="formatNotionalSchedule"><xsl:with-param name="position" select="string(position())"/><xsl:with-param name="leg" select="string($floatingLeg2)"/></xsl:call-template></xsl:for-each><xsl:if test="not($floatingStream2/fpml:calculationPeriodAmount/fpml:calculation/fpml:notionalSchedule/fpml:notionalStepSchedule/fpml:step)"><xsl:for-each select="$floatingStream2/fpml:calculationPeriodAmount/fpml:calculation/fpml:floatingRateCalculation/fpml:spreadSchedule/fpml:step"><xsl:call-template name="formatNotionalSchedule"><xsl:with-param name="position" select="string(position())"/><xsl:with-param name="leg" select="string($floatingLeg2)"/></xsl:call-template></xsl:for-each></xsl:if></xsl:if></NotionalSchedule><DispLegs><DispLeg><DispLegId/><DispLegVersionId/><DispLegPayer/><DispLegReceiver/><DispEquityRic/><DispEquityRelEx/><DispVegaNotional/><DispExpectedN/><DispSettlementDateOffset/><DispVarianceAmount/><DispShareVarCurrency/><DispVarianceStrikePrice/><DispVarianceCapIndicator/><DispVarianceCapFactor/><DispVegaNotionalAmount/><DispObservationStartDate/><DispValuationDate/><DispInitialLevel/><DispClosingLevelIndicator/><DispFuturesPriceValuation/><DispAllDividends/></DispLeg></DispLegs><DispLegsSW><DispLegSW><DispCorrespondingLeg/><DispVolatilityStrikePrice/><DispHolidayDates/><DispExpectedNOverride/><DispShareWeight/></DispLegSW></DispLegsSW><BalanceOfPeriod/><BulletIndicator/><BulletFirstContractMonth/><BulletLastContractMonth/><BulletContractYear/><BulletContractTradingDay/><ClearingVenue/><ClientClearing><xsl:value-of select="$idm140055992522592-4/fpml:swbClientClearing"/></ClientClearing><ExternalInteropabilityId><xsl:value-of select="$idm140055992522592-4/fpml:swbExternalInteropabilityId"/></ExternalInteropabilityId><InteropNettingString><xsl:value-of select="$idm140055992522592-4/fpml:swbInteropNettingString"/></InteropNettingString><AutoSendForClearing><xsl:value-of select="$idm140055992522592-4/fpml:swbAutoSendForClearing"/></AutoSendForClearing><ASICMandatoryClearingIndicator><xsl:value-of select="$idm140055992522592-4/fpml:swbMandatoryClearing[fpml:swbJurisdiction='ASIC']/fpml:swbMandatoryClearingIndicator"/></ASICMandatoryClearingIndicator><PBEBTradeASICMandatoryClearingIndicator><xsl:value-of select="$idm140055992371904-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='ASIC']/fpml:swbMandatoryClearingIndicator"/></PBEBTradeASICMandatoryClearingIndicator><PBClientTradeASICMandatoryClearingIndicator><xsl:value-of select="$idm140055992369888-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='ASIC']/fpml:swbMandatoryClearingIndicator"/></PBClientTradeASICMandatoryClearingIndicator><CANMandatoryClearingIndicator><xsl:value-of select="$idm140055992522592-4/fpml:swbMandatoryClearing[fpml:swbJurisdiction='CAN']/fpml:swbMandatoryClearingIndicator"/></CANMandatoryClearingIndicator><CANClearingExemptIndicator1PartyId><xsl:value-of select="$idm140055992546864-3/fpml:party[@id=/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbMandatoryClearing[fpml:swbJurisdiction='CAN']/fpml:swbPartyExemption[1]/fpml:partyReference/@href]/fpml:partyId"/></CANClearingExemptIndicator1PartyId><CANClearingExemptIndicator1Value><xsl:value-of select="$idm140055992522592-4/fpml:swbMandatoryClearing[fpml:swbJurisdiction='CAN']/fpml:swbPartyExemption[1]/fpml:swbExemption"/></CANClearingExemptIndicator1Value><CANClearingExemptIndicator2PartyId><xsl:value-of select="$idm140055991938160-4/fpml:party[@id=/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbMandatoryClearing[fpml:swbJurisdiction='CAN']/fpml:swbPartyExemption[2]/fpml:partyReference/@href]/fpml:partyId"/></CANClearingExemptIndicator2PartyId><CANClearingExemptIndicator2Value><xsl:value-of select="$idm140055992522592-4/fpml:swbMandatoryClearing[fpml:swbJurisdiction='CAN']/fpml:swbPartyExemption[2]/fpml:swbExemption"/></CANClearingExemptIndicator2Value><PBEBTradeCANMandatoryClearingIndicator><xsl:value-of select="$idm140055992371904-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='CAN']/fpml:swbMandatoryClearingIndicator"/></PBEBTradeCANMandatoryClearingIndicator><PBEBTradeCANClearingExemptIndicator1PartyId><xsl:value-of select=" /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:party[@id=/fpml:SWBML/fpml:swbGiveUp/fpml:swbInterDealerTransaction/fpml:swbMandatoryClearing[fpml:swbJurisdiction='CAN']/fpml:swbPartyExemption[1]/fpml:partyReference/@href]/fpml:partyId"/></PBEBTradeCANClearingExemptIndicator1PartyId><PBEBTradeCANClearingExemptIndicator1Value><xsl:value-of select="$idm140055992371904-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='CAN']/fpml:swbPartyExemption[1]/fpml:swbExemption"/></PBEBTradeCANClearingExemptIndicator1Value><PBEBTradeCANClearingExemptIndicator2PartyId><xsl:value-of select=" /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:party[@id=/fpml:SWBML/fpml:swbGiveUp/fpml:swbInterDealerTransaction/fpml:swbMandatoryClearing[fpml:swbJurisdiction='CAN']/fpml:swbPartyExemption[2]/fpml:partyReference/@href]/fpml:partyId"/></PBEBTradeCANClearingExemptIndicator2PartyId><PBEBTradeCANClearingExemptIndicator2Value><xsl:value-of select="$idm140055992371904-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='CAN']/fpml:swbPartyExemption[2]/fpml:swbExemption"/></PBEBTradeCANClearingExemptIndicator2Value><PBClientTradeCANMandatoryClearingIndicator><xsl:value-of select="$idm140055992369888-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='CAN']/fpml:swbMandatoryClearingIndicator"/></PBClientTradeCANMandatoryClearingIndicator><PBClientTradeCANClearingExemptIndicator1PartyId><xsl:value-of select=" /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:party[@id=/fpml:SWBML/fpml:swbGiveUp/fpml:swbCustomerTransaction/fpml:swbMandatoryClearing[fpml:swbJurisdiction='CAN']/fpml:swbPartyExemption[1]/fpml:partyReference/@href]/fpml:partyId"/></PBClientTradeCANClearingExemptIndicator1PartyId><PBClientTradeCANClearingExemptIndicator1Value><xsl:value-of select="$idm140055992369888-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='CAN']/fpml:swbPartyExemption[1]/fpml:swbExemption"/></PBClientTradeCANClearingExemptIndicator1Value><PBClientTradeCANClearingExemptIndicator2PartyId><xsl:value-of select="$idm140055992546864-3/fpml:party[@id=/fpml:SWBML/fpml:swbGiveUp/fpml:swbCustomerTransaction/fpml:swbMandatoryClearing[fpml:swbJurisdiction='CAN']/fpml:swbPartyExemption[2]/fpml:partyReference/@href]/fpml:partyId"/></PBClientTradeCANClearingExemptIndicator2PartyId><PBClientTradeCANClearingExemptIndicator2Value><xsl:value-of select="$idm140055992369888-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='CAN']/fpml:swbPartyExemption[2]/fpml:swbExemption"/></PBClientTradeCANClearingExemptIndicator2Value><ESMAMandatoryClearingIndicator><xsl:value-of select="$idm140055992522592-4/fpml:swbMandatoryClearing[fpml:swbJurisdiction='ESMA']/fpml:swbMandatoryClearingIndicator"/></ESMAMandatoryClearingIndicator><ESMAClearingExemptIndicator1PartyId><xsl:value-of select="$idm140055992546864-3/fpml:party[@id=/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbMandatoryClearing[fpml:swbJurisdiction='ESMA']/fpml:swbPartyExemption[1]/fpml:partyReference/@href]/fpml:partyId"/></ESMAClearingExemptIndicator1PartyId><ESMAClearingExemptIndicator1Value><xsl:value-of select="$idm140055992522592-4/fpml:swbMandatoryClearing[fpml:swbJurisdiction='ESMA']/fpml:swbPartyExemption[1]/fpml:swbExemption"/></ESMAClearingExemptIndicator1Value><ESMAClearingExemptIndicator2PartyId><xsl:value-of select="$idm140055991938160-4/fpml:party[@id=/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbMandatoryClearing[fpml:swbJurisdiction='ESMA']/fpml:swbPartyExemption[2]/fpml:partyReference/@href]/fpml:partyId"/></ESMAClearingExemptIndicator2PartyId><ESMAClearingExemptIndicator2Value><xsl:value-of select="$idm140055992522592-4/fpml:swbMandatoryClearing[fpml:swbJurisdiction='ESMA']/fpml:swbPartyExemption[2]/fpml:swbExemption"/></ESMAClearingExemptIndicator2Value><PBEBTradeESMAMandatoryClearingIndicator><xsl:value-of select="$idm140055992371904-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='ESMA']/fpml:swbMandatoryClearingIndicator"/></PBEBTradeESMAMandatoryClearingIndicator><PBEBTradeESMAClearingExemptIndicator1PartyId><xsl:value-of select=" /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:party[@id=/fpml:SWBML/fpml:swbGiveUp/fpml:swbInterDealerTransaction/fpml:swbMandatoryClearing[fpml:swbJurisdiction='ESMA']/fpml:swbPartyExemption[1]/fpml:partyReference/@href]/fpml:partyId"/></PBEBTradeESMAClearingExemptIndicator1PartyId><PBEBTradeESMAClearingExemptIndicator1Value><xsl:value-of select="$idm140055992371904-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='ESMA']/fpml:swbPartyExemption[1]/fpml:swbExemption"/></PBEBTradeESMAClearingExemptIndicator1Value><PBEBTradeESMAClearingExemptIndicator2PartyId><xsl:value-of select=" /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:party[@id=/fpml:SWBML/fpml:swbGiveUp/fpml:swbInterDealerTransaction/fpml:swbMandatoryClearing[fpml:swbJurisdiction='ESMA']/fpml:swbPartyExemption[2]/fpml:partyReference/@href]/fpml:partyId"/></PBEBTradeESMAClearingExemptIndicator2PartyId><PBEBTradeESMAClearingExemptIndicator2Value><xsl:value-of select="$idm140055992371904-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='ESMA']/fpml:swbPartyExemption[2]/fpml:swbExemption"/></PBEBTradeESMAClearingExemptIndicator2Value><PBClientTradeESMAMandatoryClearingIndicator><xsl:value-of select="$idm140055992369888-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='ESMA']/fpml:swbMandatoryClearingIndicator"/></PBClientTradeESMAMandatoryClearingIndicator><PBClientTradeESMAClearingExemptIndicator1PartyId><xsl:value-of select=" /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:party[@id=/fpml:SWBML/fpml:swbGiveUp/fpml:swbCustomerTransaction/fpml:swbMandatoryClearing[fpml:swbJurisdiction='ESMA']/fpml:swbPartyExemption[1]/fpml:partyReference/@href]/fpml:partyId"/></PBClientTradeESMAClearingExemptIndicator1PartyId><PBClientTradeESMAClearingExemptIndicator1Value><xsl:value-of select="$idm140055992369888-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='ESMA']/fpml:swbPartyExemption[1]/fpml:swbExemption"/></PBClientTradeESMAClearingExemptIndicator1Value><PBClientTradeESMAClearingExemptIndicator2PartyId><xsl:value-of select="$idm140055992546864-3/fpml:party[@id=/fpml:SWBML/fpml:swbGiveUp/fpml:swbCustomerTransaction/fpml:swbMandatoryClearing[fpml:swbJurisdiction='ESMA']/fpml:swbPartyExemption[2]/fpml:partyReference/@href]/fpml:partyId"/></PBClientTradeESMAClearingExemptIndicator2PartyId><PBClientTradeESMAClearingExemptIndicator2Value><xsl:value-of select="$idm140055992369888-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='ESMA']/fpml:swbPartyExemption[2]/fpml:swbExemption"/></PBClientTradeESMAClearingExemptIndicator2Value><FCAMandatoryClearingIndicator><xsl:value-of select="$idm140055992522592-4/fpml:swbMandatoryClearing[fpml:swbJurisdiction='FCA']/fpml:swbMandatoryClearingIndicator"/></FCAMandatoryClearingIndicator><FCAClearingExemptIndicator1PartyId><xsl:value-of select="$idm140055992546864-3/fpml:party[@id=/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbMandatoryClearing[fpml:swbJurisdiction='FCA']/fpml:swbPartyExemption[1]/fpml:partyReference/@href]/fpml:partyId"/></FCAClearingExemptIndicator1PartyId><FCAClearingExemptIndicator1Value><xsl:value-of select="$idm140055992522592-4/fpml:swbMandatoryClearing[fpml:swbJurisdiction='FCA']/fpml:swbPartyExemption[1]/fpml:swbExemption"/></FCAClearingExemptIndicator1Value><FCAClearingExemptIndicator2PartyId><xsl:value-of select="$idm140055991938160-4/fpml:party[@id=/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbMandatoryClearing[fpml:swbJurisdiction='FCA']/fpml:swbPartyExemption[2]/fpml:partyReference/@href]/fpml:partyId"/></FCAClearingExemptIndicator2PartyId><FCAClearingExemptIndicator2Value><xsl:value-of select="$idm140055992522592-4/fpml:swbMandatoryClearing[fpml:swbJurisdiction='FCA']/fpml:swbPartyExemption[2]/fpml:swbExemption"/></FCAClearingExemptIndicator2Value><PBEBTradeFCAMandatoryClearingIndicator><xsl:value-of select="$idm140055992371904-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='FCA']/fpml:swbMandatoryClearingIndicator"/></PBEBTradeFCAMandatoryClearingIndicator><PBEBTradeFCAClearingExemptIndicator1PartyId><xsl:value-of select=" /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:party[@id=/fpml:SWBML/fpml:swbGiveUp/fpml:swbInterDealerTransaction/fpml:swbMandatoryClearing[fpml:swbJurisdiction='FCA']/fpml:swbPartyExemption[1]/fpml:partyReference/@href]/fpml:partyId"/></PBEBTradeFCAClearingExemptIndicator1PartyId><PBEBTradeFCAClearingExemptIndicator1Value><xsl:value-of select="$idm140055992371904-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='FCA']/fpml:swbPartyExemption[1]/fpml:swbExemption"/></PBEBTradeFCAClearingExemptIndicator1Value><PBEBTradeFCAClearingExemptIndicator2PartyId><xsl:value-of select=" /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:party[@id=/fpml:SWBML/fpml:swbGiveUp/fpml:swbInterDealerTransaction/fpml:swbMandatoryClearing[fpml:swbJurisdiction='FCA']/fpml:swbPartyExemption[2]/fpml:partyReference/@href]/fpml:partyId"/></PBEBTradeFCAClearingExemptIndicator2PartyId><PBEBTradeFCAClearingExemptIndicator2Value><xsl:value-of select="$idm140055992371904-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='FCA']/fpml:swbPartyExemption[2]/fpml:swbExemption"/></PBEBTradeFCAClearingExemptIndicator2Value><PBClientTradeFCAMandatoryClearingIndicator><xsl:value-of select="$idm140055992369888-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='FCA']/fpml:swbMandatoryClearingIndicator"/></PBClientTradeFCAMandatoryClearingIndicator><PBClientTradeFCAClearingExemptIndicator1PartyId><xsl:value-of select=" /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:party[@id=/fpml:SWBML/fpml:swbGiveUp/fpml:swbCustomerTransaction/fpml:swbMandatoryClearing[fpml:swbJurisdiction='FCA']/fpml:swbPartyExemption[1]/fpml:partyReference/@href]/fpml:partyId"/></PBClientTradeFCAClearingExemptIndicator1PartyId><PBClientTradeFCAClearingExemptIndicator1Value><xsl:value-of select="$idm140055992369888-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='FCA']/fpml:swbPartyExemption[1]/fpml:swbExemption"/></PBClientTradeFCAClearingExemptIndicator1Value><PBClientTradeFCAClearingExemptIndicator2PartyId><xsl:value-of select="$idm140055992546864-3/fpml:party[@id=/fpml:SWBML/fpml:swbGiveUp/fpml:swbCustomerTransaction/fpml:swbMandatoryClearing[fpml:swbJurisdiction='FCA']/fpml:swbPartyExemption[2]/fpml:partyReference/@href]/fpml:partyId"/></PBClientTradeFCAClearingExemptIndicator2PartyId><PBClientTradeFCAClearingExemptIndicator2Value><xsl:value-of select="$idm140055992369888-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='FCA']/fpml:swbPartyExemption[2]/fpml:swbExemption"/></PBClientTradeFCAClearingExemptIndicator2Value><HKMAMandatoryClearingIndicator><xsl:value-of select="$idm140055992522592-4/fpml:swbMandatoryClearing[fpml:swbJurisdiction='HKMA']/fpml:swbMandatoryClearingIndicator"/></HKMAMandatoryClearingIndicator><HKMAClearingExemptIndicator1PartyId><xsl:value-of select="$idm140055992546864-3/fpml:party[@id=/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbMandatoryClearing[fpml:swbJurisdiction='HKMA']/fpml:swbPartyExemption[1]/fpml:partyReference/@href]/fpml:partyId"/></HKMAClearingExemptIndicator1PartyId><HKMAClearingExemptIndicator1Value><xsl:value-of select="$idm140055992522592-4/fpml:swbMandatoryClearing[fpml:swbJurisdiction='HKMA']/fpml:swbPartyExemption[1]/fpml:swbExemption"/></HKMAClearingExemptIndicator1Value><HKMAClearingExemptIndicator2PartyId><xsl:value-of select="$idm140055991938160-4/fpml:party[@id=/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbMandatoryClearing[fpml:swbJurisdiction='HKMA']/fpml:swbPartyExemption[2]/fpml:partyReference/@href]/fpml:partyId"/></HKMAClearingExemptIndicator2PartyId><HKMAClearingExemptIndicator2Value><xsl:value-of select="$idm140055992522592-4/fpml:swbMandatoryClearing[fpml:swbJurisdiction='HKMA']/fpml:swbPartyExemption[2]/fpml:swbExemption"/></HKMAClearingExemptIndicator2Value><PBEBTradeHKMAMandatoryClearingIndicator><xsl:value-of select="$idm140055992371904-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='HKMA']/fpml:swbMandatoryClearingIndicator"/></PBEBTradeHKMAMandatoryClearingIndicator><PBEBTradeHKMAClearingExemptIndicator1PartyId><xsl:value-of select=" /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:party[@id=/fpml:SWBML/fpml:swbGiveUp/fpml:swbInterDealerTransaction/fpml:swbMandatoryClearing[fpml:swbJurisdiction='HKMA']/fpml:swbPartyExemption[1]/fpml:partyReference/@href]/fpml:partyId"/></PBEBTradeHKMAClearingExemptIndicator1PartyId><PBEBTradeHKMAClearingExemptIndicator1Value><xsl:value-of select="$idm140055992371904-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='HKMA']/fpml:swbPartyExemption[1]/fpml:swbExemption"/></PBEBTradeHKMAClearingExemptIndicator1Value><PBEBTradeHKMAClearingExemptIndicator2PartyId><xsl:value-of select=" /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:party[@id=/fpml:SWBML/fpml:swbGiveUp/fpml:swbInterDealerTransaction/fpml:swbMandatoryClearing[fpml:swbJurisdiction='HKMA']/fpml:swbPartyExemption[2]/fpml:partyReference/@href]/fpml:partyId"/></PBEBTradeHKMAClearingExemptIndicator2PartyId><PBEBTradeHKMAClearingExemptIndicator2Value><xsl:value-of select="$idm140055992371904-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='HKMA']/fpml:swbPartyExemption[2]/fpml:swbExemption"/></PBEBTradeHKMAClearingExemptIndicator2Value><PBClientTradeHKMAMandatoryClearingIndicator><xsl:value-of select="$idm140055992369888-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='HKMA']/fpml:swbMandatoryClearingIndicator"/></PBClientTradeHKMAMandatoryClearingIndicator><PBClientTradeHKMAClearingExemptIndicator1PartyId><xsl:value-of select=" /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:party[@id=/fpml:SWBML/fpml:swbGiveUp/fpml:swbCustomerTransaction/fpml:swbMandatoryClearing[fpml:swbJurisdiction='HKMA']/fpml:swbPartyExemption[1]/fpml:partyReference/@href]/fpml:partyId"/></PBClientTradeHKMAClearingExemptIndicator1PartyId><PBClientTradeHKMAClearingExemptIndicator1Value><xsl:value-of select="$idm140055992369888-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='HKMA']/fpml:swbPartyExemption[1]/fpml:swbExemption"/></PBClientTradeHKMAClearingExemptIndicator1Value><PBClientTradeHKMAClearingExemptIndicator2PartyId><xsl:value-of select="$idm140055992546864-3/fpml:party[@id=/fpml:SWBML/fpml:swbGiveUp/fpml:swbCustomerTransaction/fpml:swbMandatoryClearing[fpml:swbJurisdiction='HKMA']/fpml:swbPartyExemption[2]/fpml:partyReference/@href]/fpml:partyId"/></PBClientTradeHKMAClearingExemptIndicator2PartyId><PBClientTradeHKMAClearingExemptIndicator2Value><xsl:value-of select="$idm140055992369888-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='HKMA']/fpml:swbPartyExemption[2]/fpml:swbExemption"/></PBClientTradeHKMAClearingExemptIndicator2Value><JFSAMandatoryClearingIndicator><xsl:value-of select="$idm140055992522592-4/fpml:swbMandatoryClearing[fpml:swbJurisdiction='JFSA']/fpml:swbMandatoryClearingIndicator"/></JFSAMandatoryClearingIndicator><CFTCMandatoryClearingIndicator><xsl:value-of select="$idm140055992522592-4/fpml:swbMandatoryClearing[fpml:swbJurisdiction='DoddFrank']/fpml:swbMandatoryClearingIndicator"/></CFTCMandatoryClearingIndicator><CFTCClearingExemptIndicator1PartyId><xsl:value-of select="$idm140055992546864-3/fpml:party[@id=/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbMandatoryClearing[fpml:swbJurisdiction='DoddFrank']/fpml:swbPartyExemption[1]/fpml:partyReference/@href]/fpml:partyId"/></CFTCClearingExemptIndicator1PartyId><CFTCClearingExemptIndicator1Value><xsl:value-of select="$idm140055992522592-4/fpml:swbMandatoryClearing[fpml:swbJurisdiction='DoddFrank']/fpml:swbPartyExemption[1]/fpml:swbExemption"/></CFTCClearingExemptIndicator1Value><CFTCClearingExemptIndicator2PartyId><xsl:value-of select="$idm140055991938160-4/fpml:party[@id=/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbMandatoryClearing[fpml:swbJurisdiction='DoddFrank']/fpml:swbPartyExemption[2]/fpml:partyReference/@href]/fpml:partyId"/></CFTCClearingExemptIndicator2PartyId><CFTCClearingExemptIndicator2Value><xsl:value-of select="$idm140055992522592-4/fpml:swbMandatoryClearing[fpml:swbJurisdiction='DoddFrank']/fpml:swbPartyExemption[2]/fpml:swbExemption"/></CFTCClearingExemptIndicator2Value><CFTCInterAffiliateExemption><xsl:value-of select="$idm140055992522592-4/fpml:swbMandatoryClearing[fpml:swbJurisdiction='DoddFrank']/fpml:swbInterAffiliateExemption"/></CFTCInterAffiliateExemption><PBEBTradeCFTCMandatoryClearingIndicator><xsl:value-of select="$idm140055992371904-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='DoddFrank']/fpml:swbMandatoryClearingIndicator"/></PBEBTradeCFTCMandatoryClearingIndicator><PBEBTradeCFTCClearingExemptIndicator1PartyId><xsl:value-of select=" /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:party[@id=/fpml:SWBML/fpml:swbGiveUp/fpml:swbInterDealerTransaction/fpml:swbMandatoryClearing[fpml:swbJurisdiction='DoddFrank']/fpml:swbPartyExemption[1]/fpml:partyReference/@href]/fpml:partyId"/></PBEBTradeCFTCClearingExemptIndicator1PartyId><PBEBTradeCFTCClearingExemptIndicator1Value><xsl:value-of select="$idm140055992371904-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='DoddFrank']/fpml:swbPartyExemption[1]/fpml:swbExemption"/></PBEBTradeCFTCClearingExemptIndicator1Value><PBEBTradeCFTCClearingExemptIndicator2PartyId><xsl:value-of select=" /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:party[@id=/fpml:SWBML/fpml:swbGiveUp/fpml:swbInterDealerTransaction/fpml:swbMandatoryClearing[fpml:swbJurisdiction='DoddFrank']/fpml:swbPartyExemption[2]/fpml:partyReference/@href]/fpml:partyId"/></PBEBTradeCFTCClearingExemptIndicator2PartyId><PBEBTradeCFTCClearingExemptIndicator2Value><xsl:value-of select="$idm140055992371904-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='DoddFrank']/fpml:swbPartyExemption[2]/fpml:swbExemption"/></PBEBTradeCFTCClearingExemptIndicator2Value><PBEBTradeCFTCInterAffiliateExemption><xsl:value-of select="$idm140055992371904-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='DoddFrank']/fpml:swbInterAffiliateExemption"/></PBEBTradeCFTCInterAffiliateExemption><PBClientTradeCFTCMandatoryClearingIndicator><xsl:value-of select="$idm140055992369888-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='DoddFrank']/fpml:swbMandatoryClearingIndicator"/></PBClientTradeCFTCMandatoryClearingIndicator><PBClientTradeCFTCClearingExemptIndicator1PartyId><xsl:value-of select=" /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:party[@id=/fpml:SWBML/fpml:swbGiveUp/fpml:swbCustomerTransaction/fpml:swbMandatoryClearing[fpml:swbJurisdiction='DoddFrank']/fpml:swbPartyExemption[1]/fpml:partyReference/@href]/fpml:partyId"/></PBClientTradeCFTCClearingExemptIndicator1PartyId><PBClientTradeCFTCClearingExemptIndicator1Value><xsl:value-of select="$idm140055992369888-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='DoddFrank']/fpml:swbPartyExemption[1]/fpml:swbExemption"/></PBClientTradeCFTCClearingExemptIndicator1Value><PBClientTradeCFTCClearingExemptIndicator2PartyId><xsl:value-of select="$idm140055992546864-3/fpml:party[@id=/fpml:SWBML/fpml:swbGiveUp/fpml:swbCustomerTransaction/fpml:swbMandatoryClearing[fpml:swbJurisdiction='DoddFrank']/fpml:swbPartyExemption[2]/fpml:partyReference/@href]/fpml:partyId"/></PBClientTradeCFTCClearingExemptIndicator2PartyId><PBClientTradeCFTCClearingExemptIndicator2Value><xsl:value-of select="$idm140055992369888-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='DoddFrank']/fpml:swbPartyExemption[2]/fpml:swbExemption"/></PBClientTradeCFTCClearingExemptIndicator2Value><PBClientTradeCFTCInterAffiliateExemption><xsl:value-of select="$idm140055992369888-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='DoddFrank']/fpml:swbInterAffiliateExemption"/></PBClientTradeCFTCInterAffiliateExemption><MASMandatoryClearingIndicator><xsl:value-of select="$idm140055992522592-4/fpml:swbMandatoryClearing[fpml:swbJurisdiction='MAS']/fpml:swbMandatoryClearingIndicator"/></MASMandatoryClearingIndicator><PBEBTradeMASMandatoryClearingIndicator><xsl:value-of select="$idm140055992371904-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='MAS']/fpml:swbMandatoryClearingIndicator"/></PBEBTradeMASMandatoryClearingIndicator><PBClientTradeMASMandatoryClearingIndicator><xsl:value-of select="$idm140055992369888-3/fpml:swbMandatoryClearing[fpml:swbJurisdiction='MAS']/fpml:swbMandatoryClearingIndicator"/></PBClientTradeMASMandatoryClearingIndicator><ClearingHouseId><xsl:value-of select="$idm140055992522592-4/fpml:swbClearingHouse/fpml:partyId"/></ClearingHouseId><IntendedClearingHouse><xsl:value-of select="$idm140055992522592-4/fpml:swbClearingHouse/fpml:partyId"/></IntendedClearingHouse><TraderId/><TraderId_2/><xsl:if test="$idm140055992522592-4/fpml:swbExecutingBroker and /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbClearingClient and /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbClientClearing='true' and not(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbDisplayPartyLegalEntity) and $isPrimeBrokered='0'"><ExecutingBroker><xsl:value-of select="$partyA"/></ExecutingBroker><ClearingClient><xsl:value-of select="$partyB"/></ClearingClient></xsl:if><xsl:for-each select="$idm140055992522592-4/fpml:swbPartyClearingBroker"><xsl:if test="fpml:partyReference/@href= /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbClearingClient/@href"><ClientClearingBroker><xsl:value-of select="fpml:swbClearingBroker/fpml:partyId"/></ClientClearingBroker></xsl:if></xsl:for-each><xsl:for-each select="$idm140055992522592-4/fpml:swbPartyClearingBroker"><xsl:if test="fpml:partyReference/@href= /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbExecutingBroker/@href"><EBClearingBroker><xsl:value-of select="fpml:swbClearingBroker/fpml:partyId"/></EBClearingBroker></xsl:if></xsl:for-each><xsl:for-each select="$idm140055992522592-4/fpml:swbPartyClearingBroker"><xsl:choose><xsl:when test="fpml:partyReference/@href = 'partyA'"><PartyAClearingBroker><xsl:value-of select="fpml:swbClearingBroker/fpml:partyId"/></PartyAClearingBroker></xsl:when></xsl:choose></xsl:for-each><xsl:for-each select="$idm140055992522592-4/fpml:swbPartyClearingBroker"><xsl:choose><xsl:when test="fpml:partyReference/@href = 'partyB'"><PartyBClearingBroker><xsl:value-of select="fpml:swbClearingBroker/fpml:partyId"/></PartyBClearingBroker></xsl:when></xsl:choose></xsl:for-each><DisplayPartyLE_Party><xsl:if test="$idm140055992522592-4/fpml:swbDisplayPartyLegalEntity"><xsl:value-of select="$idm140055992522592-4/fpml:swbDisplayPartyLegalEntity/fpml:partyReference/@href"/></xsl:if></DisplayPartyLE_Party><DisplayPartyLE_Value><xsl:if test="$idm140055992522592-4/fpml:swbDisplayPartyLegalEntity"><xsl:value-of select="$idm140055992522592-4/fpml:swbDisplayPartyLegalEntity/fpml:swbDisplayLE/fpml:partyId"/></xsl:if></DisplayPartyLE_Value><ClearingNettingParty><xsl:if test="$idm140055992522592-4/fpml:swbPartyNettingString"><xsl:for-each select="$idm140055992522592-4/fpml:swbPartyNettingString"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbExecutingBroker/@href"><xsl:value-of select="fpml:partyReference/@href"/></xsl:when><xsl:when test="fpml:partyReference/@href = 'partyA'"><xsl:value-of select="fpml:partyReference/@href"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></ClearingNettingParty><ClearingNettingString><xsl:if test="$idm140055992522592-4/fpml:swbPartyNettingString"><xsl:for-each select="$idm140055992522592-4/fpml:swbPartyNettingString"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbExecutingBroker/@href"><xsl:value-of select="fpml:swbNettingString"/></xsl:when><xsl:when test="fpml:partyReference/@href = 'partyA'"><xsl:value-of select="fpml:swbNettingString"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></ClearingNettingString><ClearingNettingParty_2><xsl:if test="$idm140055992522592-4/fpml:swbPartyNettingString"><xsl:for-each select="$idm140055992522592-4/fpml:swbPartyNettingString"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbClearingClient/@href"><xsl:value-of select="fpml:partyReference/@href"/></xsl:when><xsl:when test="fpml:partyReference/@href = 'partyB'"><xsl:value-of select="fpml:partyReference/@href"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></ClearingNettingParty_2><ClearingNettingString_2><xsl:if test="$idm140055992522592-4/fpml:swbPartyNettingString"><xsl:for-each select="$idm140055992522592-4/fpml:swbPartyNettingString"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbClearingClient/@href"><xsl:value-of select="fpml:swbNettingString"/></xsl:when><xsl:when test="fpml:partyReference/@href = 'partyB'"><xsl:value-of select="fpml:swbNettingString"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></ClearingNettingString_2><CreditAcceptanceParty><xsl:if test="$idm140055992522592-4/fpml:swbPartyCreditAcceptanceToken"><xsl:for-each select="$idm140055992522592-4/fpml:swbPartyCreditAcceptanceToken"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbExecutingBroker/@href"><xsl:value-of select="fpml:partyReference/@href"/></xsl:when><xsl:when test="fpml:partyReference/@href = 'partyA'"><xsl:value-of select="fpml:partyReference/@href"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></CreditAcceptanceParty><CreditAcceptanceIssuer><xsl:if test="$idm140055992522592-4/fpml:swbPartyCreditAcceptanceToken"><xsl:for-each select="$idm140055992522592-4/fpml:swbPartyCreditAcceptanceToken"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbExecutingBroker/@href"><xsl:value-of select="fpml:swbCreditIssuer"/></xsl:when><xsl:when test="fpml:partyReference/@href = 'partyA'"><xsl:value-of select="fpml:swbCreditIssuer"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></CreditAcceptanceIssuer><CreditAcceptanceToken><xsl:if test="$idm140055992522592-4/fpml:swbPartyCreditAcceptanceToken"><xsl:for-each select="$idm140055992522592-4/fpml:swbPartyCreditAcceptanceToken"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbExecutingBroker/@href"><xsl:value-of select="fpml:swbToken"/></xsl:when><xsl:when test="fpml:partyReference/@href = 'partyA'"><xsl:value-of select="fpml:swbToken"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></CreditAcceptanceToken><CreditAcceptanceParty_2><xsl:if test="$idm140055992522592-4/fpml:swbPartyCreditAcceptanceToken"><xsl:for-each select="$idm140055992522592-4/fpml:swbPartyCreditAcceptanceToken"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbClearingClient/@href"><xsl:value-of select="fpml:partyReference/@href"/></xsl:when><xsl:when test="fpml:partyReference/@href = 'partyB'"><xsl:value-of select="fpml:partyReference/@href"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></CreditAcceptanceParty_2><CreditAcceptanceIssuer_2><xsl:if test="$idm140055992522592-4/fpml:swbPartyCreditAcceptanceToken"><xsl:for-each select="$idm140055992522592-4/fpml:swbPartyCreditAcceptanceToken"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbClearingClient/@href"><xsl:value-of select="fpml:swbCreditIssuer"/></xsl:when><xsl:when test="fpml:partyReference/@href = 'partyB'"><xsl:value-of select="fpml:swbCreditIssuer"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></CreditAcceptanceIssuer_2><CreditAcceptanceToken_2><xsl:if test="$idm140055992522592-4/fpml:swbPartyCreditAcceptanceToken"><xsl:for-each select="$idm140055992522592-4/fpml:swbPartyCreditAcceptanceToken"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbClearingClient/@href"><xsl:value-of select="fpml:swbToken"/></xsl:when><xsl:when test="fpml:partyReference/@href = 'partyB'"><xsl:value-of select="fpml:swbToken"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></CreditAcceptanceToken_2><CommodityReferencePrice/><CommodityReferencePrice_2/><CommonPricing/><DeliveryDates/><DeliveryDates_2/><DeliveryLocation/><FloatCalculationFrequency/><FloatCalculationFrequency_2/><PhysicalCommodity/><PhysicalElectricityProduct/><PhysicalElectricityForceMajeure/><PhysicalGasDeliveryType/><ForwardUnderlyer/><FuturesRollConvention/><FuturesRollConvention_2/><LoadShape/><LoadShape_2/><NotionalLots/><NotionalQuantity/><NotionalQuantity_2/><PricingDayType/><PricingDayType_2/><PricingFrequency/><PricingFrequency_2/><PricingHolidayCentres/><PricingHolidayCentres_2/><PricingLagInterval/><PricingLagInterval_2/><PricingLagSkipInterval/><PricingLagSkipInterval_2/><PricingRange/><PricingRange_2/><SettlementDaysConvention/><SettlementDaysType/><SpecifiedPrice/><SpecifiedPrice_2/><UnitFrequency/><Units/><Units_2/><ValueDate/><ModifiedEquityDelivery/><SettledEntityMatrixSource/><SettledEntityMatrixDate/><AdditionalTerms/><Rule15A-6/><xsl:call-template name="outputCommonReportingFields"><xsl:with-param name="reportingData" select="$reportingData"/><xsl:with-param name="brokerPrivateData" select="$brokerPrivateData"/><xsl:with-param name="partyAPrivateData" select="$partyAPrivateData"/><xsl:with-param name="partyBPrivateData" select="$partyBPrivateData"/><xsl:with-param name="brokerPBPrivateData" select="$brokerPBPrivateData"/><xsl:with-param name="pbPrivateData" select="$pbPrivateData"/><xsl:with-param name="clientPrivateData" select="$clientPrivateData"/></xsl:call-template><xsl:for-each select="$idm140055992546864-2/fpml:swbBusinessConductDetails/fpml:swbMidMarketPrice"><xsl:choose><xsl:when test="fpml:swbUnit | fpml:swbAmount | fpml:swbCurrency"><MidMarketPriceType><xsl:value-of select="fpml:swbUnit"/></MidMarketPriceType><MidMarketPriceValue><xsl:value-of select="fpml:swbAmount"/></MidMarketPriceValue><xsl:choose><xsl:when test="fpml:swbUnit='Price'"><MidMarketPriceCurrency><xsl:value-of select="fpml:swbCurrency"/></MidMarketPriceCurrency></xsl:when><xsl:otherwise><IntentToBlankMidMarketCurrency>true</IntentToBlankMidMarketCurrency></xsl:otherwise></xsl:choose></xsl:when><xsl:otherwise><IntentToBlankMidMarketPrice>true</IntentToBlankMidMarketPrice></xsl:otherwise></xsl:choose></xsl:for-each><xsl:call-template name="brokerProvidedOrderDetails"><xsl:with-param name="extendedTradeDetails" select="$extendedTradeDetails"/></xsl:call-template><xsl:call-template name="brokerProvidedPackageDetails"><xsl:with-param name="extendedTradeDetails" select="$extendedTradeDetails"/></xsl:call-template><xsl:variable name="swbTradeHeader" select="$idm140055992522592-4"/><AutoProcessing><xsl:value-of select="$swbTradeHeader/fpml:swbAutoProcessing"/></AutoProcessing><AnonymousTrade><xsl:value-of select="$swbTradeHeader/fpml:swbAnonymousTrade"/></AnonymousTrade><GCOffsettingID><xsl:value-of select="$swbTradeHeader/fpml:swbOffsettingTradeId"/></GCOffsettingID><CompressionType><xsl:value-of select="$swbTradeHeader/fpml:swbCompressionType"/></CompressionType><xsl:for-each select="$swbTradeHeader/fpml:swbPartyExecutionMethod"><xsl:if test="fpml:partyReference/@href = 'partyA'"><GCExecutionMethodParty_1><xsl:value-of select="fpml:partyReference/@href"/></GCExecutionMethodParty_1><GCExecutionMethodToken_1><xsl:value-of select="fpml:swbExecutionMethod"/></GCExecutionMethodToken_1></xsl:if></xsl:for-each><xsl:for-each select="$swbTradeHeader/fpml:swbPartyExecutionMethod"><xsl:if test="fpml:partyReference/@href = 'partyB'"><GCExecutionMethodParty_2><xsl:value-of select="fpml:partyReference/@href"/></GCExecutionMethodParty_2><GCExecutionMethodToken_2><xsl:value-of select="fpml:swbExecutionMethod"/></GCExecutionMethodToken_2></xsl:if></xsl:for-each><OTVConfirmation><xsl:value-of select="$swbTradeHeader/fpml:swbOTVConfirmation"/></OTVConfirmation><IntroducingBroker><xsl:if test="$idm140055992522592-4/fpml:swbPartyIntroducingBroker"><xsl:for-each select="$idm140055992522592-4/fpml:swbPartyIntroducingBroker"><xsl:if test="fpml:partyReference/@href = 'partyA'"><xsl:value-of select="fpml:swbIntroducingBroker"/></xsl:if></xsl:for-each></xsl:if></IntroducingBroker><IntroducingBroker_2><xsl:if test="$idm140055992522592-4/fpml:swbPartyIntroducingBroker"><xsl:for-each select="$idm140055992522592-4/fpml:swbPartyIntroducingBroker"><xsl:if test="fpml:partyReference/@href = 'partyB'"><xsl:value-of select="fpml:swbIntroducingBroker"/></xsl:if></xsl:for-each></xsl:if></IntroducingBroker_2><OriginatingEvent><xsl:value-of select="$swbTradeHeader/fpml:swbOriginatingEvent"/></OriginatingEvent><xsl:apply-templates select="$idm140055992522592-4/fpml:swbPartyClearingDetails"/><PackageIdentifierNamespace><xsl:value-of select="$idm140055990846496-3/fpml:swbPackageIdentifier/fpml:swbIssuer"/></PackageIdentifierNamespace><PackageIdentifierId><xsl:value-of select="$idm140055990846496-3/fpml:swbPackageIdentifier/fpml:swbTradeId"/></PackageIdentifierId><PackageSize><xsl:value-of select="$idm140055990846496-3/fpml:swbSize"/></PackageSize><PackageCreditParty><xsl:if test="$idm140055990846496-3/fpml:swbPartyCreditAcceptanceToken"><xsl:for-each select="$idm140055990846496-3/fpml:swbPartyCreditAcceptanceToken"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbExecutingBroker/@href"><xsl:value-of select="$idm140055990846496-3/fpml:swbPartyCreditAcceptanceToken/fpml:partyReference/@href"/></xsl:when><xsl:when test="fpml:partyReference/@href = 'partyA'"><xsl:value-of select="$idm140055990846496-3/fpml:swbPartyCreditAcceptanceToken/fpml:partyReference/@href"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></PackageCreditParty><PackageCreditIssuer><xsl:if test="$idm140055990846496-3/fpml:swbPartyCreditAcceptanceToken"><xsl:for-each select="$idm140055990846496-3/fpml:swbPartyCreditAcceptanceToken"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbExecutingBroker/@href"><xsl:value-of select="$idm140055990846496-3/fpml:swbPartyCreditAcceptanceToken/fpml:swbCreditIssuer"/></xsl:when><xsl:when test="fpml:partyReference/@href = 'partyA'"><xsl:value-of select="$idm140055990846496-3/fpml:swbPartyCreditAcceptanceToken/fpml:swbCreditIssuer"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></PackageCreditIssuer><PackageCreditToken><xsl:if test="$idm140055990846496-3/fpml:swbPartyCreditAcceptanceToken"><xsl:for-each select="$idm140055990846496-3/fpml:swbPartyCreditAcceptanceToken"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbExecutingBroker/@href"><xsl:value-of select="$idm140055990846496-3/fpml:swbPartyCreditAcceptanceToken/fpml:swbToken"/></xsl:when><xsl:when test="fpml:partyReference/@href = 'partyA'"><xsl:value-of select="$idm140055990846496-3/fpml:swbPartyCreditAcceptanceToken/fpml:swbToken"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></PackageCreditToken><PackageCreditParty_2><xsl:if test="$idm140055990846496-3/fpml:swbPartyCreditAcceptanceToken"><xsl:for-each select="$idm140055990846496-3/fpml:swbPartyCreditAcceptanceToken"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbClearingClient/@href"><xsl:value-of select="fpml:partyReference/@href"/></xsl:when><xsl:when test="fpml:partyReference/@href = 'partyB'"><xsl:value-of select="fpml:partyReference/@href"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></PackageCreditParty_2><PackageCreditIssuer_2><xsl:if test="$idm140055990846496-3/fpml:swbPartyCreditAcceptanceToken"><xsl:for-each select="$idm140055990846496-3/fpml:swbPartyCreditAcceptanceToken"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbClearingClient/@href"><xsl:value-of select="fpml:swbCreditIssuer"/></xsl:when><xsl:when test="fpml:partyReference/@href = 'partyB'"><xsl:value-of select="fpml:swbCreditIssuer"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></PackageCreditIssuer_2><PackageCreditToken_2><xsl:if test="$idm140055990846496-3/fpml:swbPartyCreditAcceptanceToken"><xsl:for-each select="$idm140055990846496-3/fpml:swbPartyCreditAcceptanceToken"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbClearingClient/@href"><xsl:value-of select="fpml:swbToken"/></xsl:when><xsl:when test="fpml:partyReference/@href = 'partyB'"><xsl:value-of select="fpml:swbToken"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></PackageCreditToken_2></Trade></xsl:template><xsl:template match="fpml:cashSettlementReferenceBanks"><xsl:for-each select="fpml:referenceBank"><xsl:value-of select="fpml:referenceBankId"/><xsl:if test="../fpml:referenceBank[last()]!=.">; </xsl:if></xsl:for-each></xsl:template><xsl:template match="additionalPayment"><xsl:variable name="paymentType" select="string(fpml:paymentType)"/><xsl:choose><xsl:when test="$paymentType='Premium'"><xsl:call-template name="fpml:premium"/></xsl:when><xsl:otherwise><xsl:apply-templates select="."/></xsl:otherwise></xsl:choose></xsl:template><xsl:template match="fpml:businessCenters|fpml:swbExerciseBusinessCenters|fpml:swbValuationBusinessCenters"><xsl:for-each select="fpml:businessCenter"><xsl:apply-templates select="."/><xsl:if test="../fpml:businessCenter[last()]!=.">; </xsl:if></xsl:for-each></xsl:template><xsl:template match="fpml:swbPartyClearingDetails"><PartyClearingDetails><Party><xsl:variable name="party" select="string(fpml:partyReference/@href)"/><xsl:choose><xsl:when test="$party='partyA'">A</xsl:when><xsl:when test="$party='partyB'">B</xsl:when><xsl:otherwise>???</xsl:otherwise></xsl:choose></Party><ClearingStatus><xsl:value-of select="fpml:swbClearingStatus"/></ClearingStatus><ClearingHouseTradeID><xsl:value-of select="fpml:swbClearingHouseTradeID"/></ClearingHouseTradeID><ClearingHouseUpfrontFeeSettlementDate><xsl:value-of select="fpml:swbClearingHouseUpfrontFeeSettlementDate"/></ClearingHouseUpfrontFeeSettlementDate><ClearingHousePreferredISIN><xsl:value-of select="fpml:swbClearingHousePreferredISIN"/></ClearingHousePreferredISIN><ClearedTimestamp><xsl:value-of select="fpml:swbClearedTimestamp"/></ClearedTimestamp><ClearedUSINamespace><xsl:value-of select="fpml:swbClearedUSI/fpml:swbIssuer"/></ClearedUSINamespace><ClearedUSI><xsl:value-of select="fpml:swbClearedUSI/fpml:swbTradeId"/></ClearedUSI><ClearedUTINamespace><xsl:value-of select="fpml:swbClearedUTI/fpml:swbIssuer"/></ClearedUTINamespace><ClearedUTI><xsl:value-of select="fpml:swbClearedUTI/fpml:swbTradeId"/></ClearedUTI></PartyClearingDetails></xsl:template><xsl:template match="fpml:swbRecipient"><Recipient><Id><xsl:value-of select="./@id"/></Id><xsl:variable name="party" select="string(fpml:partyReference/@href)"/><Party><xsl:choose><xsl:when test="$party='partyA'">A</xsl:when><xsl:when test="$party='partyB'">B</xsl:when><xsl:when test="$party='partyC'">C</xsl:when><xsl:when test="$party='partyD'">D</xsl:when><xsl:otherwise>???</xsl:otherwise></xsl:choose></Party><UserName><xsl:value-of select="fpml:swbUserName"/></UserName><TradingBook><xsl:value-of select="fpml:swbTradingBookId"/></TradingBook><ExecutionMode/></Recipient></xsl:template><xsl:template match="fpml:additionalPayment"><xsl:if test="string(fpml:paymentType) != 'CancellablePremium'"><AdditionalPayment><Payer><xsl:variable name="payer" select="string(fpml:payerPartyReference/@href)"/><xsl:choose><xsl:when test="$payer='partyA'">A</xsl:when><xsl:when test="$payer='partyB'">B</xsl:when><xsl:otherwise>???</xsl:otherwise></xsl:choose></Payer><Reason><xsl:value-of select="fpml:paymentType"/></Reason><Currency><xsl:value-of select="fpml:paymentAmount/fpml:currency"/></Currency><Amount><xsl:value-of select="fpml:paymentAmount/fpml:amount"/></Amount><Date><xsl:if test="fpml:paymentDate/fpml:unadjustedDate"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string(fpml:paymentDate/fpml:unadjustedDate)"/></xsl:call-template></xsl:if></Date><Convention><xsl:value-of select="substring(fpml:paymentDate/fpml:dateAdjustments/fpml:businessDayConvention,1,4)"/></Convention><Holidays><xsl:apply-templates select="fpml:paymentDate/fpml:dateAdjustments/fpml:businessCenters"/></Holidays></AdditionalPayment></xsl:if></xsl:template><xsl:template name="formatNotionalSchedule"><xsl:param name="position"/><xsl:param name="leg"/><xsl:variable name="calculation" select="$swapStream[position()=$leg]/fpml:calculationPeriodAmount/fpml:calculation"/><xsl:variable name="notionalStep" select="$calculation/fpml:notionalSchedule/fpml:notionalStepSchedule/fpml:step[position()= $position]"/><xsl:variable name="floatingStep" select="$calculation/fpml:floatingRateCalculation/fpml:spreadSchedule/fpml:step[position()= $position]"/><xsl:variable name="fixedStep" select="$calculation/fpml:fixedRateSchedule/fpml:step[position()= $position]"/><xsl:choose><xsl:when test="$leg=$floatingLeg and $productType!='Fixed Fixed Swap'"><FloatLegNotionalStep><FloatRollDates><xsl:choose><xsl:when test="$notionalStep/fpml:stepDate"><xsl:value-of select="$notionalStep/fpml:stepDate"/></xsl:when><xsl:otherwise><xsl:value-of select="$floatingStep/fpml:stepDate"/></xsl:otherwise></xsl:choose></FloatRollDates><FloatNotionals><xsl:value-of select="$notionalStep/fpml:stepValue"/></FloatNotionals><FloatSpreads><xsl:value-of select="$floatingStep/fpml:stepValue"/></FloatSpreads></FloatLegNotionalStep></xsl:when><xsl:when test="$leg=$floatingLeg2"><FloatLegNotionalStep2><FloatRollDates2><xsl:choose><xsl:when test="$notionalStep/fpml:stepDate"><xsl:value-of select="$notionalStep/fpml:stepDate"/></xsl:when><xsl:otherwise><xsl:value-of select="$floatingStep/fpml:stepDate"/></xsl:otherwise></xsl:choose></FloatRollDates2><FloatNotionals2><xsl:value-of select="$notionalStep/fpml:stepValue"/></FloatNotionals2><FloatSpreads2><xsl:value-of select="$floatingStep/fpml:stepValue"/></FloatSpreads2></FloatLegNotionalStep2></xsl:when><xsl:when test="$leg=$fixedLeg"><FixedLegNotionalStep><FixedPaymentDates><xsl:choose><xsl:when test="$notionalStep/fpml:stepDate"><xsl:value-of select="$notionalStep/fpml:stepDate"/></xsl:when><xsl:otherwise><xsl:value-of select="$fixedStep/fpml:stepDate"/></xsl:otherwise></xsl:choose></FixedPaymentDates><FixedNotionals><xsl:value-of select="$notionalStep/fpml:stepValue"/></FixedNotionals><FixedRates><xsl:value-of select="$fixedStep/fpml:stepValue"/></FixedRates></FixedLegNotionalStep></xsl:when><xsl:when test="$leg=$fixedLeg2"><FixedLegNotionalStep2><FixedPaymentDates2><xsl:choose><xsl:when test="$notionalStep/fpml:stepDate"><xsl:value-of select="$notionalStep/fpml:stepDate"/></xsl:when><xsl:otherwise><xsl:value-of select="$fixedStep/fpml:stepDate"/></xsl:otherwise></xsl:choose></FixedPaymentDates2><FixedNotionals2><xsl:value-of select="$notionalStep/fpml:stepValue"/></FixedNotionals2><FixedRates2><xsl:value-of select="$fixedStep/fpml:stepValue"/></FixedRates2></FixedLegNotionalStep2></xsl:when></xsl:choose></xsl:template><xsl:template name="fpml:premium"/><xsl:template match="fpml:otherPartyPayment"><Brokerage><Payer><xsl:variable name="payer" select="string(fpml:payerPartyReference/@href)"/><xsl:choose><xsl:when test="$payer='partyA'">A</xsl:when><xsl:when test="$payer='partyB'">B</xsl:when><xsl:otherwise>???</xsl:otherwise></xsl:choose></Payer><Currency><xsl:choose><xsl:when test="fpml:paymentAmount/fpml:currency='XXX' and fpml:paymentAmount/fpml:amount='0'"/><xsl:otherwise><xsl:value-of select="fpml:paymentAmount/fpml:currency"/></xsl:otherwise></xsl:choose></Currency><Amount><xsl:choose><xsl:when test="fpml:paymentAmount/fpml:currency='XXX' and fpml:paymentAmount/fpml:amount='0'"/><xsl:otherwise><xsl:value-of select="fpml:paymentAmount/fpml:amount"/></xsl:otherwise></xsl:choose></Amount><Broker><xsl:variable name="version" select="string(/fpml:SWBML/@version)"/><xsl:variable name="broker" select="string(fpml:receiverPartyReference/@href)"/><xsl:value-of select="$idm140055992546864-3/fpml:party[@id=$broker]/fpml:partyId"/></Broker><BrokerTradeId><xsl:variable name="version" select="string(/fpml:SWBML/@version)"/><xsl:variable name="party" select="string(fpml:payerPartyReference/@href)"/><xsl:value-of select="$idm140055992546864-4/fpml:tradeHeader/fpml:partyTradeIdentifier/fpml:partyReference[@href=$party]/../fpml:tradeId"/></BrokerTradeId></Brokerage></xsl:template><xsl:template match="fpml:swbAssociatedFuture"><AssociatedFuture><Party><xsl:variable name="party" select="string(@href)"/><xsl:choose><xsl:when test="$party='partyA'">A</xsl:when><xsl:when test="$party='partyB'">B</xsl:when><xsl:otherwise>???</xsl:otherwise></xsl:choose></Party><AssociatedFutureName><xsl:value-of select="fpml:swbFutureName"/></AssociatedFutureName><AssociatedFutureQuantity><xsl:value-of select="fpml:swbQuantity"/></AssociatedFutureQuantity><AssociatedFutureMaturity><xsl:if test="fpml:swbMaturity"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string(fpml:swbMaturity)"/></xsl:call-template></xsl:if></AssociatedFutureMaturity><AssociatedFutureDescription><xsl:value-of select="fpml:swbDescription"/></AssociatedFutureDescription><AssociatedFuturePrice><xsl:value-of select="fpml:swbPrice"/></AssociatedFuturePrice></AssociatedFuture></xsl:template><xsl:template match="fpml:allocatedNotional"><AllocatedNotional><Currency><xsl:value-of select="fpml:currency"/></Currency><Amount><xsl:value-of select="fpml:amount"/></Amount></AllocatedNotional><AllocatedNumberOfOptions/><AllocatedVegaNotional/><AllocatedVarianceAmount/><AllocatedUnits/></xsl:template><xsl:template match="fpml:swbAllocatedContraNotional"><ContraAmount><xsl:value-of select="fpml:amount"/></ContraAmount></xsl:template><xsl:template match="fpml:swbVariableAmount"><VariableAmount><xsl:value-of select="fpml:amount"/></VariableAmount></xsl:template><xsl:template match="fpml:swbFixedAmount"><ZCAllocAmount><xsl:value-of select="fpml:amount"/></ZCAllocAmount></xsl:template><xsl:template match="fpml:swbContraFixedAmount"><ContraZCAllocAmount><xsl:value-of select="fpml:amount"/></ContraZCAllocAmount></xsl:template><xsl:template match="fpml:independentAmount"><AllocationIndependentAmount><Payer><xsl:value-of select="fpml:payerPartyReference/@href"/></Payer><Currency><xsl:value-of select="fpml:paymentDetail/fpml:paymentAmount/fpml:currency"/></Currency><Amount><xsl:value-of select="fpml:paymentDetail/fpml:paymentAmount/fpml:amount"/></Amount></AllocationIndependentAmount></xsl:template><xsl:template match="fpml:swbAllocation/fpml:otherPartyPayment"><AllocationOtherPartyPayment><Payer><xsl:value-of select="fpml:payerPartyReference/@href"/></Payer><Receiver><xsl:value-of select="fpml:receiverPartyReference/@href"/></Receiver><Currency><xsl:choose><xsl:when test="fpml:paymentAmount/fpml:currency='XXX' and fpml:paymentAmount/fpml:amount='0'"/><xsl:otherwise><xsl:value-of select="fpml:paymentAmount/fpml:currency"/></xsl:otherwise></xsl:choose></Currency><Amount><xsl:choose><xsl:when test="fpml:paymentAmount/fpml:currency='XXX' and fpml:paymentAmount/fpml:amount='0'"/><xsl:otherwise><xsl:value-of select="fpml:paymentAmount/fpml:amount"/></xsl:otherwise></xsl:choose></Amount></AllocationOtherPartyPayment></xsl:template><xsl:template name="fpml:swbAllocations"><xsl:apply-templates select="$idm140055992546864-1/fpml:swbAllocations/fpml:swbAllocation"/></xsl:template><xsl:template match="fpml:swbAllocation"><xsl:variable name="reportingAllocationData.rtf"><xsl:apply-templates select="fpml:swbAllocationReportingDetails/node()" mode="mapReportingData"/></xsl:variable><Allocation><xsl:choose><xsl:when test="$idm140055992546864-1/fpml:swbAllocations/fpml:swbAllocation/fpml:payerPartyReference"><xsl:variable name="PayerRef" select="string(fpml:payerPartyReference/@href)"/><xsl:variable name="ReceiverRef" select="string(fpml:receiverPartyReference/@href)"/><xsl:variable name="PayerBIC" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:party[@id=$PayerRef]/fpml:partyId)"/><xsl:variable name="ReceiverBIC" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:party[@id=$ReceiverRef]/fpml:partyId)"/><Payer><xsl:value-of select="$PayerBIC"/></Payer><Receiver><xsl:value-of select="$ReceiverBIC"/></Receiver></xsl:when><xsl:otherwise><xsl:variable name="BuyerRef" select="string(fpml:buyerPartyReference/@href)"/><xsl:variable name="SellerRef" select="string(fpml:sellerPartyReference/@href)"/><xsl:variable name="BuyerBIC" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:party[@id=$BuyerRef]/fpml:partyId)"/><xsl:variable name="SellerBIC" select="string(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:FpML/fpml:party[@id=$SellerRef]/fpml:partyId)"/><Payer><xsl:value-of select="$BuyerBIC"/></Payer><Receiver><xsl:value-of select="$SellerBIC"/></Receiver></xsl:otherwise></xsl:choose><swbStreamReference><xsl:value-of select="fpml:swbStreamReference/@href"/></swbStreamReference><xsl:apply-templates select="fpml:allocatedNotional"/><xsl:apply-templates select="fpml:swbAllocatedContraNotional"/><xsl:apply-templates select="fpml:swbVariableAmount"/><xsl:apply-templates select="fpml:swbFixedAmount"/><xsl:apply-templates select="fpml:swbContraFixedAmount"/><xsl:apply-templates select="fpml:independentAmount"/><swbBrokerTradeId><xsl:value-of select="fpml:swbBrokerTradeId"/></swbBrokerTradeId><xsl:apply-templates select="fpml:otherPartyPayment"/><AllocationClearingBroker><ClientClearingBroker><xsl:for-each select="fpml:swbPartyClearingBroker"><xsl:if test="fpml:partyReference/@href= /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbClearingClient/@href"><xsl:value-of select="fpml:swbClearingBroker/fpml:partyId"/></xsl:if></xsl:for-each></ClientClearingBroker><EBClearingBroker><xsl:for-each select="fpml:swbPartyClearingBroker"><xsl:if test="fpml:partyReference/@href= /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbExecutingBroker/@href"><xsl:value-of select="fpml:swbClearingBroker/fpml:partyId"/></xsl:if></xsl:for-each></EBClearingBroker></AllocationClearingBroker><AllocationPartyAClearingBroker><xsl:if test="fpml:swbPartyClearingBroker"><xsl:for-each select="fpml:swbPartyClearingBroker"><xsl:choose><xsl:when test="fpml:partyReference/@href = 'partyA'"><xsl:value-of select="fpml:swbClearingBroker/fpml:partyId"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></AllocationPartyAClearingBroker><AllocationPartyBClearingBroker><xsl:if test="fpml:swbPartyClearingBroker"><xsl:for-each select="fpml:swbPartyClearingBroker"><xsl:choose><xsl:when test="fpml:partyReference/@href = 'partyB'"><xsl:value-of select="fpml:swbClearingBroker/fpml:partyId"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></AllocationPartyBClearingBroker><AllocationPayerClearingBroker><xsl:if test="fpml:swbPartyClearingBroker"><xsl:for-each select="fpml:swbPartyClearingBroker"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbAllocations/fpml:swbAllocation/fpml:buyerPartyReference/@href"><xsl:value-of select="fpml:swbClearingBroker/fpml:partyId"/></xsl:when><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbAllocations/fpml:swbAllocation/fpml:payerPartyReference/@href"><xsl:value-of select="fpml:swbClearingBroker/fpml:partyId"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></AllocationPayerClearingBroker><AllocationReceiverClearingBroker><xsl:if test="fpml:swbPartyClearingBroker"><xsl:for-each select="fpml:swbPartyClearingBroker"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbAllocations/fpml:swbAllocation/fpml:sellerPartyReference/@href"><xsl:value-of select="fpml:swbClearingBroker/fpml:partyId"/></xsl:when><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbAllocations/fpml:swbAllocation/fpml:receiverPartyReference/@href"><xsl:value-of select="fpml:swbClearingBroker/fpml:partyId"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></AllocationReceiverClearingBroker><AllocationNettingParty><xsl:if test="fpml:swbPartyNettingString"><xsl:for-each select="fpml:swbPartyNettingString"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbAllocations/fpml:swbAllocation/fpml:buyerPartyReference/@href"><xsl:variable name="NettingParty" select="string(fpml:partyReference/@href)"/><xsl:value-of select="$idm140055992546864-3//fpml:party[@id=$NettingParty]/fpml:partyId"/></xsl:when><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbAllocations/fpml:swbAllocation/fpml:payerPartyReference/@href"><xsl:variable name="NettingParty" select="string(fpml:partyReference/@href)"/><xsl:value-of select="$idm140055992546864-3//fpml:party[@id=$NettingParty]/fpml:partyId"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></AllocationNettingParty><AllocationNettingString><xsl:if test="fpml:swbPartyNettingString"><xsl:for-each select="fpml:swbPartyNettingString"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbAllocations/fpml:swbAllocation/fpml:buyerPartyReference/@href"><xsl:value-of select="fpml:swbNettingString"/></xsl:when><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbAllocations/fpml:swbAllocation/fpml:payerPartyReference/@href"><xsl:value-of select="fpml:swbNettingString"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></AllocationNettingString><AllocationNettingParty_2><xsl:if test="fpml:swbPartyNettingString"><xsl:for-each select="fpml:swbPartyNettingString"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbAllocations/fpml:swbAllocation/fpml:sellerPartyReference/@href"><xsl:variable name="NettingParty2" select="string(fpml:partyReference/@href)"/><xsl:value-of select="$idm140055992546864-3//fpml:party[@id=$NettingParty2]/fpml:partyId"/></xsl:when><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbAllocations/fpml:swbAllocation/fpml:receiverPartyReference/@href"><xsl:variable name="NettingParty2" select="string(fpml:partyReference/@href)"/><xsl:value-of select="$idm140055992546864-3//fpml:party[@id=$NettingParty2]/fpml:partyId"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></AllocationNettingParty_2><AllocationNettingString_2><xsl:if test="fpml:swbPartyNettingString"><xsl:for-each select="fpml:swbPartyNettingString"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbAllocations/fpml:swbAllocation/fpml:sellerPartyReference/@href"><xsl:value-of select="fpml:swbNettingString"/></xsl:when><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbAllocations/fpml:swbAllocation/fpml:receiverPartyReference/@href"><xsl:value-of select="fpml:swbNettingString"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></AllocationNettingString_2><AllocationCreditAcceptanceParty><xsl:if test="fpml:swbPartyCreditAcceptanceToken"><xsl:for-each select="fpml:swbPartyCreditAcceptanceToken"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbAllocations/fpml:swbAllocation/fpml:buyerPartyReference/@href"><xsl:variable name="CreditAcceptanceParty" select="string(fpml:partyReference/@href)"/><xsl:value-of select="$idm140055992546864-3//fpml:party[@id=$CreditAcceptanceParty]/fpml:partyId"/></xsl:when><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbAllocations/fpml:swbAllocation/fpml:payerPartyReference/@href"><xsl:variable name="CreditAcceptanceParty" select="string(fpml:partyReference/@href)"/><xsl:value-of select="$idm140055992546864-3//fpml:party[@id=$CreditAcceptanceParty]/fpml:partyId"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></AllocationCreditAcceptanceParty><AllocationCreditAcceptanceIssuer><xsl:if test="fpml:swbPartyCreditAcceptanceToken"><xsl:for-each select="fpml:swbPartyCreditAcceptanceToken"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbAllocations/fpml:swbAllocation/fpml:buyerPartyReference/@href"><xsl:value-of select="fpml:swbCreditIssuer"/></xsl:when><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbAllocations/fpml:swbAllocation/fpml:payerPartyReference/@href"><xsl:value-of select="fpml:swbCreditIssuer"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></AllocationCreditAcceptanceIssuer><AllocationCreditAcceptanceToken><xsl:if test="fpml:swbPartyCreditAcceptanceToken"><xsl:for-each select="fpml:swbPartyCreditAcceptanceToken"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbAllocations/fpml:swbAllocation/fpml:buyerPartyReference/@href"><xsl:value-of select="fpml:swbToken"/></xsl:when><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbAllocations/fpml:swbAllocation/fpml:payerPartyReference/@href"><xsl:value-of select="fpml:swbToken"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></AllocationCreditAcceptanceToken><AllocationCreditAcceptanceParty_2><xsl:if test="fpml:swbPartyCreditAcceptanceToken"><xsl:for-each select="fpml:swbPartyCreditAcceptanceToken"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbAllocations/fpml:swbAllocation/fpml:sellerPartyReference/@href"><xsl:variable name="CreditAcceptanceParty2" select="string(fpml:partyReference/@href)"/><xsl:value-of select="$idm140055992546864-3//fpml:party[@id=$CreditAcceptanceParty2]/fpml:partyId"/></xsl:when><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbAllocations/fpml:swbAllocation/fpml:receiverPartyReference/@href"><xsl:variable name="CreditAcceptanceParty2" select="string(fpml:partyReference/@href)"/><xsl:value-of select="$idm140055992546864-3//fpml:party[@id=$CreditAcceptanceParty2]/fpml:partyId"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></AllocationCreditAcceptanceParty_2><AllocationCreditAcceptanceIssuer_2><xsl:if test="fpml:swbPartyCreditAcceptanceToken"><xsl:for-each select="fpml:swbPartyCreditAcceptanceToken"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbAllocations/fpml:swbAllocation/fpml:sellerPartyReference/@href"><xsl:value-of select="fpml:swbCreditIssuer"/></xsl:when><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbAllocations/fpml:swbAllocation/fpml:receiverPartyReference/@href"><xsl:value-of select="fpml:swbCreditIssuer"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></AllocationCreditAcceptanceIssuer_2><AllocationCreditAcceptanceToken_2><xsl:if test="fpml:swbPartyCreditAcceptanceToken"><xsl:for-each select="fpml:swbPartyCreditAcceptanceToken"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbAllocations/fpml:swbAllocation/fpml:sellerPartyReference/@href"><xsl:value-of select="fpml:swbToken"/></xsl:when><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbAllocations/fpml:swbAllocation/fpml:receiverPartyReference/@href"><xsl:value-of select="fpml:swbToken"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></AllocationCreditAcceptanceToken_2><xsl:apply-templates select="$idm140055992546864-1/fpml:swbAllocations/fpml:swbAllocation/fpml:swbPartyClearingDetails"/><xsl:choose><xsl:when test="function-available('common:node-set')"><xsl:call-template name="outputAllocationReportingFields"><xsl:with-param name="reportingAllocationData" select="common:node-set($reportingAllocationData.rtf)"/><xsl:with-param name="partyIdentifiers" select="common:node-set($partyIdentifiers.rtf)"/></xsl:call-template></xsl:when><xsl:otherwise><xsl:call-template name="outputAllocationReportingFields"><xsl:with-param name="reportingAllocationData" select="$reportingAllocationData.rtf"/><xsl:with-param name="partyIdentifiers" select="$partyIdentifiers.rtf"/></xsl:call-template></xsl:otherwise></xsl:choose></Allocation></xsl:template><xsl:template name="formatDate"><xsl:param name="date"/><xsl:variable name="month" select="string(substring($date,6,2))"/><xsl:value-of select="substring($date,9,2)"/>-<xsl:choose><xsl:when test="$month='01'">Jan</xsl:when><xsl:when test="$month='02'">Feb</xsl:when><xsl:when test="$month='03'">Mar</xsl:when><xsl:when test="$month='04'">Apr</xsl:when><xsl:when test="$month='05'">May</xsl:when><xsl:when test="$month='06'">Jun</xsl:when><xsl:when test="$month='07'">Jul</xsl:when><xsl:when test="$month='08'">Aug</xsl:when><xsl:when test="$month='09'">Sep</xsl:when><xsl:when test="$month='10'">Oct</xsl:when><xsl:when test="$month='11'">Nov</xsl:when><xsl:when test="$month='12'">Dec</xsl:when><xsl:otherwise>???</xsl:otherwise></xsl:choose>-<xsl:value-of select="substring($date,1,4)"/></xsl:template><xsl:template name="formatTime"><xsl:param name="time"/><xsl:choose><xsl:when test="$time='00:00:00'">12midnight</xsl:when><xsl:when test="$time='01:00:00'">1am</xsl:when><xsl:when test="$time='02:00:00'">2am</xsl:when><xsl:when test="$time='03:00:00'">3am</xsl:when><xsl:when test="$time='04:00:00'">4am</xsl:when><xsl:when test="$time='05:00:00'">5am</xsl:when><xsl:when test="$time='06:00:00'">6am</xsl:when><xsl:when test="$time='07:00:00'">7am</xsl:when><xsl:when test="$time='08:00:00'">8am</xsl:when><xsl:when test="$time='09:00:00'">9am</xsl:when><xsl:when test="$time='09:30:00'">9:30am</xsl:when><xsl:when test="$time='09:55:00'">9:55am</xsl:when><xsl:when test="$time='10:00:00'">10am</xsl:when><xsl:when test="$time='10:30:00'">10:30am</xsl:when><xsl:when test="$time='11:00:00'">11am</xsl:when><xsl:when test="$time='11:10:00'">11:10am</xsl:when><xsl:when test="$time='11:15:00'">11:15am</xsl:when><xsl:when test="$time='11:30:00'">11:30am</xsl:when><xsl:when test="$time='11:40:00'">11:40am</xsl:when><xsl:when test="$time='12:00:00'">12noon</xsl:when><xsl:when test="$time='12:10:00'">12:10pm</xsl:when><xsl:when test="$time='12:15:00'">12:15pm</xsl:when><xsl:when test="$time='12:30:00'">12:30pm</xsl:when><xsl:when test="$time='12:40:00'">12:40pm</xsl:when><xsl:when test="$time='13:00:00'">1pm</xsl:when><xsl:when test="$time='13:15:00'">1:15pm</xsl:when><xsl:when test="$time='13:30:00'">1:30pm</xsl:when><xsl:when test="$time='14:00:00'">2pm</xsl:when><xsl:when test="$time='14:15:00'">2:15pm</xsl:when><xsl:when test="$time='14:30:00'">2:30pm</xsl:when><xsl:when test="$time='15:00:00'">3pm</xsl:when><xsl:when test="$time='15:15:00'">3:15pm</xsl:when><xsl:when test="$time='15:30:00'">3:30pm</xsl:when><xsl:when test="$time='16:00:00'">4pm</xsl:when><xsl:when test="$time='16:30:00'">4:30pm</xsl:when><xsl:when test="$time='17:00:00'">5pm</xsl:when><xsl:when test="$time='18:00:00'">6pm</xsl:when><xsl:when test="$time='19:00:00'">7pm</xsl:when><xsl:when test="$time='20:00:00'">8pm</xsl:when><xsl:when test="$time='21:00:00'">9pm</xsl:when><xsl:when test="$time='22:00:00'">10pm</xsl:when><xsl:when test="$time='23:00:00'">11pm</xsl:when><xsl:otherwise>???</xsl:otherwise></xsl:choose></xsl:template><xsl:template match="fpml:documentation"><xsl:for-each select="fpml:contractualDefinitions"><xsl:apply-templates select="."/><xsl:if test="../fpml:contractualDefinitions[last()]!=.">; </xsl:if></xsl:for-each></xsl:template></xsl:stylesheet>