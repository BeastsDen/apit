<?xml version="1.0"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:fpml="http://www.fpml.org/2009/FpML-4-6" xmlns:common="http://exslt.org/common" xmlns:mwrpt="http://www.markitserv.com/swbml-extract-reporting.xsl" exclude-result-prefixes="fpml common mwrpt" version="1.0"><xsl:import href="swbml-extract-reporting.xsl"/><xsl:output method="xml"/><xsl:variable name="SWBML" select="//fpml:SWBML"/><xsl:variable name="swbHeader" select="$SWBML/fpml:swbHeader"/><xsl:variable name="isPrimeBrokered"><xsl:choose><xsl:when test="$idm140092017975088-1/fpml:swbGiveUp">1</xsl:when><xsl:otherwise>0</xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="partyA"><xsl:choose><xsl:when test="$idm140092017972096-4/fpml:commodityForward/fpml:fixedLeg/fpml:payerPartyReference"><xsl:value-of select="$idm140092017972096-4/fpml:commodityForward/fpml:fixedLeg/fpml:payerPartyReference/@href"/></xsl:when><xsl:when test="$idm140092017972096-4/fpml:commodityOption/fpml:buyerPartyReference"><xsl:value-of select="$idm140092017972096-4/fpml:commodityOption/fpml:buyerPartyReference/@href"/></xsl:when><xsl:when test="$idm140092017968736-5/fpml:floatingLeg[@id='floatingLeg1']/fpml:payerPartyReference"><xsl:value-of select="$idm140092017968736-5/fpml:floatingLeg[@id='floatingLeg1']/fpml:payerPartyReference/@href"/></xsl:when><xsl:when test="$idm140092017968736-5/fpml:fixedLeg/fpml:payerPartyReference"><xsl:value-of select="$idm140092017968736-5/fpml:fixedLeg/fpml:payerPartyReference/@href"/></xsl:when><xsl:when test="boolean($swbHeader/fpml:swbRecipient[1]/fpml:partyReference/@href)"><xsl:value-of select="$swbHeader/fpml:swbRecipient[1]/fpml:partyReference/@href"/></xsl:when><xsl:otherwise>partyA</xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="partyB"><xsl:choose><xsl:when test="$idm140092017972096-4/fpml:commodityForward/fpml:bullionPhysicalLeg/fpml:payerPartyReference"><xsl:value-of select="$idm140092017972096-4/fpml:commodityForward/fpml:bullionPhysicalLeg/fpml:payerPartyReference/@href"/></xsl:when><xsl:when test="$idm140092017968736-5/fpml:gasPhysicalLeg/fpml:payerPartyReference"><xsl:value-of select="$idm140092017968736-5/fpml:gasPhysicalLeg/fpml:payerPartyReference/@href"/></xsl:when><xsl:when test="$idm140092017968736-5/fpml:electricityPhysicalLeg/fpml:payerPartyReference"><xsl:value-of select="$idm140092017968736-5/fpml:electricityPhysicalLeg/fpml:payerPartyReference/@href"/></xsl:when><xsl:when test="$idm140092017972096-4/fpml:commodityOption/fpml:sellerPartyReference"><xsl:value-of select="$idm140092017972096-4/fpml:commodityOption/fpml:sellerPartyReference/@href"/></xsl:when><xsl:when test="$idm140092017968736-5/fpml:floatingLeg[@id='floatingLeg2']/fpml:payerPartyReference"><xsl:value-of select="$idm140092017968736-5/fpml:floatingLeg[@id='floatingLeg2']/fpml:payerPartyReference/@href"/></xsl:when><xsl:when test="$idm140092017968736-5/fpml:floatingLeg[@id='floatingLeg']/fpml:payerPartyReference"><xsl:value-of select="$idm140092017968736-5/fpml:floatingLeg[@id='floatingLeg']/fpml:payerPartyReference/@href"/></xsl:when><xsl:when test="boolean($swbHeader/fpml:swbRecipient[2]/fpml:partyReference/@href)"><xsl:value-of select="$swbHeader/fpml:swbRecipient[2]/fpml:partyReference/@href"/></xsl:when><xsl:otherwise>partyB</xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="reportingData.rtf"><xsl:apply-templates select="$idm140092017975088-1/fpml:swbTradeEventReportingDetails/node()" mode="mapReportingData"/></xsl:variable><xsl:variable name="brokerPrivateData.rtf"><xsl:variable name="broker1"><xsl:choose><xsl:when test="$idm140092017972096-4/fpml:otherPartyPayment[1]/fpml:receiverPartyReference"><xsl:value-of select="$idm140092017972096-4/fpml:otherPartyPayment[1]/fpml:receiverPartyReference/@href"/></xsl:when><xsl:otherwise>broker1</xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="broker2"><xsl:choose><xsl:when test="$idm140092017972096-4/fpml:otherPartyPayment[2]/fpml:receiverPartyReference"><xsl:value-of select="$idm140092017972096-4/fpml:otherPartyPayment[2]/fpml:receiverPartyReference/@href"/></xsl:when><xsl:otherwise>broker2</xsl:otherwise></xsl:choose></xsl:variable><xsl:choose><xsl:when test="$idm140092017975088-1/fpml:swbPrivatePartyTradeEventReportingDetails[fpml:swbPartyReference/@href=$broker1]"><xsl:apply-templates select="$idm140092017975088-1/fpml:swbPrivatePartyTradeEventReportingDetails[fpml:swbPartyReference/@href=$broker1]/node()" mode="mapReportingData"/></xsl:when><xsl:when test="$idm140092017975088-1/fpml:swbPrivatePartyTradeEventReportingDetails[fpml:swbPartyReference/@href=$broker2]"><xsl:apply-templates select="$idm140092017975088-1/fpml:swbPrivatePartyTradeEventReportingDetails[fpml:swbPartyReference/@href=$broker2]/node()" mode="mapReportingData"/></xsl:when><xsl:when test="$idm140092017975088-1/fpml:swbPrivatePartyTradeEventReportingDetails[fpml:swbPartyReference/@href='broker']"><xsl:apply-templates select="$idm140092017975088-1/fpml:swbPrivatePartyTradeEventReportingDetails[fpml:swbPartyReference/@href='broker']/node()" mode="mapReportingData"/></xsl:when><xsl:otherwise><xsl:apply-templates select="$idm140092017975088-1/fpml:swbPrivatePartyTradeEventReportingDetails/node()" mode="mapReportingData"/></xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="partyAPrivateData.rtf"><xsl:choose><xsl:when test="$idm140092017975088-1/fpml:swbPrivatePartyTradeEventReportingDetails[fpml:swbPartyReference/@href=$partyA]"><xsl:apply-templates select="$idm140092017975088-1/fpml:swbPrivatePartyTradeEventReportingDetails[fpml:swbPartyReference/@href=$partyA]/node()" mode="mapReportingData"/></xsl:when><xsl:otherwise><xsl:apply-templates select="$idm140092017975088-1/fpml:swbPrivatePartyTradeEventReportingDetails/node()" mode="mapReportingData"/></xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="partyBPrivateData.rtf"><xsl:choose><xsl:when test="$idm140092017975088-1/fpml:swbPrivatePartyTradeEventReportingDetails[fpml:swbPartyReference/@href=$partyB]"><xsl:apply-templates select="$idm140092017975088-1/fpml:swbPrivatePartyTradeEventReportingDetails[fpml:swbPartyReference/@href=$partyB]/node()" mode="mapReportingData"/></xsl:when><xsl:otherwise><xsl:apply-templates select="$idm140092017975088-1/fpml:swbPrivatePartyTradeEventReportingDetails/node()" mode="mapReportingData"/></xsl:otherwise></xsl:choose></xsl:variable><xsl:variable name="extendedTradeDetails.rtf"><xsl:apply-templates select="$idm140092017926592-3/node()" mode="mapReportingData"/></xsl:variable><xsl:variable name="partyIdentifiers.rtf"><xsl:apply-templates select="$idm140092017972096-3/node()" mode="mapReportingData"/></xsl:variable><xsl:variable name="idm140092017975088-1" select="/fpml:SWBML"/><xsl:variable name="idm140092017972096-2" select="$idm140092017975088-1/fpml:swbStructuredTradeDetails"/><xsl:variable name="idm140092017972096-3" select="$idm140092017972096-2/fpml:FpML"/><xsl:variable name="idm140092017926592-3" select="$idm140092017972096-2/fpml:swbExtendedTradeDetails"/><xsl:variable name="idm140092017972096-4" select="$idm140092017972096-3/fpml:trade"/><xsl:variable name="idm140092017587136-4" select="$idm140092017926592-3/fpml:swbTradeHeader"/><xsl:variable name="idm140092017968736-5" select="$idm140092017972096-4/fpml:commoditySwap"/><xsl:template match="/|comment()|processing-instruction()" mode="mapReportingData"><xsl:copy><xsl:apply-templates mode="mapReportingData"/></xsl:copy></xsl:template><xsl:template match="*" mode="mapReportingData"><xsl:element name="{local-name()}"><xsl:apply-templates select="@*|node()" mode="mapReportingData"/></xsl:element></xsl:template><xsl:template match="@*" mode="mapReportingData"><xsl:attribute name="{local-name()}"><xsl:value-of select="."/></xsl:attribute></xsl:template><xsl:template match="/"><xsl:apply-templates select="fpml:SWBML" mode="get-reporting-data"/></xsl:template><xsl:template match="/fpml:SWBML[function-available('common:node-set')]" mode="get-reporting-data"><xsl:apply-templates select="."><xsl:with-param name="reportingData" select="common:node-set($reportingData.rtf)"/><xsl:with-param name="brokerPrivateData" select="common:node-set($brokerPrivateData.rtf)"/><xsl:with-param name="partyAPrivateData" select="common:node-set($partyAPrivateData.rtf)"/><xsl:with-param name="partyBPrivateData" select="common:node-set($partyBPrivateData.rtf)"/><xsl:with-param name="extendedTradeDetails" select="common:node-set($extendedTradeDetails.rtf)"/></xsl:apply-templates></xsl:template><xsl:template match="/fpml:SWBML[not(function-available('common:node-set'))]" mode="get-reporting-data"><xsl:apply-templates select="."><xsl:with-param name="reportingData" select="$reportingData.rtf"/><xsl:with-param name="brokerPrivateData" select="$brokerPrivateData.rtf"/><xsl:with-param name="partyAPrivateData" select="$partyAPrivateData.rtf"/><xsl:with-param name="partyBPrivateData" select="$partyBPrivateData.rtf"/><xsl:with-param name="extendedTradeDetails" select="$extendedTradeDetails.rtf"/></xsl:apply-templates></xsl:template><xsl:template match="fpml:SWBML"><xsl:param name="reportingData"/><xsl:param name="brokerPrivateData"/><xsl:param name="partyAPrivateData"/><xsl:param name="partyBPrivateData"/><xsl:param name="extendedTradeDetails"/><xsl:variable name="reportingAllocationData.rtf"><xsl:apply-templates select="fpml:swbAllocationReportingDetails/node()" mode="mapReportingData"/></xsl:variable><Trade version="4-6"><SWBMLVersion><xsl:value-of select="@version"/></SWBMLVersion><xsl:variable name="productType" select="string(fpml:swbStructuredTradeDetails/fpml:swbProductType)"/><BrokerSubmitted>true</BrokerSubmitted><BrokerTradeId><xsl:value-of select="fpml:swbHeader/fpml:swbBrokerTradeId"/></BrokerTradeId><TotalLegs/><BrokerLegId><xsl:value-of select="fpml:swbHeader/fpml:swbBrokerLegId"/></BrokerLegId><ReplacementTradeId/><ReplacementTradeIdType/><ReplacementReason/><StrategyType/><StrategyComment/><BrokerTradeVersionId><xsl:value-of select="fpml:swbHeader/fpml:swbBrokerTradeVersionId"/></BrokerTradeVersionId><LinkedTradeId/><TradeSource><xsl:choose><xsl:when test="fpml:swbHeader/fpml:swbTradeSource"><xsl:value-of select="fpml:swbHeader/fpml:swbTradeSource"/></xsl:when><xsl:otherwise>Voice</xsl:otherwise></xsl:choose></TradeSource><xsl:for-each select="$idm140092017975088-1/fpml:swbHeader/fpml:swbVenueId"><VenueId><xsl:value-of select="."/></VenueId><xsl:for-each select="@swbVenueIdScheme"><xsl:call-template name="mwrpt:mapVenueIdScheme"/></xsl:for-each></xsl:for-each><MessageText><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbMessageText"/></MessageText><AllocatedTrade/><Allocation><Payer/><Receiver/><swbStreamReference/><AllocatedNotional><Currency/><Amount/></AllocatedNotional><AllocatedNumberOfOptions/><AllocatedVegaNotional/><AllocatedVarianceAmount/><AllocatedUnits/><AllocationIndependentAmount><Payer/><Currency/><Amount/></AllocationIndependentAmount><swbBrokerTradeId/><AllocationOtherPartyPayment><Payer/><Receiver/><Currency/><Amount/></AllocationOtherPartyPayment><AllocationClearingBroker><ClientClearingBroker><xsl:for-each select="fpml:swbPartyClearingBroker"><xsl:if test="fpml:partyReference/@href= /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbClearingClient/@href"><xsl:value-of select="fpml:swbClearingBroker/fpml:partyId"/></xsl:if></xsl:for-each></ClientClearingBroker><EBClearingBroker><xsl:for-each select="fpml:swbPartyClearingBroker"><xsl:if test="fpml:partyReference/@href= /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbExecutingBroker/@href"><xsl:value-of select="fpml:swbClearingBroker/fpml:partyId"/></xsl:if></xsl:for-each></EBClearingBroker></AllocationClearingBroker><AllocationPartyAClearingBroker><xsl:if test="fpml:swbPartyClearingBroker"><xsl:for-each select="fpml:swbPartyClearingBroker"><xsl:choose><xsl:when test="fpml:partyReference/@href = 'partyA'"><xsl:value-of select="fpml:swbClearingBroker/fpml:partyId"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></AllocationPartyAClearingBroker><AllocationPartyBClearingBroker><xsl:if test="fpml:swbPartyClearingBroker"><xsl:for-each select="fpml:swbPartyClearingBroker"><xsl:choose><xsl:when test="fpml:partyReference/@href = 'partyB'"><xsl:value-of select="fpml:swbClearingBroker/fpml:partyId"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></AllocationPartyBClearingBroker><AllocationPayerClearingBroker><xsl:if test="fpml:swbPartyClearingBroker"><xsl:for-each select="fpml:swbPartyClearingBroker"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbAllocations/fpml:swbAllocation/fpml:buyerPartyReference/@href"><xsl:value-of select="fpml:swbClearingBroker/fpml:partyId"/></xsl:when><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbAllocations/fpml:swbAllocation/fpml:payerPartyReference/@href"><xsl:value-of select="fpml:swbClearingBroker/fpml:partyId"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></AllocationPayerClearingBroker><AllocationReceiverClearingBroker><xsl:if test="fpml:swbPartyClearingBroker"><xsl:for-each select="fpml:swbPartyClearingBroker"><xsl:choose><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbAllocations/fpml:swbAllocation/fpml:sellerPartyReference/@href"><xsl:value-of select="fpml:swbClearingBroker/fpml:partyId"/></xsl:when><xsl:when test="fpml:partyReference/@href = /fpml:SWBML/fpml:swbAllocations/fpml:swbAllocation/fpml:receiverPartyReference/@href"><xsl:value-of select="fpml:swbClearingBroker/fpml:partyId"/></xsl:when></xsl:choose></xsl:for-each></xsl:if></AllocationReceiverClearingBroker><AllocationNettingParty/><AllocationNettingString/><AllocationNettingParty_2/><AllocationNettingString_2/><xsl:apply-templates select="$idm140092017975088-1/fpml:swbAllocations/fpml:swbAllocation/fpml:swbPartyClearingDetails"/><xsl:choose><xsl:when test="function-available('common:node-set')"><xsl:call-template name="outputAllocationReportingFields"><xsl:with-param name="reportingAllocationData" select="common:node-set($reportingAllocationData.rtf)"/><xsl:with-param name="partyIdentifiers" select="common:node-set($partyIdentifiers.rtf)"/></xsl:call-template></xsl:when><xsl:otherwise><xsl:call-template name="outputAllocationReportingFields"><xsl:with-param name="reportingAllocationData" select="$reportingAllocationData.rtf"/><xsl:with-param name="partyIdentifiers" select="$partyIdentifiers.rtf"/></xsl:call-template></xsl:otherwise></xsl:choose></Allocation><EmptyBlockTrade/><PrimeBrokerTrade/><ReversePrimeBrokerLegalEntities/><xsl:apply-templates select="fpml:swbHeader/fpml:swbRecipient"/><PartyAId><xsl:attribute name="id"><xsl:value-of select="$partyA"/></xsl:attribute><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:party[@id=$partyA]/fpml:partyId"/></PartyAId><PartyAIdType><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:party[@id=$partyA]/fpml:partyId/@partyIdScheme"/></PartyAIdType><PartyAName><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:party[@id=$partyA]/fpml:partyName"/></PartyAName><PartyBId><xsl:attribute name="id"><xsl:value-of select="$partyB"/></xsl:attribute><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:party[@id=$partyB]/fpml:partyId"/></PartyBId><PartyBIdType><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:party[@id=$partyB]/fpml:partyId/@partyIdScheme"/></PartyBIdType><PartyBName><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:party[@id=$partyB]/fpml:partyName"/></PartyBName><PartyCId/><PartyCIdType/><PartyCName/><PartyDId/><PartyDIdType/><PartyDName/><PartyGId/><PartyGIdType/><PartyGName/><BrokerAId><xsl:variable name="broker1" select="$idm140092017972096-4/fpml:otherPartyPayment[1]/fpml:receiverPartyReference/@href"/><xsl:attribute name="id"><xsl:value-of select="$broker1"/></xsl:attribute><xsl:value-of select="$idm140092017972096-3/fpml:party[@id=$broker1]/fpml:partyId"/></BrokerAId><BrokerBId><xsl:variable name="broker2" select="$idm140092017972096-4/fpml:otherPartyPayment[2]/fpml:receiverPartyReference/@href"/><xsl:attribute name="id"><xsl:value-of select="$broker2"/></xsl:attribute><xsl:value-of select="$idm140092017972096-3/fpml:party[@id=$broker2]/fpml:partyId"/></BrokerBId><NominalTerm/><FixedRatePayer>A</FixedRatePayer><FloatingRatePayer/><TradeDate><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string(fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:tradeHeader/fpml:tradeDate)"/></xsl:call-template></TradeDate><StartDate><xsl:call-template name="formatDate"><xsl:with-param name="date"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:effectiveDate/fpml:adjustableDate/fpml:unadjustedDate"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:effectiveDate/fpml:adjustableDate/fpml:unadjustedDate"/></xsl:with-param></xsl:call-template></StartDate><FirstFixedPeriodStartDate/><FirstFloatPeriodStartDate/><FirstFloatPeriodStartDate_2/><EndDate><xsl:call-template name="formatDate"><xsl:with-param name="date"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:exercise/fpml:europeanExercise/fpml:expirationDate/fpml:adjustableDate/fpml:unadjustedDate"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:terminationDate/fpml:adjustableDate/fpml:unadjustedDate"/></xsl:with-param></xsl:call-template></EndDate><FixedPaymentFreq/><FloatPaymentFreq/><FloatPaymentFreq_2/><FloatRollFreq/><FloatRollFreq_2/><RollsType/><RollsMethod/><RollDay/><MonthEndRolls/><FirstPeriodStartDate/><FirstPaymentDate/><LastRegularPaymentDate/><FixedRate><xsl:choose><xsl:when test="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:fixedLeg/fpml:fixedPriceSchedule"><xsl:apply-templates select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:fixedLeg/fpml:fixedPriceSchedule/fpml:fixedPriceStep"/><xsl:apply-templates select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:fixedLeg/fpml:fixedPriceSchedule/fpml:settlementPeriodsPriceSchedule/fpml:settlementPeriodsPriceStep"/><xsl:apply-templates select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:fixedLeg/fpml:fixedPriceSchedule/fpml:worldscaleRateStep"/><xsl:apply-templates select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:fixedLeg/fpml:fixedPriceSchedule/fpml:contractRateStep"/></xsl:when><xsl:otherwise><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityForward/fpml:fixedLeg/fpml:fixedPrice/fpml:price"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:fixedLeg/fpml:fixedPrice/fpml:price"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:fixedLeg/fpml:settlementPeriodsPrice/fpml:price"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:fixedLeg/fpml:contractRate/fpml:amount"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:fixedLeg/fpml:worldscaleRate"/></xsl:otherwise></xsl:choose></FixedRate><initialPoints/><quotationStyle/><RecoveryRate/><FixedSettlement/><Strike><xsl:choose><xsl:when test="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:strikePricePerUnitSchedule"><xsl:for-each select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:strikePricePerUnitSchedule/fpml:strikePricePerUnitStep"><xsl:value-of select="fpml:amount"/><xsl:if test="position()!=count(../fpml:strikePricePerUnitStep)">; </xsl:if></xsl:for-each></xsl:when><xsl:otherwise><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:strikePricePerUnit/fpml:amount"/></xsl:otherwise></xsl:choose></Strike><StrikePercentage/><StrikeDate/><Currency><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityForward/fpml:fixedLeg/fpml:fixedPrice/fpml:priceCurrency"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:exercise/fpml:settlementCurrency"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:settlementCurrency"/></Currency><Currency_2/><Notional><xsl:choose><xsl:when test="$productType='Commodity Option'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:totalNotionalQuantity"/></xsl:when><xsl:when test="$productType='Commodity Swap'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg']/fpml:totalNotionalQuantity"/></xsl:when><xsl:when test="$productType='Commodity Spread'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:totalNotionalQuantity"/></xsl:when><xsl:when test="$productType='Commodity Forward'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:gasPhysicalLeg/fpml:deliveryQuantity/fpml:totalPhysicalQuantity/fpml:quantity"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:electricityPhysicalLeg/fpml:deliveryQuantity/fpml:totalPhysicalQuantity/fpml:quantity"/></xsl:when><xsl:otherwise>???</xsl:otherwise></xsl:choose></Notional><Notional_2><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:totalNotionalQuantity"/></Notional_2><InitialNotional/><FixedAmount/><FixedAmountCurrency/><FixedDayBasis/><FloatDayBasis/><FloatDayBasis_2/><FixedConvention/><FixedCalcPeriodDatesConvention/><FixedTerminationDateConvention/><FloatConvention/><FloatCalcPeriodDatesConvention/><FloatTerminationDateConvention/><FloatConvention_2/><FloatTerminationDateConvention_2/><FloatingRateIndex/><FloatingRateIndex_2/><InflationLag/><IndexSource/><InterpolationMethod/><InitialIndexLevel/><RelatedBond/><IndexTenor1/><LinearInterpolation/><NoStubLinearInterpolation/><NoStubLinearInterpolation2/><IndexTenor2/><SpreadOverIndex/><SpreadOverIndex_2/><FirstFixingRate/><FirstFixingRate_2/><FixingDaysOffset/><FixingDaysOffset_2/><FixingHolidayCentres/><FixingHolidayCentres_2/><ResetInArrears/><ResetInArrears_2/><FirstFixingDifferent/><FirstFixingDifferent_2/><FirstFixingDaysOffset/><FirstFixingDaysOffset_2/><FirstFixingHolidayCentres/><FirstFixingHolidayCentres_2/><PaymentHolidayCentres><xsl:choose><xsl:when test="$productType='Commodity Forward'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityForward/fpml:valueDate/fpml:adjustableDate/fpml:dateAdjustments/fpml:businessCenters/fpml:businessCenter[@id='cashSettlementHolidayCentre']"/></xsl:when><xsl:when test="$productType='Commodity Option'"><xsl:apply-templates select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:exercise/fpml:relativePaymentDates/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates><xsl:apply-templates select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:exercise/fpml:paymentDates/fpml:relativeDate/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:when><xsl:when test="$productType='Commodity Swap'"><xsl:apply-templates select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg']/fpml:relativePaymentDates/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:when><xsl:when test="$productType='Commodity Spread'"><xsl:apply-templates select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:relativePaymentDates/fpml:businessCenters"><xsl:sort select="."/></xsl:apply-templates></xsl:when></xsl:choose></PaymentHolidayCentres><PaymentHolidayCentres_2><xsl:if test="$productType='Commodity Forward'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityForward/fpml:valueDate/fpml:adjustableDate/fpml:dateAdjustments/fpml:businessCenters/fpml:businessCenter[@id='physicalSettlementHolidayCentre']"/></xsl:if></PaymentHolidayCentres_2><PaymentLag/><PaymentLag_2/><RollHolidayCentres/><RollHolidayCentres_2/><AdjustFixedStartDate/><AdjustFloatStartDate/><AdjustFloatStartDate_2/><AdjustRollEnd/><AdjustFloatRollEnd/><AdjustFloatRollEnd_2/><AdjustFixedFinalRollEnd/><AdjustFinalRollEnd/><AdjustFinalRollEnd_2/><CompoundingMethod/><CompoundingMethod_2/><AveragingMethod/><AveragingMethod_2/><FloatingRateMultiplier/><FloatingRateMultiplier_2/><DesignatedMaturity/><DesignatedMaturity_2/><ResetFreq/><ResetFreq_2/><WeeklyRollConvention/><WeeklyRollConvention_2/><RateCutOffDays/><RateCutOffDays_2/><InitialExchange/><FinalExchange/><MarkToMarket/><IntermediateExchange/><MTMRateSource/><MTMRateSourcePage/><MTMFixingDate/><MTMFixingHolidayCentres/><MTMFixingTime/><MTMLocation/><MTMCutoffTime/><CalculationPeriodDays/><FraDiscounting/><NoBreak/><HasBreak/><BreakType/><BreakFirstDate/><BreakFrequency/><BreakOverride/><BreakDate/><ExchangeUnderlying/><SpreadCurrency><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:calculation/fpml:spread/fpml:currency"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:calculation/fpml:spreadSchedule/fpml:spreadStep/fpml:currency"/></SpreadCurrency><SwapSpread><xsl:choose><xsl:when test="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:calculation/fpml:spreadSchedule"><xsl:apply-templates select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:calculation/fpml:spreadSchedule/fpml:spreadStep"/></xsl:when><xsl:otherwise><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:calculation/fpml:spread/fpml:amount"/></xsl:otherwise></xsl:choose></SwapSpread><BondId1/><BondName1/><BondAmount1/><BondPriceType1/><BondPrice1/><BondId2/><BondName2/><BondAmount2/><BondPriceType2/><BondPrice2/><StubAt/><FixedStub/><FloatStub/><FloatStub_2/><FrontAndBackStubs/><FixedBackStub/><FloatBackStub/><NoBackStubLinearInterpolation/><FirstFixedRegPdStartDate/><FirstFloatRegPdStartDate/><LastFixedRegPdEndDate/><LastFloatRegPdEndDate/><MasterAgreement/><ProductType><xsl:value-of select="$productType"/></ProductType><OptionType><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:optionType"/></OptionType><OptionExpirationDate><xsl:if test="$productType='Commodity Option'"><xsl:call-template name="formatDate"><xsl:with-param name="date"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:exercise/fpml:americanExercise/fpml:expirationDate/fpml:adjustableDate/fpml:unadjustedDate"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:exercise/fpml:europeanExercise/fpml:expirationDate/fpml:adjustableDate/fpml:unadjustedDate"/></xsl:with-param></xsl:call-template></xsl:if></OptionExpirationDate><OptionHolidayCentres/><OptionEarliestTime/><OptionExpiryTime/><OptionSpecificExpiryTime/><OptionLocation/><OptionAutomaticExercise/><OptionThreshold/><ManualExercise/><OptionWrittenExerciseConf/><OptionSettlement/><OptionCashSettlementMethod/><OptionCashSettlementQuotationRate/><OptionCashSettlementRateSource/><OptionCashSettlementReferenceBanks/><ClearedPhysicalSettlement/><Premium><Currency><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:premium/fpml:paymentAmount/fpml:currency"/></Currency><Amount><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:premium/fpml:paymentAmount/fpml:amount"/></Amount><Date><xsl:if test="$productType='Commodity Option'"><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string(fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:premium/fpml:paymentDate/fpml:adjustableDate/fpml:unadjustedDate)"/></xsl:call-template></xsl:if></Date></Premium><PremiumHolidayCentres/><DocsType/><DocsSubType/><OptionsComponentSecurityIndexAnnex/><OptionHedgingDisruption/><OptionLossOfStockBorrow/><OptionMaximumStockLoanRate/><OptionIncreasedCostOfStockBorrow/><OptionInitialStockLoanRate/><OptionIncreasedCostOfHedging/><OptionForeignOwnershipEvent/><OptionEntitlement/><ContractualDefinitions/><RestructuringCreditEvent/><CalculationAgentCity/><RefEntName/><RefEntStdId/><REROPairStdId/><RefOblRERole/><RefOblSecurityIdType/><RefOblSecurityId/><BloombergID/><RefOblMaturity/><RefOblCoupon/><RefOblPrimaryObligor/><BorrowerNames/><FacilityType/><CreditAgreementDate/><IsSecuredList/><DesignatedPriority/><OptionalEarlyTermination/><ReferencePrice/><ReferencePolicy/><PaymentDelay/><StepUpProvision/><WACCapInterestProvision/><InterestShortfallCapIndicator/><InterestShortfallCompounding/><InterestShortfallCapBasis/><InterestShortfallRateSource/><MortgagePaymentFrequency/><MortgageFinalMaturity/><MortgageOriginalAmount/><MortgageInitialFactor/><MortgageSector/><IndexName/><IndexId/><IndexSeries/><IndexVersion/><IndexAnnexDate/><IndexTradedRate/><UpfrontFee/><UpfrontFeeAmount/><UpfrontFeeDate/><UpfrontFeePayer/><AttachmentPoint/><ExhaustionPoint/><EquityRic/><OptionQuantity/><OptionExpiryMonth/><OptionExpiryYear/><Price><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:premium/fpml:premiumPerUnit/fpml:amount"/></Price><OptionStyle><xsl:if test="$productType='Commodity Option'"><xsl:choose><xsl:when test="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:effectiveDate">Asian</xsl:when><xsl:otherwise><xsl:choose><xsl:when test="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:exercise/fpml:americanExercise">American</xsl:when><xsl:otherwise>European</xsl:otherwise></xsl:choose></xsl:otherwise></xsl:choose></xsl:if></OptionStyle><ExchangeLookAlike/><AdjustmentMethod/><RelatedExchange/><MasterConfirmationDate/><Multiplier><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:commodity/fpml:multiplier"/></Multiplier><SettlementCurrency/><SettlementCurrency_2/><SettlementDateOffset><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:exercise/fpml:relativePaymentDates/fpml:paymentDaysOffset/fpml:periodMultiplier"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:exercise/fpml:paymentDates/fpml:relativeDate/fpml:periodMultiplier"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg']/fpml:relativePaymentDates/fpml:paymentDaysOffset/fpml:periodMultiplier"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:relativePaymentDates/fpml:paymentDaysOffset/fpml:periodMultiplier"/></SettlementDateOffset><SettlementType><xsl:if test="$productType!= 'Commodity Forward'">Cash</xsl:if></SettlementType><FxDeterminationMethod/><ReferencePriceSource/><ReferencePricePage/><ReferencePriceTime/><ReferencePriceCity/><ReferenceCurrency/><ReferenceCurrency_2/><DcRequired/><DcEventTypeA/><DcRic/><DcDescription/><DcExpiryMonth/><DcExpiryYear/><DcQuantity/><DcPrice/><DcCurrency/><DcDelta/><DcExpiryDate/><DcFuturesCode/><DcOffshoreCross/><DcOffshoreCrossLocation/><DcExchangeID/><DcDeltaOptionQuantity/><AveragingInOut/><AveragingDateTimes/><MarketDisruption/><AveragingFrequency/><AveragingStartDate/><AveragingEndDate/><ReferenceFXRate/><HedgeLevel/><Basis/><ImpliedLevel/><PremiumPercent/><StrikePercent/><BaseNotional/><BreakOutTrade/><SplitCollateral/><OpenUnits/><DeclaredCashDividendPercentage/><DeclaredCashEquivalentDividendPercentage/><DividendPayer/><DividendReceiver/><DividendPeriods/><SpecialDividends/><MaterialDividend/><FixedPayer/><FixedReceiver/><FixedPeriods/><VegaNotional/><ExpectedN/><ExpectedNOverride/><VarianceAmount/><VarianceStrikePrice/><VolatilityStrikePrice/><VarianceCapIndicator/><VarianceCapFactor/><ObservationStartDate/><ValuationDate/><InitialSharePriceOrIndexLevel/><ClosingSharePriceOrClosingIndexLevelIndicator/><FuturesPriceValuation/><AllDividends/><SettlementCurrencyVegaNotional/><VegaFxRate/><IndependentAmount><Payer><xsl:variable name="payer" select="string(fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:collateral/fpml:independentAmount/fpml:payerPartyReference/@href)"/><xsl:choose><xsl:when test="$payer='partyA'">A</xsl:when><xsl:when test="$payer='partyB'">B</xsl:when></xsl:choose></Payer><Currency><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:collateral/fpml:independentAmount/fpml:paymentDetail/fpml:paymentAmount/fpml:currency"/></Currency><Amount><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:collateral/fpml:independentAmount/fpml:paymentDetail/fpml:paymentAmount/fpml:amount"/></Amount></IndependentAmount><xsl:apply-templates select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:otherPartyPayment"/><SettlementRateOption/><SettlementRateOption_2/><FxFixingAdjustableDate/><FxFixingPeriod/><FxFixingDayConvention/><FxFixingCentres/><FxFixingPeriod_2/><FxFixingDayConvention_2/><FxFixingCentres_2/><CalcAgentA/><DefaultSettlementMethod/><SettlementPriceDefaultElectionMethod/><SettlementMethodElectionDate/><SettlementMethodElectingParty/><NotionalFutureValue/><DispLegs><DispLeg><DispLegId/><DispLegVersionId/><DispLegPayer/><DispLegReceiver/><DispEquityRic/><DispEquityRelEx/><DispVegaNotional/><DispExpectedN/><DispSettlementDateOffset/><DispVarianceAmount/><DispShareVarCurrency/><DispVarianceStrikePrice/><DispVarianceCapIndicator/><DispVarianceCapFactor/><DispVegaNotionalAmount/><DispObservationStartDate/><DispValuationDate/><DispInitialLevel/><DispClosingLevelIndicator/><DispFuturesPriceValuation/><DispAllDividends/></DispLeg></DispLegs><DispLegsSW><DispLegSW><DispCorrespondingLeg/><DispVolatilityStrikePrice/><DispHolidayDates/><DispExpectedNOverride/><DispShareWeight/></DispLegSW></DispLegsSW><BalanceOfPeriod><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:calculationPeriodsSchedule/fpml:balanceOfFirstPeriod"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg']/fpml:calculationPeriodsSchedule/fpml:balanceOfFirstPeriod"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:calculationPeriodsSchedule/fpml:balanceOfFirstPeriod"/></BalanceOfPeriod><BulletIndicator><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbCommoditySwapDetails/fpml:swbBulletIndicator"/></BulletIndicator><BulletFirstContractMonth><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbCommoditySwapDetails/fpml:swbFirstContractMonth"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbCommodityOptionDetails/fpml:swbContractMonth"/></BulletFirstContractMonth><BulletLastContractMonth><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbCommoditySwapDetails/fpml:swbLastContractMonth"/></BulletLastContractMonth><BulletContractYear><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbCommoditySwapDetails/fpml:swbContractYear"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbCommodityOptionDetails/fpml:swbContractYear"/></BulletContractYear><BulletContractTradingDay><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbCommodityOptionDetails/fpml:swbContractTradingDay"/></BulletContractTradingDay><ClearingVenue><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbClearingVenue"/></ClearingVenue><ClientClearing/><ExternalInteropabilityId/><InteropNettingString/><AutoSendForClearing/><ASICMandatoryClearingIndicator/><PBEBTradeASICMandatoryClearingIndicator/><PBClientTradeASICMandatoryClearingIndicator/><CANMandatoryClearingIndicator/><CANClearingExemptIndicator1PartyId/><CANClearingExemptIndicator1Value/><CANClearingExemptIndicator2PartyId/><CANClearingExemptIndicator2Value/><PBEBTradeCANMandatoryClearingIndicator/><PBEBTradeCANClearingExemptIndicator1PartyId/><PBEBTradeCANClearingExemptIndicator1Value/><PBEBTradeCANClearingExemptIndicator2PartyId/><PBEBTradeCANClearingExemptIndicator2Value/><PBClientTradeCANMandatoryClearingIndicator/><PBClientTradeCANClearingExemptIndicator1PartyId/><PBClientTradeCANClearingExemptIndicator1Value/><PBClientTradeCANClearingExemptIndicator2PartyId/><PBClientTradeCANClearingExemptIndicator2Value/><ESMAMandatoryClearingIndicator/><ESMAClearingExemptIndicator1PartyId/><ESMAClearingExemptIndicator1Value/><ESMAClearingExemptIndicator2PartyId/><ESMAClearingExemptIndicator2Value/><PBEBTradeESMAMandatoryClearingIndicator/><PBEBTradeESMAClearingExemptIndicator1PartyId/><PBEBTradeESMAClearingExemptIndicator1Value/><PBEBTradeESMAClearingExemptIndicator2PartyId/><PBEBTradeESMAClearingExemptIndicator2Value/><PBClientTradeESMAMandatoryClearingIndicator/><PBClientTradeESMAClearingExemptIndicator1PartyId/><PBClientTradeESMAClearingExemptIndicator1Value/><PBClientTradeESMAClearingExemptIndicator2PartyId/><PBClientTradeESMAClearingExemptIndicator2Value/><FCAMandatoryClearingIndicator/><FCAClearingExemptIndicator1PartyId/><FCAClearingExemptIndicator1Value/><FCAClearingExemptIndicator2PartyId/><FCAClearingExemptIndicator2Value/><PBEBTradeFCAMandatoryClearingIndicator/><PBEBTradeFCAClearingExemptIndicator1PartyId/><PBEBTradeFCAClearingExemptIndicator1Value/><PBEBTradeFCAClearingExemptIndicator2PartyId/><PBEBTradeFCAClearingExemptIndicator2Value/><PBClientTradeFCAMandatoryClearingIndicator/><PBClientTradeFCAClearingExemptIndicator1PartyId/><PBClientTradeFCAClearingExemptIndicator1Value/><PBClientTradeFCAClearingExemptIndicator2PartyId/><PBClientTradeFCAClearingExemptIndicator2Value/><HKMAMandatoryClearingIndicator/><HKMAClearingExemptIndicator1PartyId/><HKMAClearingExemptIndicator1Value/><HKMAClearingExemptIndicator2PartyId/><HKMAClearingExemptIndicator2Value/><PBEBTradeHKMAMandatoryClearingIndicator/><PBEBTradeHKMAClearingExemptIndicator1PartyId/><PBEBTradeHKMAClearingExemptIndicator1Value/><PBEBTradeHKMAClearingExemptIndicator2PartyId/><PBEBTradeHKMAClearingExemptIndicator2Value/><PBClientTradeHKMAMandatoryClearingIndicator/><PBClientTradeHKMAClearingExemptIndicator1PartyId/><PBClientTradeHKMAClearingExemptIndicator1Value/><PBClientTradeHKMAClearingExemptIndicator2PartyId/><PBClientTradeHKMAClearingExemptIndicator2Value/><JFSAMandatoryClearingIndicator/><CFTCMandatoryClearingIndicator/><CFTCClearingExemptIndicator1PartyId/><CFTCClearingExemptIndicator1Value/><CFTCClearingExemptIndicator2PartyId/><CFTCClearingExemptIndicator2Value/><CFTCInterAffiliateExemption/><PBEBTradeCFTCMandatoryClearingIndicator/><PBEBTradeCFTCClearingExemptIndicator1PartyId/><PBEBTradeCFTCClearingExemptIndicator1Value/><PBEBTradeCFTCClearingExemptIndicator2PartyId/><PBEBTradeCFTCClearingExemptIndicator2Value/><PBEBTradeCFTCInterAffiliateExemption/><PBClientTradeCFTCMandatoryClearingIndicator/><PBClientTradeCFTCClearingExemptIndicator1PartyId/><PBClientTradeCFTCClearingExemptIndicator1Value/><PBClientTradeCFTCClearingExemptIndicator2PartyId/><PBClientTradeCFTCClearingExemptIndicator2Value/><PBClientTradeCFTCInterAffiliateExemption/><MASMandatoryClearingIndicator/><PBEBTradeMASMandatoryClearingIndicator/><PBClientTradeMASMandatoryClearingIndicator/><ClearingHouseId/><IntendedClearingHouse/><TraderId/><TraderId_2/><xsl:if test="$idm140092017587136-4/fpml:swbExecutingBroker and /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbClearingClient and /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbClientClearing='true' and not(/fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbDisplayPartyLegalEntity) and $isPrimeBrokered='0'"><ExecutingBroker><xsl:value-of select="$partyA"/></ExecutingBroker><ClearingClient><xsl:value-of select="$partyB"/></ClearingClient></xsl:if><ClientClearingBroker><xsl:for-each select="$idm140092017587136-4/fpml:swbPartyClearingBroker"><xsl:if test="fpml:partyReference/@href= /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbClearingClient/@href"><xsl:value-of select="fpml:swbClearingBroker/fpml:partyId"/></xsl:if></xsl:for-each></ClientClearingBroker><EBClearingBroker><xsl:for-each select="$idm140092017587136-4/fpml:swbPartyClearingBroker"><xsl:if test="fpml:partyReference/@href= /fpml:SWBML/fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbTradeHeader/fpml:swbExecutingBroker/@href"><xsl:value-of select="fpml:swbClearingBroker/fpml:partyId"/></xsl:if></xsl:for-each></EBClearingBroker><PartyAClearingBroker><xsl:for-each select="$idm140092017587136-4/fpml:swbPartyClearingBroker"><xsl:choose><xsl:when test="fpml:partyReference/@href = 'partyA'"><xsl:value-of select="fpml:swbClearingBroker/fpml:partyId"/></xsl:when></xsl:choose></xsl:for-each></PartyAClearingBroker><PartyBClearingBroker><xsl:for-each select="$idm140092017587136-4/fpml:swbPartyClearingBroker"><xsl:choose><xsl:when test="fpml:partyReference/@href = 'partyB'"><xsl:value-of select="fpml:swbClearingBroker/fpml:partyId"/></xsl:when></xsl:choose></xsl:for-each></PartyBClearingBroker><DisplayPartyLE_Party><xsl:if test="$idm140092017587136-4/fpml:swbDisplayPartyLegalEntity"><xsl:value-of select="$idm140092017587136-4/fpml:swbDisplayPartyLegalEntity/fpml:partyReference/@href"/></xsl:if></DisplayPartyLE_Party><DisplayPartyLE_Value><xsl:if test="$idm140092017587136-4/fpml:swbDisplayPartyLegalEntity"><xsl:value-of select="$idm140092017587136-4/fpml:swbDisplayPartyLegalEntity/fpml:swbDisplayLE/fpml:partyId"/></xsl:if></DisplayPartyLE_Value><ClearingNettingParty/><ClearingNettingString/><ClearingNettingParty_2/><ClearingNettingString_2/><CommodityReferencePrice><xsl:choose><xsl:when test="$productType='Commodity Option' or $productType='Commodity Swap'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:commodity/fpml:instrumentId"/></xsl:when><xsl:when test="$productType='Commodity Spread'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:commodity/fpml:instrumentId"/></xsl:when></xsl:choose></CommodityReferencePrice><CommodityReferencePrice_2><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:commodity/fpml:instrumentId"/></CommodityReferencePrice_2><CommonPricing><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:commonPricing"/></CommonPricing><DeliveryDates><xsl:choose><xsl:when test="($productType='Commodity Option' or $productType='Commodity Swap') and fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:commodity/fpml:deliveryDates"><xsl:call-template name="formatDeliveryDates"><xsl:with-param name="deliveryDates" select="string(fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:commodity/fpml:deliveryDates)"/></xsl:call-template></xsl:when><xsl:when test="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:commodity/fpml:deliveryDates"><xsl:call-template name="formatDeliveryDates"><xsl:with-param name="deliveryDates" select="string(fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:commodity/fpml:deliveryDates)"/></xsl:call-template></xsl:when></xsl:choose></DeliveryDates><DeliveryDates_2><xsl:if test="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:commodity/fpml:deliveryDates"><xsl:call-template name="formatDeliveryDates"><xsl:with-param name="deliveryDates" select="string(fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:commodity/fpml:deliveryDates)"/></xsl:call-template></xsl:if></DeliveryDates_2><DeliveryLocation><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityForward/fpml:bullionPhysicalLeg/fpml:deliveryLocation"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:electricityPhysicalLeg/fpml:deliveryConditions/fpml:deliveryPoint"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:electricityPhysicalLeg/fpml:deliveryConditions/fpml:deliveryZone"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:gasPhysicalLeg/fpml:deliveryConditions/fpml:deliveryPoint"/></DeliveryLocation><FloatCalculationFrequency><xsl:choose><xsl:when test="$productType='Commodity Option'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:calculationPeriodsSchedule/fpml:periodMultiplier"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:calculationPeriodsSchedule/fpml:period"/></xsl:when><xsl:when test="$productType='Commodity Swap'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg']/fpml:calculationPeriodsSchedule/fpml:periodMultiplier"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg']/fpml:calculationPeriodsSchedule/fpml:period"/></xsl:when><xsl:when test=" $productType='Commodity Spread'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:calculationPeriodsSchedule/fpml:periodMultiplier"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:calculationPeriodsSchedule/fpml:period"/></xsl:when></xsl:choose></FloatCalculationFrequency><FloatCalculationFrequency_2><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:calculationPeriodsSchedule/fpml:periodMultiplier"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:calculationPeriodsSchedule/fpml:period"/></FloatCalculationFrequency_2><PhysicalCommodity><xsl:choose><xsl:when test="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityForward/fpml:bullionPhysicalLeg">Precious Metals</xsl:when><xsl:when test="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:electricityPhysicalLeg">Power</xsl:when><xsl:when test="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:gasPhysicalLeg">Gas</xsl:when><xsl:otherwise>???</xsl:otherwise></xsl:choose></PhysicalCommodity><PhysicalElectricityProduct><xsl:choose><xsl:when test="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:electricityPhysicalLeg/fpml:deliveryConditions/fpml:deliveryType/fpml:firm">Firm</xsl:when><xsl:when test="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:electricityPhysicalLeg/fpml:deliveryConditions/fpml:deliveryType/fpml:nonFirm">Non Firm</xsl:when><xsl:when test="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:electricityPhysicalLeg/fpml:deliveryConditions/fpml:deliveryType/fpml:systemFirm">System Firm</xsl:when><xsl:when test="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:electricityPhysicalLeg/fpml:deliveryConditions/fpml:deliveryType/fpml:unitFirm">Unit Firm</xsl:when><xsl:when test="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:electricityPhysicalLeg/fpml:deliveryConditions/fpml:deliveryZone">Into</xsl:when></xsl:choose></PhysicalElectricityProduct><PhysicalElectricityForceMajeure><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:electricityPhysicalLeg/fpml:deliveryConditions/fpml:deliveryType/fpml:firm/fpml:forceMajeure"/></PhysicalElectricityForceMajeure><PhysicalGasDeliveryType><xsl:call-template name="formatGasDeliveryType"><xsl:with-param name="gasDeliveryType" select="string(fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:gasPhysicalLeg/fpml:deliveryConditions/fpml:deliveryType)"/></xsl:call-template></PhysicalGasDeliveryType><ForwardUnderlyer><xsl:call-template name="formatBullionType"><xsl:with-param name="bullionType" select="string(fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityForward/fpml:bullionPhysicalLeg/fpml:bullionType)"/></xsl:call-template></ForwardUnderlyer><FuturesRollConvention><xsl:choose><xsl:when test="$productType='Commodity Option' or $productType='Commodity Swap'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:commodity/fpml:deliveryDateRollConvention/fpml:periodMultiplier"/></xsl:when><xsl:when test="$productType='Commodity Spread'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:commodity/fpml:deliveryDateRollConvention/fpml:periodMultiplier"/></xsl:when></xsl:choose></FuturesRollConvention><FuturesRollConvention_2><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:commodity/fpml:deliveryDateRollConvention/fpml:periodMultiplier"/></FuturesRollConvention_2><LoadShape><xsl:choose><xsl:when test="$productType='Commodity Swap'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbCommoditySwapDetails/fpml:swbElectricityLoadShape"/></xsl:when><xsl:when test="$productType='Commodity Spread'"><xsl:variable name="floatingLeg1LoadShapeReference" select="string(fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:calculation/fpml:pricingDates/fpml:settlementPeriodsReference/@href)"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbCommoditySpreadDetails/fpml:swbElectricityLoadShape[@id=$floatingLeg1LoadShapeReference]"/></xsl:when><xsl:when test="$productType='Commodity Forward'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbCommodityForwardDetails/fpml:swbElectricityLoadShape"/></xsl:when></xsl:choose></LoadShape><LoadShape_2><xsl:variable name="floatingLeg2LoadShapeReference" select="string(fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:calculation/fpml:pricingDates/fpml:settlementPeriodsReference/@href)"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbCommoditySpreadDetails/fpml:swbElectricityLoadShape[@id=$floatingLeg2LoadShapeReference]"/></LoadShape_2><NotionalLots><xsl:choose><xsl:when test="$productType='Commodity Option'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbCommodityOptionDetails/fpml:swbTotalNotionalQuantityLots"/></xsl:when><xsl:when test="$productType='Commodity Swap'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:swbExtendedTradeDetails/fpml:swbCommoditySwapDetails/fpml:swbTotalNotionalQuantityLots"/></xsl:when></xsl:choose></NotionalLots><NotionalQuantity><xsl:choose><xsl:when test="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:notionalQuantitySchedule"><xsl:apply-templates select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:notionalQuantitySchedule/fpml:notionalStep"/></xsl:when><xsl:when test="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg']/fpml:notionalQuantitySchedule"><xsl:apply-templates select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg']/fpml:notionalQuantitySchedule/fpml:notionalStep"/><xsl:apply-templates select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg']/fpml:notionalQuantitySchedule/fpml:settlementPeriodsNotionalQuantitySchedule/fpml:settlementPeriodsNotionalQuantityStep"/></xsl:when><xsl:when test="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:notionalQuantitySchedule"><xsl:apply-templates select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:notionalQuantitySchedule/fpml:notionalStep"/><xsl:apply-templates select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:notionalQuantitySchedule/fpml:settlementPeriodsNotionalQuantitySchedule/fpml:settlementPeriodsNotionalQuantityStep"/></xsl:when><xsl:otherwise><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityForward/fpml:bullionPhysicalLeg/fpml:physicalQuantity/fpml:quantity"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:gasPhysicalLeg/fpml:deliveryQuantity/fpml:physicalQuantity/fpml:quantity"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:electricityPhysicalLeg/fpml:deliveryQuantity/fpml:physicalQuantity/fpml:quantity"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:notionalQuantity/fpml:quantity"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg']/fpml:notionalQuantity/fpml:quantity"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg']/fpml:settlementPeriodsNotionalQuantity/fpml:quantity"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:notionalQuantity/fpml:quantity"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:settlementPeriodsNotionalQuantity/fpml:quantity"/></xsl:otherwise></xsl:choose></NotionalQuantity><NotionalQuantity_2><xsl:choose><xsl:when test="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:notionalQuantitySchedule"><xsl:apply-templates select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:notionalQuantitySchedule/fpml:notionalStep"/><xsl:apply-templates select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:notionalQuantitySchedule/fpml:settlementPeriodsNotionalQuantitySchedule/fpml:settlementPeriodsNotionalQuantityStep"/></xsl:when><xsl:otherwise><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:notionalQuantity/fpml:quantity"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:settlementPeriodsNotionalQuantity/fpml:quantity"/></xsl:otherwise></xsl:choose></NotionalQuantity_2><PricingDayType><xsl:variable name="pricingDayType"><xsl:choose><xsl:when test="$productType='Commodity Option'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:pricingDates/fpml:dayType"/></xsl:when><xsl:when test="$productType='Commodity Swap'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg']/fpml:calculation/fpml:pricingDates/fpml:dayType"/></xsl:when><xsl:when test="$productType='Commodity Spread'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:calculation/fpml:pricingDates/fpml:dayType"/></xsl:when></xsl:choose></xsl:variable><xsl:if test="$pricingDayType='CommodityBusiness'">CommodityBusiness</xsl:if><xsl:if test="$pricingDayType='ScheduledTradingDay'">ScheduledTradingDay</xsl:if></PricingDayType><PricingDayType_2><xsl:if test="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:calculation/fpml:pricingDates/fpml:dayType='CommodityBusiness'">CommodityBusiness</xsl:if><xsl:if test="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:calculation/fpml:pricingDates/fpml:dayType='ScheduledTradingDay'">ScheduledTradingDay</xsl:if></PricingDayType_2><PricingFrequency><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:pricingDates/fpml:dayDistribution"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg']/fpml:calculation/fpml:pricingDates/fpml:dayDistribution"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:calculation/fpml:pricingDates/fpml:dayDistribution"/></PricingFrequency><PricingFrequency_2><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:calculation/fpml:pricingDates/fpml:dayDistribution"/></PricingFrequency_2><PricingHolidayCentres/><PricingHolidayCentres_2/><PricingLagInterval><xsl:choose><xsl:when test="$productType='Commodity Option'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:pricingDates/fpml:lag/fpml:lagDuration/fpml:periodMultiplier"/></xsl:when><xsl:when test="$productType='Commodity Swap'"><xsl:apply-templates select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg']/fpml:calculation/fpml:pricingDates/fpml:lag/fpml:lagDuration/fpml:periodMultiplier"/></xsl:when><xsl:when test="$productType='Commodity Spread'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:calculation/fpml:pricingDates/fpml:lag/fpml:lagDuration/fpml:periodMultiplier"/></xsl:when></xsl:choose></PricingLagInterval><PricingLagInterval_2><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:calculation/fpml:pricingDates/fpml:lag/fpml:lagDuration/fpml:periodMultiplier"/></PricingLagInterval_2><PricingLagSkipInterval><xsl:choose><xsl:when test="$productType='Commodity Option' and fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:pricingDates/fpml:lag/fpml:firstObservationDateOffset"><xsl:call-template name="formatLagOffset"><xsl:with-param name="lagDuration" select="string(fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:pricingDates/fpml:lag/fpml:lagDuration/fpml:periodMultiplier)"/><xsl:with-param name="lagOffset" select="string(fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:pricingDates/fpml:lag/fpml:firstObservationDateOffset/fpml:periodMultiplier)"/></xsl:call-template></xsl:when><xsl:when test="$productType='Commodity Swap' and fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg']/fpml:calculation/fpml:pricingDates/fpml:lag/fpml:firstObservationDateOffset"><xsl:call-template name="formatLagOffset"><xsl:with-param name="lagDuration" select="string(fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg']/fpml:calculation/fpml:pricingDates/fpml:lag/fpml:lagDuration/fpml:periodMultiplier)"/><xsl:with-param name="lagOffset" select="string(fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg']/fpml:calculation/fpml:pricingDates/fpml:lag/fpml:firstObservationDateOffset/fpml:periodMultiplier)"/></xsl:call-template></xsl:when><xsl:when test="$productType='Commodity Spread' and fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:calculation/fpml:pricingDates/fpml:lag/fpml:firstObservationDateOffset/fpml:periodMultiplier"><xsl:call-template name="formatLagOffset"><xsl:with-param name="lagDuration" select="string(fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:calculation/fpml:pricingDates/fpml:lag/fpml:lagDuration/fpml:periodMultiplier)"/><xsl:with-param name="lagOffset" select="string(fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:calculation/fpml:pricingDates/fpml:lag/fpml:firstObservationDateOffset/fpml:periodMultiplier)"/></xsl:call-template></xsl:when></xsl:choose></PricingLagSkipInterval><PricingLagSkipInterval_2><xsl:if test="$productType='Commodity Spread' and fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:calculation/fpml:pricingDates/fpml:lag/fpml:firstObservationDateOffset"><xsl:call-template name="formatLagOffset"><xsl:with-param name="lagDuration" select="string(fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:calculation/fpml:pricingDates/fpml:lag/fpml:lagDuration/fpml:periodMultiplier)"/><xsl:with-param name="lagOffset" select="string(fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:calculation/fpml:pricingDates/fpml:lag/fpml:firstObservationDateOffset/fpml:periodMultiplier)"/></xsl:call-template></xsl:if></PricingLagSkipInterval_2><PricingRange><xsl:choose><xsl:when test="$productType='Commodity Option'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:pricingDates/fpml:dayCount"/></xsl:when><xsl:when test="$productType='Commodity Swap'"><xsl:apply-templates select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg']/fpml:calculation/fpml:pricingDates/fpml:dayCount"/></xsl:when><xsl:when test="$productType='Commodity Spread'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:calculation/fpml:pricingDates/fpml:dayCount"/></xsl:when></xsl:choose></PricingRange><PricingRange_2><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:calculation/fpml:pricingDates/fpml:dayCount"/></PricingRange_2><SettlementDaysConvention><xsl:variable name="settlementDaysConvention"><xsl:choose><xsl:when test="$productType='Commodity Option'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:exercise/fpml:paymentDates/fpml:relativeDate/fpml:businessDayConvention"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:exercise/fpml:relativePaymentDates/fpml:paymentDaysOffset/fpml:businessDayConvention"/></xsl:when><xsl:when test="$productType='Commodity Swap'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg']/fpml:relativePaymentDates/fpml:paymentDaysOffset/fpml:businessDayConvention"/></xsl:when><xsl:when test="$productType='Commodity Spread'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:relativePaymentDates/fpml:paymentDaysOffset/fpml:businessDayConvention"/></xsl:when></xsl:choose></xsl:variable><xsl:choose><xsl:when test="$settlementDaysConvention='NONE'"/><xsl:when test="$settlementDaysConvention='NotApplicable'"/><xsl:otherwise><xsl:value-of select="substring($settlementDaysConvention,1,4)"/></xsl:otherwise></xsl:choose></SettlementDaysConvention><SettlementDaysType><xsl:choose><xsl:when test="$productType='Commodity Option'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:exercise/fpml:paymentDates/fpml:relativeDate/fpml:dayType"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:exercise/fpml:relativePaymentDates/fpml:paymentDaysOffset/fpml:dayType"/></xsl:when><xsl:when test="$productType='Commodity Swap'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg']/fpml:relativePaymentDates/fpml:paymentDaysOffset/fpml:dayType"/></xsl:when><xsl:when test="$productType='Commodity Spread'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:relativePaymentDates/fpml:paymentDaysOffset/fpml:dayType"/></xsl:when></xsl:choose></SettlementDaysType><SpecifiedPrice><xsl:variable name="specifiedPrice"><xsl:choose><xsl:when test="$productType='Commodity Option' or $productType='Commodity Swap'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade//fpml:commodity/fpml:specifiedPrice"/></xsl:when><xsl:when test="$productType='Commodity Spread'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:commodity/fpml:specifiedPrice"/></xsl:when></xsl:choose></xsl:variable><xsl:value-of select="$specifiedPrice"/></SpecifiedPrice><SpecifiedPrice_2><xsl:if test="$productType='Commodity Spread'"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:commodity/fpml:specifiedPrice"/></xsl:if></SpecifiedPrice_2><UnitFrequency><xsl:variable name="unitFrequency"><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:notionalQuantity/fpml:quantityFrequency"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityForward/fpml:physicalQuantity/fpml:quantityFrequency"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:gasPhysicalLeg/fpml:deliveryQuantity/fpml:physicalQuantity/fpml:quantityFrequency"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:electricityPhysicalLeg/fpml:deliveryQuantity/fpml:physicalQuantity/fpml:quantityFrequency"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:notionalQuantitySchedule/fpml:notionalStep[1]/fpml:quantityFrequency"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg']/fpml:notionalQuantity/fpml:quantityFrequency"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg']/fpml:settlementPeriodsNotionalQuantity/fpml:quantityFrequency"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg']/fpml:notionalQuantitySchedule/fpml:notionalStep/fpml:quantityFrequency"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg']/fpml:notionalQuantitySchedule/fpml:settlementPeriodsNotionalQuantitySchedule/fpml:settlementPeriodsNotionalQuantityStep/fpml:quantityFrequency"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:notionalQuantity/fpml:quantityFrequency"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:settlementPeriodsNotionalQuantity/fpml:quantityFrequency"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:notionalQuantitySchedule/fpml:notionalStep/fpml:quantityFrequency"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:notionalQuantitySchedule/fpml:settlementPeriodsNotionalQuantitySchedule/fpml:settlementPeriodsNotionalQuantityStep/fpml:quantityFrequency"/></xsl:variable><xsl:choose><xsl:when test="$unitFrequency='PerCalculationPeriod'">per period</xsl:when><xsl:when test="$unitFrequency='PerCalendarDay'">per cal. day</xsl:when><xsl:when test="$unitFrequency='Term'">per period</xsl:when><xsl:when test="$unitFrequency='PerSettlementPeriod'">per hour</xsl:when><xsl:when test="$unitFrequency='PerHour'">per hour</xsl:when></xsl:choose></UnitFrequency><Units><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityForward/fpml:bullionPhysicalLeg/fpml:physicalQuantity/fpml:quantityUnit"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:gasPhysicalLeg/fpml:deliveryQuantity/fpml:physicalQuantity/fpml:quantityUnit"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:electricityPhysicalLeg/fpml:deliveryQuantity/fpml:physicalQuantity/fpml:quantityUnit"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:notionalQuantity/fpml:quantityUnit"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityOption/fpml:notionalQuantitySchedule/fpml:notionalStep[1]/fpml:quantityUnit"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg']/fpml:notionalQuantity/fpml:quantityUnit"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg']/fpml:settlementPeriodsNotionalQuantity/fpml:quantityUnit"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg']/fpml:notionalQuantitySchedule/fpml:notionalStep/fpml:quantityUnit"/><xsl:value-of select=" fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg']/fpml:notionalQuantitySchedule/fpml:settlementPeriodsNotionalQuantitySchedule/fpml:settlementPeriodsNotionalQuantityStep/fpml:quantityUnit"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:notionalQuantity/fpml:quantityUnit"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:settlementPeriodsNotionalQuantity/fpml:quantityUnit"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:notionalQuantitySchedule/fpml:notionalStep/fpml:quantityUnit"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg1']/fpml:notionalQuantitySchedule/fpml:settlementPeriodsNotionalQuantitySchedule/fpml:settlementPeriodsNotionalQuantityStep/fpml:quantityUnit"/></Units><Units_2><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:notionalQuantity/fpml:quantityUnit"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:settlementPeriodsNotionalQuantity/fpml:quantityUnit"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:notionalQuantitySchedule/fpml:notionalStep/fpml:quantityUnit"/><xsl:value-of select="fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commoditySwap/fpml:floatingLeg[@id='floatingLeg2']/fpml:notionalQuantitySchedule/fpml:settlementPeriodsNotionalQuantitySchedule/fpml:settlementPeriodsNotionalQuantityStep/fpml:quantityUnit"/></Units_2><ValueDate><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string(fpml:swbStructuredTradeDetails/fpml:FpML/fpml:trade/fpml:commodityForward/fpml:valueDate/fpml:adjustableDate/fpml:unadjustedDate)"/></xsl:call-template></ValueDate><ModifiedEquityDelivery/><SettledEntityMatrixSource/><SettledEntityMatrixDate/><AdditionalTerms/><Rule15A-6/><xsl:call-template name="outputCommonReportingFields"><xsl:with-param name="reportingData" select="$reportingData"/><xsl:with-param name="brokerPrivateData" select="$brokerPrivateData"/><xsl:with-param name="partyAPrivateData" select="$partyAPrivateData"/><xsl:with-param name="partyBPrivateData" select="$partyBPrivateData"/></xsl:call-template><xsl:call-template name="brokerProvidedOrderDetails"><xsl:with-param name="extendedTradeDetails" select="$extendedTradeDetails"/></xsl:call-template><xsl:call-template name="brokerProvidedPackageDetails"><xsl:with-param name="extendedTradeDetails" select="$extendedTradeDetails"/></xsl:call-template><xsl:variable name="swbTradeHeader" select="$idm140092017587136-4"/><AutoProcessing><xsl:value-of select="$swbTradeHeader/fpml:swbAutoProcessing"/></AutoProcessing><AnonymousTrade><xsl:value-of select="$swbTradeHeader/fpml:swbAnonymousTrade"/></AnonymousTrade><GCOffsettingID><xsl:value-of select="$swbTradeHeader/fpml:swbOffsettingTradeId"/></GCOffsettingID><OTVConfirmation><xsl:value-of select="$swbTradeHeader/fpml:swbOTVConfirmation"/></OTVConfirmation><xsl:apply-templates select="$idm140092017587136-4/fpml:swbPartyClearingDetails"/></Trade></xsl:template><xsl:template match="additionalPayment"><xsl:variable name="paymentType" select="string(fpml:paymentType)"/><xsl:choose><xsl:when test="$paymentType='Premium'"><xsl:call-template name="premium"/></xsl:when><xsl:otherwise><xsl:apply-templates select="."/></xsl:otherwise></xsl:choose></xsl:template><xsl:template match="fpml:swbPartyClearingDetails"><PartyClearingDetails><Party><xsl:variable name="party" select="string(fpml:partyReference/@href)"/><xsl:choose><xsl:when test="$party='partyA'">A</xsl:when><xsl:when test="$party='partyB'">B</xsl:when><xsl:otherwise>???</xsl:otherwise></xsl:choose></Party><ClearingStatus><xsl:value-of select="fpml:swbClearingStatus"/></ClearingStatus><ClearingHouseTradeID><xsl:value-of select="fpml:swbClearingHouseTradeID"/></ClearingHouseTradeID><ClearingHouseUpfrontFeeSettlementDate><xsl:value-of select="fpml:swbClearingHouseUpfrontFeeSettlementDate"/></ClearingHouseUpfrontFeeSettlementDate><ClearingHousePreferredISIN><xsl:value-of select="fpml:swbClearingHousePreferredISIN"/></ClearingHousePreferredISIN><ClearedTimestamp><xsl:value-of select="fpml:swbClearedTimestamp"/></ClearedTimestamp><ClearedUSINamespace><xsl:value-of select="fpml:swbClearedUSI/fpml:swbIssuer"/></ClearedUSINamespace><ClearedUSI><xsl:value-of select="fpml:swbClearedUSI/fpml:swbTradeId"/></ClearedUSI><ClearedUTINamespace><xsl:value-of select="fpml:swbClearedUTI/fpml:swbIssuer"/></ClearedUTINamespace><ClearedUTI><xsl:value-of select="fpml:swbClearedUTI/fpml:swbTradeId"/></ClearedUTI></PartyClearingDetails></xsl:template><xsl:template match="fpml:swbRecipient"><Recipient><Id><xsl:value-of select="./@id"/></Id><xsl:variable name="party" select="string(fpml:partyReference/@href)"/><Party><xsl:choose><xsl:when test="$party=$partyA">A</xsl:when><xsl:when test="$party=$partyB">B</xsl:when><xsl:otherwise>???</xsl:otherwise></xsl:choose></Party><UserName><xsl:value-of select="$idm140092017972096-4/fpml:tradeHeader/fpml:partyTradeInformation[fpml:partyReference/@href=$party]/fpml:trader"/></UserName><TradingBook><xsl:value-of select="fpml:swbTradingBookId"/></TradingBook><ExecutionMode/></Recipient></xsl:template><xsl:template match="fpml:additionalPayment"><AdditionalPayment><Payer><xsl:variable name="payer" select="string(fpml:payerPartyReference/@href)"/><xsl:choose><xsl:when test="$payer=$partyA">A</xsl:when><xsl:when test="$payer=$partyB">B</xsl:when><xsl:otherwise>???</xsl:otherwise></xsl:choose></Payer><Reason><xsl:value-of select="fpml:paymentType"/></Reason><Currency><xsl:value-of select="fpml:paymentAmount/fpml:currency"/></Currency><Amount><xsl:value-of select="fpml:paymentAmount/fpml:amount"/></Amount><Date><xsl:call-template name="formatDate"><xsl:with-param name="date" select="string(fpml:paymentDate/fpml:unadjustedDate)"/></xsl:call-template></Date><Convention><xsl:value-of select="substring(fpml:paymentDate/fpml:dateAdjustments/fpml:businessDayConvention,1,4)"/></Convention><Holidays><xsl:apply-templates select="fpml:paymentDate/fpml:dateAdjustments/fpml:businessCenters"/></Holidays></AdditionalPayment></xsl:template><xsl:template name="premium"/><xsl:template match="fpml:otherPartyPayment"><Brokerage><Payer><xsl:variable name="payer" select="string(fpml:payerPartyReference/@href)"/><xsl:choose><xsl:when test="$payer=$partyA">A</xsl:when><xsl:when test="$payer=$partyB">B</xsl:when><xsl:otherwise>???</xsl:otherwise></xsl:choose></Payer><Currency><xsl:choose><xsl:when test="fpml:paymentAmount/fpml:currency='XXX' and fpml:paymentAmount/fpml:amount='0'"/><xsl:otherwise><xsl:value-of select="fpml:paymentAmount/fpml:currency"/></xsl:otherwise></xsl:choose></Currency><Amount><xsl:choose><xsl:when test="fpml:paymentAmount/fpml:currency='XXX' and fpml:paymentAmount/fpml:amount='0'"/><xsl:otherwise><xsl:value-of select="fpml:paymentAmount/fpml:amount"/></xsl:otherwise></xsl:choose></Amount><Broker><xsl:variable name="version" select="string(/fpml:SWBML/@version)"/><xsl:variable name="broker" select="string(fpml:receiverPartyReference/@href)"/><xsl:value-of select="$idm140092017972096-3/fpml:party[@id=$broker]/fpml:partyId"/></Broker><BrokerTradeId><xsl:variable name="version" select="string(/fpml:SWBML/@version)"/><xsl:variable name="party" select="string(fpml:payerPartyReference/@href)"/><xsl:value-of select="$idm140092017972096-4/fpml:tradeHeader/fpml:partyTradeIdentifier/fpml:partyReference[@href=$party]/../fpml:tradeId"/></BrokerTradeId></Brokerage></xsl:template><xsl:template match="fpml:businessCenters"><xsl:for-each select="fpml:businessCenter"><xsl:value-of select="."/><xsl:if test="../fpml:businessCenter[last()]!=.">; </xsl:if></xsl:for-each></xsl:template><xsl:template name="formatDate"><xsl:param name="date"/><xsl:variable name="month" select="string(substring($date,6,2))"/><xsl:value-of select="substring($date,9,2)"/>-<xsl:choose><xsl:when test="$month='01'">Jan</xsl:when><xsl:when test="$month='02'">Feb</xsl:when><xsl:when test="$month='03'">Mar</xsl:when><xsl:when test="$month='04'">Apr</xsl:when><xsl:when test="$month='05'">May</xsl:when><xsl:when test="$month='06'">Jun</xsl:when><xsl:when test="$month='07'">Jul</xsl:when><xsl:when test="$month='08'">Aug</xsl:when><xsl:when test="$month='09'">Sep</xsl:when><xsl:when test="$month='10'">Oct</xsl:when><xsl:when test="$month='11'">Nov</xsl:when><xsl:when test="$month='12'">Dec</xsl:when><xsl:otherwise>???</xsl:otherwise></xsl:choose>-<xsl:value-of select="substring($date,1,4)"/></xsl:template><xsl:template name="formatDeliveryDates"><xsl:param name="deliveryDates"/><xsl:choose><xsl:when test="$deliveryDates='FirstNearby'">First Nearby Month</xsl:when><xsl:when test="$deliveryDates='SecondNearby'">Second Nearby Month</xsl:when><xsl:when test="$deliveryDates='ThirdNearby'">Third Nearby Month</xsl:when><xsl:when test="$deliveryDates='SixthNearby'">Sixth Nearby Month</xsl:when><xsl:when test="$deliveryDates='TwelfthNearby'">Twelfth Nearby Month</xsl:when><xsl:when test="$deliveryDates='Spot'">Spot</xsl:when><xsl:otherwise>???</xsl:otherwise></xsl:choose></xsl:template><xsl:template name="formatLagOffset"><xsl:param name="lagDuration"/><xsl:param name="lagOffset"/><xsl:variable name="skipInterval" select="string($lagOffset - $lagDuration)"/><xsl:choose><xsl:when test="$skipInterval='NaN'">???</xsl:when><xsl:otherwise><xsl:value-of select="$skipInterval"/></xsl:otherwise></xsl:choose></xsl:template><xsl:template name="formatTime"><xsl:param name="time"/><xsl:choose><xsl:when test="$time='09:00:00'">9am</xsl:when><xsl:when test="$time='11:00:00'">11am</xsl:when><xsl:when test="$time='12:00:00'">12noon</xsl:when><xsl:when test="$time='15:00:00'">3pm</xsl:when><xsl:when test="$time='00:00:00'">12midnight</xsl:when><xsl:when test="$time='01:00:00'">1am</xsl:when><xsl:when test="$time='02:00:00'">2am</xsl:when><xsl:when test="$time='03:00:00'">3am</xsl:when><xsl:when test="$time='04:00:00'">4am</xsl:when><xsl:when test="$time='05:00:00'">5am</xsl:when><xsl:when test="$time='06:00:00'">6am</xsl:when><xsl:when test="$time='07:00:00'">7am</xsl:when><xsl:when test="$time='08:00:00'">8am</xsl:when><xsl:when test="$time='10:00:00'">10am</xsl:when><xsl:when test="$time='11:30:00'">11.30am</xsl:when><xsl:when test="$time='13:00:00'">1pm</xsl:when><xsl:when test="$time='14:00:00'">2pm</xsl:when><xsl:when test="$time='14:10:00'">2.10pm</xsl:when><xsl:when test="$time='14:15:00'">2.15pm</xsl:when><xsl:when test="$time='14:30:00'">2.30pm</xsl:when><xsl:when test="$time='14:45:00'">2.45pm</xsl:when><xsl:when test="$time='15:15:00'">3.15pm</xsl:when><xsl:when test="$time='16:00:00'">4pm</xsl:when><xsl:when test="$time='16:30:00'">4.30pm</xsl:when><xsl:when test="$time='17:00:00'">5pm</xsl:when><xsl:when test="$time='18:00:00'">6pm</xsl:when><xsl:when test="$time='19:00:00'">7pm</xsl:when><xsl:when test="$time='20:00:00'">8pm</xsl:when><xsl:when test="$time='21:00:00'">9pm</xsl:when><xsl:when test="$time='22:00:00'">10pm</xsl:when><xsl:when test="$time='23:00:00'">11pm</xsl:when><xsl:otherwise>???</xsl:otherwise></xsl:choose></xsl:template><xsl:template match="fpml:fixedPriceStep"><xsl:value-of select="fpml:price"/><xsl:if test="position()!=count(../fpml:fixedPriceStep)">; </xsl:if></xsl:template><xsl:template match="fpml:settlementPeriodsPriceStep"><xsl:value-of select="fpml:price"/><xsl:if test="position()!=count(../fpml:settlementPeriodsPriceStep)">; </xsl:if></xsl:template><xsl:template match="fpml:worldscaleRateStep"><xsl:value-of select="."/><xsl:if test="position()!=count(../fpml:worldscaleRateStep)">; </xsl:if></xsl:template><xsl:template match="fpml:contractRateStep"><xsl:value-of select="fpml:amount"/><xsl:if test="position()!=count(../fpml:contractRateStep)">; </xsl:if></xsl:template><xsl:template match="fpml:notionalStep"><xsl:value-of select="fpml:quantity"/><xsl:if test="position()!=count(../fpml:notionalStep)">; </xsl:if></xsl:template><xsl:template match="fpml:settlementPeriodsNotionalQuantityStep"><xsl:value-of select="fpml:quantity"/><xsl:if test="position()!=count(../fpml:settlementPeriodsNotionalQuantityStep)">; </xsl:if></xsl:template><xsl:template match="fpml:spreadStep"><xsl:value-of select="fpml:amount"/><xsl:if test="position()!=count(../fpml:spreadStep)">; </xsl:if></xsl:template><xsl:template name="formatBullionType"><xsl:param name="bullionType"/><xsl:choose><xsl:when test="$bullionType='RhodiumSponge'">Rhodium (Sponge)</xsl:when><xsl:when test="$bullionType='Gold'">Gold</xsl:when><xsl:when test="$bullionType='Silver'">Silver</xsl:when><xsl:when test="$bullionType='Palladium'">Palladium</xsl:when><xsl:when test="$bullionType='Platinum'">Platinum</xsl:when><xsl:otherwise>???</xsl:otherwise></xsl:choose></xsl:template><xsl:template name="formatGasDeliveryType"><xsl:param name="gasDeliveryType"/><xsl:choose><xsl:when test="$gasDeliveryType='Firm'">Firm (Fixed)</xsl:when><xsl:when test="$gasDeliveryType='Interruptible'">Interruptible</xsl:when><xsl:otherwise>???</xsl:otherwise></xsl:choose></xsl:template></xsl:stylesheet>